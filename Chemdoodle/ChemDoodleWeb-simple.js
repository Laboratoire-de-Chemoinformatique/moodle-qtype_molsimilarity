

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(n){var E=0;return function(){return E<n.length?{done:!1,value:n[E++]}:{done:!0}}};$jscomp.arrayIterator=function(n){return{next:$jscomp.arrayIteratorImpl(n)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(n,E,w){if(n==Array.prototype||n==Object.prototype)return n;n[E]=w.value;return n};$jscomp.getGlobal=function(n){n=["object"==typeof globalThis&&globalThis,n,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var E=0;E<n.length;++E){var w=n[E];if(w&&w.Math==Math)return w}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(n,E){var w=$jscomp.propertyToPolyfillSymbol[E];if(null==w)return n[E];w=n[w];return void 0!==w?w:n[E]};
$jscomp.polyfill=function(n,E,w,v){E&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(n,E,w,v):$jscomp.polyfillUnisolated(n,E,w,v))};$jscomp.polyfillUnisolated=function(n,E,w,v){w=$jscomp.global;n=n.split(".");for(v=0;v<n.length-1;v++){var k=n[v];if(!(k in w))return;w=w[k]}n=n[n.length-1];v=w[n];E=E(v);E!=v&&null!=E&&$jscomp.defineProperty(w,n,{configurable:!0,writable:!0,value:E})};
$jscomp.polyfillIsolated=function(n,E,w,v){var k=n.split(".");n=1===k.length;v=k[0];v=!n&&v in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var q=0;q<k.length-1;q++){var d=k[q];if(!(d in v))return;v=v[d]}k=k[k.length-1];w=$jscomp.IS_SYMBOL_NATIVE&&"es6"===w?v[k]:null;E=E(w);null!=E&&(n?$jscomp.defineProperty($jscomp.polyfills,k,{configurable:!0,writable:!0,value:E}):E!==w&&(void 0===$jscomp.propertyToPolyfillSymbol[k]&&(w=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[k]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(k):$jscomp.POLYFILL_PREFIX+w+"$"+k),$jscomp.defineProperty(v,$jscomp.propertyToPolyfillSymbol[k],{configurable:!0,writable:!0,value:E})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(n){if(n)return n;var E=function(q,d){this.$jscomp$symbol$id_=q;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:d})};E.prototype.toString=function(){return this.$jscomp$symbol$id_};var w="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",v=0,k=function(q){if(this instanceof k)throw new TypeError("Symbol is not a constructor");return new E(w+(q||"")+"_"+v++,q)};return k},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(n){if(n)return n;n=Symbol("Symbol.iterator");for(var E="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),w=0;w<E.length;w++){var v=$jscomp.global[E[w]];"function"===typeof v&&"function"!=typeof v.prototype[n]&&$jscomp.defineProperty(v.prototype,n,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return n},"es6",
"es3");$jscomp.iteratorPrototype=function(n){n={next:n};n[Symbol.iterator]=function(){return this};return n};$jscomp.findInternal=function(n,E,w){n instanceof String&&(n=String(n));for(var v=n.length,k=0;k<v;k++){var q=n[k];if(E.call(w,q,k,n))return{i:k,v:q}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(n){return n?n:function(E,w){return $jscomp.findInternal(this,E,w).v}},"es6","es3");
$jscomp.checkStringArgs=function(n,E,w){if(null==n)throw new TypeError("The 'this' value for String.prototype."+w+" must not be null or undefined");if(E instanceof RegExp)throw new TypeError("First argument to String.prototype."+w+" must not be a regular expression");return n+""};
$jscomp.polyfill("String.prototype.startsWith",function(n){return n?n:function(E,w){var v=$jscomp.checkStringArgs(this,E,"startsWith");E+="";var k=v.length,q=E.length;w=Math.max(0,Math.min(w|0,v.length));for(var d=0;d<q&&w<k;)if(v[w++]!=E[d++])return!1;return d>=q}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(n){return n?n:function(E,w,v){var k=this.length||0;0>w&&(w=Math.max(0,k+w));if(null==v||v>k)v=k;v=Number(v);0>v&&(v=Math.max(0,k+v));for(w=Number(w||0);w<v;w++)this[w]=E;return this}},"es6","es3");$jscomp.typedArrayFill=function(n){return n?n:Array.prototype.fill};$jscomp.polyfill("Int8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Uint8ClampedArray.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Float32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Float64Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");var ChemDoodle=function(){var n={iChemLabs:{},informatics:{},io:{},lib:{},notations:{},structures:{}};n.structures.d2={};n.structures.d3={};n.getVersion=function(){return"9.1.0"};return n}();
(function(n,E,w){(function(v,k){"object"===typeof module&&"object"===typeof module.exports?module.exports=v.document?k(v,!0):function(q){if(!q.document)throw Error("jQuery requires a window with a document");return k(q)}:k(v)})("undefined"!==typeof n?n:this,function(v,k){function q(h){var u=!!h&&"length"in h&&h.length,z=B.type(h);return"function"===z||B.isWindow(h)?!1:"array"===z||0===u||"number"===typeof u&&0<u&&u-1 in h}function d(h,u,z){if(B.isFunction(u))return B.grep(h,function(D,G){return!!u.call(D,
G,D)!==z});if(u.nodeType)return B.grep(h,function(D){return D===u!==z});if("string"===typeof u){if(Ib.test(u))return B.filter(u,h,z);u=B.filter(u,h)}return B.grep(h,function(D){return-1<Tb.call(u,D)!==z})}function c(h,u){for(;(h=h[u])&&1!==h.nodeType;);return h}function e(h){var u={};B.each(h.match(Ga)||[],function(z,D){u[D]=!0});return u}function b(){ma.removeEventListener("DOMContentLoaded",b);v.removeEventListener("load",b);B.ready()}function g(){this.expando=B.expando+g.uid++}function m(h,u,z){if(z===
w&&1===h.nodeType)if(z="data-"+u.replace(bc,"-$&").toLowerCase(),z=h.getAttribute(z),"string"===typeof z){try{z="true"===z?!0:"false"===z?!1:"null"===z?null:+z+""===z?+z:Fc.test(z)?B.parseJSON(z):z}catch(D){}Ma.set(h,u,z)}else z=w;return z}function p(h,u,z,D){var G=1,J=20,M=D?function(){return D.cur()}:function(){return B.css(h,u,"")},Q=M(),R=z&&z[3]||(B.cssNumber[u]?"":"px"),T=(B.cssNumber[u]||"px"!==R&&+Q)&&yb.exec(B.css(h,u));if(T&&T[3]!==R){R=R||T[3];z=z||[];T=+Q||1;do G=G||".5",T/=G,B.style(h,
u,T+R);while(G!==(G=M()/Q)&&1!==G&&--J)}if(z){T=+T||+Q||0;var ea=z[1]?T+(z[1]+1)*z[2]:+z[2];D&&(D.unit=R,D.start=T,D.end=ea)}return ea}function l(h,u){var z="undefined"!==typeof h.getElementsByTagName?h.getElementsByTagName(u||"*"):"undefined"!==typeof h.querySelectorAll?h.querySelectorAll(u||"*"):[];return u===w||u&&B.nodeName(h,u)?B.merge([h],z):z}function r(h,u){for(var z=0,D=h.length;z<D;z++)sa.set(h[z],"globalEval",!u||sa.get(u[z],"globalEval"))}function y(h,u,z,D,G){for(var J,M,Q,R=u.createDocumentFragment(),
T=[],ea=0,ja=h.length;ea<ja;ea++)if((J=h[ea])||0===J)if("object"===B.type(J))B.merge(T,J.nodeType?[J]:J);else if(jc.test(J)){M=M||R.appendChild(u.createElement("div"));Q=(Za.exec(J)||["",""])[1].toLowerCase();Q=xa[Q]||xa._default;M.innerHTML=Q[1]+B.htmlPrefilter(J)+Q[2];for(Q=Q[0];Q--;)M=M.lastChild;B.merge(T,M.childNodes);M=R.firstChild;M.textContent=""}else T.push(u.createTextNode(J));R.textContent="";for(ea=0;J=T[ea++];)if(D&&-1<B.inArray(J,D))G&&G.push(J);else if(h=B.contains(J.ownerDocument,
J),M=l(R.appendChild(J),"script"),h&&r(M),z)for(Q=0;J=M[Q++];)kc.test(J.type||"")&&z.push(J);return R}function x(){return!0}function A(){return!1}function H(){try{return ma.activeElement}catch(h){}}function a(h,u,z,D,G,J){var M;if("object"===typeof u){"string"!==typeof z&&(D=D||z,z=w);for(M in u)a(h,M,z,D,u[M],J);return h}null==D&&null==G?(G=z,D=z=w):null==G&&("string"===typeof z?(G=D,D=w):(G=D,D=z,z=w));if(!1===G)G=A;else if(!G)return h;if(1===J){var Q=G;G=function(R){B().off(R);return Q.apply(this,
arguments)};G.guid=Q.guid||(Q.guid=B.guid++)}return h.each(function(){B.event.add(this,u,G,D,z)})}function f(h,u){return B.nodeName(h,"table")&&B.nodeName(11!==u.nodeType?u:u.firstChild,"tr")?h.getElementsByTagName("tbody")[0]||h.appendChild(h.ownerDocument.createElement("tbody")):h}function t(h){h.type=(null!==h.getAttribute("type"))+"/"+h.type;return h}function C(h){var u=Ub.exec(h.type);u?h.type=u[1]:h.removeAttribute("type");return h}function F(h,u){var z,D;if(1===u.nodeType){if(sa.hasData(h)){var G=
sa.access(h);var J=sa.set(u,G);if(G=G.events)for(D in delete J.handle,J.events={},G)for(J=0,z=G[D].length;J<z;J++)B.event.add(u,D,G[D][J])}Ma.hasData(h)&&(h=Ma.access(h),h=B.extend({},h),Ma.set(u,h))}}function I(h,u,z,D){u=Jb.apply([],u);var G,J=0,M=h.length,Q=M-1,R=u[0],T=B.isFunction(R);if(T||1<M&&"string"===typeof R&&!Ba.checkClone&&Vb.test(R))return h.each(function(Sa){var Ha=h.eq(Sa);T&&(u[0]=R.call(this,Sa,Ha.html()));I(Ha,u,z,D)});if(M){var ea=y(u,h[0].ownerDocument,!1,h,D);var ja=ea.firstChild;
1===ea.childNodes.length&&(ea=ja);if(ja||D){ja=B.map(l(ea,"script"),t);for(G=ja.length;J<M;J++){var la=ea;J!==Q&&(la=B.clone(la,!0,!0),G&&B.merge(ja,l(la,"script")));z.call(h[J],la,J)}if(G)for(ea=ja[ja.length-1].ownerDocument,B.map(ja,C),J=0;J<G;J++)la=ja[J],kc.test(la.type||"")&&!sa.access(la,"globalEval")&&B.contains(ea,la)&&(la.src?B._evalUrl&&B._evalUrl(la.src):B.globalEval(la.textContent.replace(ob,"")))}}return h}function L(h,u,z){for(var D=u?B.filter(u,h):h,G=0;null!=(u=D[G]);G++)z||1!==u.nodeType||
B.cleanData(l(u)),u.parentNode&&(z&&B.contains(u.ownerDocument,u)&&r(l(u,"script")),u.parentNode.removeChild(u));return h}function O(h,u){h=B(u.createElement(h)).appendTo(u.body);u=B.css(h[0],"display");h.detach();return u}function S(h){var u=ma,z=lc[h];z||(z=O(h,u),"none"!==z&&z||(zb=(zb||B("<iframe frameborder='0' width='0' height='0'/>")).appendTo(u.documentElement),u=zb[0].contentDocument,u.write(),u.close(),z=O(h,u),zb.detach()),lc[h]=z);return z}function W(h,u,z){var D=h.style;var G=(z=z||Ab(h))?
z.getPropertyValue(u)||z[u]:w;""!==G&&G!==w||B.contains(h.ownerDocument,h)||(G=B.style(h,u));if(z&&!Ba.pixelMarginRight()&&Kb.test(G)&&sb.test(u)){h=D.width;u=D.minWidth;var J=D.maxWidth;D.minWidth=D.maxWidth=D.width=G;G=z.width;D.width=h;D.minWidth=u;D.maxWidth=J}return G!==w?G+"":G}function V(h,u){return{get:function(){if(h())delete this.get;else return(this.get=u).apply(this,arguments)}}}function Y(h){if(h in uc)return h;for(var u=h[0].toUpperCase()+h.slice(1),z=Lb.length;z--;)if(h=Lb[z]+u,h in
uc)return h}function ba(h,u,z){return(h=yb.exec(u))?Math.max(0,h[2]-(z||0))+(h[3]||"px"):u}function X(h,u,z,D,G){u=z===(D?"border":"content")?4:"width"===u?1:0;for(var J=0;4>u;u+=2)"margin"===z&&(J+=B.css(h,z+lb[u],!0,G)),D?("content"===z&&(J-=B.css(h,"padding"+lb[u],!0,G)),"margin"!==z&&(J-=B.css(h,"border"+lb[u]+"Width",!0,G))):(J+=B.css(h,"padding"+lb[u],!0,G),"padding"!==z&&(J+=B.css(h,"border"+lb[u]+"Width",!0,G)));return J}function ca(h,u,z){var D=!0,G="width"===u?h.offsetWidth:h.offsetHeight,
J=Ab(h),M="border-box"===B.css(h,"boxSizing",!1,J);if(0>=G||null==G){G=W(h,u,J);if(0>G||null==G)G=h.style[u];if(Kb.test(G))return G;D=M&&(Ba.boxSizingReliable()||G===h.style[u]);G=parseFloat(G)||0}return G+X(h,u,z||(M?"border":"content"),D,J)+"px"}function ia(h,u){for(var z,D,G,J=[],M=0,Q=h.length;M<Q;M++)D=h[M],D.style&&(J[M]=sa.get(D,"olddisplay"),z=D.style.display,u?(J[M]||"none"!==z||(D.style.display=""),""===D.style.display&&Ta(D)&&(J[M]=sa.access(D,"olddisplay",S(D.nodeName)))):(G=Ta(D),"none"===
z&&G||sa.set(D,"olddisplay",G?z:B.css(D,"display"))));for(M=0;M<Q;M++)D=h[M],!D.style||u&&"none"!==D.style.display&&""!==D.style.display||(D.style.display=u?J[M]||"":"none");return h}function Z(h,u,z,D,G){return new Z.prototype.init(h,u,z,D,G)}function oa(){v.setTimeout(function(){Bb=w});return Bb=B.now()}function ka(h,u){var z=0,D={height:h};for(u=u?1:0;4>z;z+=2-u){var G=lb[z];D["margin"+G]=D["padding"+G]=h}u&&(D.opacity=D.width=h);return D}function na(h,u,z){for(var D,G=(ta.tweeners[u]||[]).concat(ta.tweeners["*"]),
J=0,M=G.length;J<M;J++)if(D=G[J].call(z,u,h))return D}function pa(h,u){var z,D;for(z in h){var G=B.camelCase(z);var J=u[G];var M=h[z];B.isArray(M)&&(J=M[1],M=h[z]=M[0]);z!==G&&(h[G]=M,delete h[z]);if((D=B.cssHooks[G])&&"expand"in D)for(z in M=D.expand(M),delete h[G],M)z in h||(h[z]=M[z],u[z]=J);else u[G]=J}}function ta(h,u,z){var D,G=0,J=ta.prefilters.length,M=B.Deferred().always(function(){delete Q.elem}),Q=function(){if(D)return!1;var T=Bb||oa();T=Math.max(0,R.startTime+R.duration-T);for(var ea=
1-(T/R.duration||0),ja=0,la=R.tweens.length;ja<la;ja++)R.tweens[ja].run(ea);M.notifyWith(h,[R,ea,T]);if(1>ea&&la)return T;M.resolveWith(h,[R]);return!1},R=M.promise({elem:h,props:B.extend({},u),opts:B.extend(!0,{specialEasing:{},easing:B.easing._default},z),originalProperties:u,originalOptions:z,startTime:Bb||oa(),duration:z.duration,tweens:[],createTween:function(T,ea){T=B.Tween(h,R.opts,T,ea,R.opts.specialEasing[T]||R.opts.easing);R.tweens.push(T);return T},stop:function(T){var ea=0,ja=T?R.tweens.length:
0;if(D)return this;for(D=!0;ea<ja;ea++)R.tweens[ea].run(1);T?(M.notifyWith(h,[R,1,0]),M.resolveWith(h,[R,T])):M.rejectWith(h,[R,T]);return this}});z=R.props;for(pa(z,R.opts.specialEasing);G<J;G++)if(u=ta.prefilters[G].call(R,h,z,R.opts))return B.isFunction(u.stop)&&(B._queueHooks(R.elem,R.opts.queue).stop=B.proxy(u.stop,u)),u;B.map(z,na,R);B.isFunction(R.opts.start)&&R.opts.start.call(h,R);B.fx.timer(B.extend(Q,{elem:h,anim:R,queue:R.opts.queue}));return R.progress(R.opts.progress).done(R.opts.done,
R.opts.complete).fail(R.opts.fail).always(R.opts.always)}function Ea(h){return h.getAttribute&&h.getAttribute("class")||""}function Ua(h){return function(u,z){"string"!==typeof u&&(z=u,u="*");var D=0,G=u.toLowerCase().match(Ga)||[];if(B.isFunction(z))for(;u=G[D++];)"+"===u[0]?(u=u.slice(1)||"*",(h[u]=h[u]||[]).unshift(z)):(h[u]=h[u]||[]).push(z)}}function Qa(h,u,z,D){function G(Q){var R;J[Q]=!0;B.each(h[Q]||[],function(T,ea){T=ea(u,z,D);if("string"===typeof T&&!M&&!J[T])return u.dataTypes.unshift(T),
G(T),!1;if(M)return!(R=T)});return R}var J={},M=h===Gc;return G(u.dataTypes[0])||!J["*"]&&G("*")}function Va(h,u){var z,D,G=B.ajaxSettings.flatOptions||{};for(z in u)u[z]!==w&&((G[z]?h:D||(D={}))[z]=u[z]);D&&B.extend(!0,h,D);return h}function Ka(h,u,z,D){var G;if(B.isArray(u))B.each(u,function(J,M){z||kd.test(h)?D(h,M):Ka(h+"["+("object"===typeof M&&null!=M?J:"")+"]",M,z,D)});else if(z||"object"!==B.type(u))D(h,u);else for(G in u)Ka(h+"["+G+"]",u[G],z,D)}function mb(h){return B.isWindow(h)?h:9===
h.nodeType&&h.defaultView}var Wa=[],ma=v.document,eb=Wa.slice,Jb=Wa.concat,fb=Wa.push,Tb=Wa.indexOf,tb={},cc=tb.toString,Cb=tb.hasOwnProperty,Ba={},B=function(h,u){return new B.fn.init(h,u)},Mb=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Nb=/^-ms-/,vc=/-([\da-z])/gi,wc=function(h,u){return u.toUpperCase()};B.fn=B.prototype={jquery:"2.2.4",constructor:B,selector:"",length:0,toArray:function(){return eb.call(this)},get:function(h){return null!=h?0>h?this[h+this.length]:this[h]:eb.call(this)},pushStack:function(h){h=
B.merge(this.constructor(),h);h.prevObject=this;h.context=this.context;return h},each:function(h){return B.each(this,h)},map:function(h){return this.pushStack(B.map(this,function(u,z){return h.call(u,z,u)}))},slice:function(){return this.pushStack(eb.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(h){var u=this.length;h=+h+(0>h?u:0);return this.pushStack(0<=h&&h<u?[this[h]]:[])},end:function(){return this.prevObject||this.constructor()},
push:fb,sort:Wa.sort,splice:Wa.splice};B.extend=B.fn.extend=function(){var h,u,z,D=arguments[0]||{},G=1,J=arguments.length,M=!1;"boolean"===typeof D&&(M=D,D=arguments[G]||{},G++);"object"===typeof D||B.isFunction(D)||(D={});G===J&&(D=this,G--);for(;G<J;G++)if(null!=(h=arguments[G]))for(u in h){var Q=D[u];var R=h[u];D!==R&&(M&&R&&(B.isPlainObject(R)||(z=B.isArray(R)))?(z?(z=!1,Q=Q&&B.isArray(Q)?Q:[]):Q=Q&&B.isPlainObject(Q)?Q:{},D[u]=B.extend(M,Q,R)):R!==w&&(D[u]=R))}return D};B.extend({expando:"jQuery"+
("2.2.4"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(h){throw Error(h);},noop:function(){},isFunction:function(h){return"function"===B.type(h)},isArray:Array.isArray,isWindow:function(h){return null!=h&&h===h.window},isNumeric:function(h){var u=h&&h.toString();return!B.isArray(h)&&0<=u-parseFloat(u)+1},isPlainObject:function(h){var u;if("object"!==B.type(h)||h.nodeType||B.isWindow(h)||h.constructor&&!Cb.call(h,"constructor")&&!Cb.call(h.constructor.prototype||{},"isPrototypeOf"))return!1;
for(u in h);return u===w||Cb.call(h,u)},isEmptyObject:function(h){for(var u in h)return!1;return!0},type:function(h){return null==h?h+"":"object"===typeof h||"function"===typeof h?tb[cc.call(h)]||"object":typeof h},globalEval:function(h){var u=eval;if(h=B.trim(h))1===h.indexOf("use strict")?(u=ma.createElement("script"),u.text=h,ma.head.appendChild(u).parentNode.removeChild(u)):u(h)},camelCase:function(h){return h.replace(Nb,"ms-").replace(vc,wc)},nodeName:function(h,u){return h.nodeName&&h.nodeName.toLowerCase()===
u.toLowerCase()},each:function(h,u){var z,D=0;if(q(h))for(z=h.length;D<z&&!1!==u.call(h[D],D,h[D]);D++);else for(D in h)if(!1===u.call(h[D],D,h[D]))break;return h},trim:function(h){return null==h?"":(h+"").replace(Mb,"")},makeArray:function(h,u){u=u||[];null!=h&&(q(Object(h))?B.merge(u,"string"===typeof h?[h]:h):fb.call(u,h));return u},inArray:function(h,u,z){return null==u?-1:Tb.call(u,h,z)},merge:function(h,u){for(var z=+u.length,D=0,G=h.length;D<z;D++)h[G++]=u[D];h.length=G;return h},grep:function(h,
u,z){for(var D=[],G=0,J=h.length,M=!z;G<J;G++)z=!u(h[G],G),z!==M&&D.push(h[G]);return D},map:function(h,u,z){var D,G=0,J=[];if(q(h))for(D=h.length;G<D;G++){var M=u(h[G],G,z);null!=M&&J.push(M)}else for(G in h)M=u(h[G],G,z),null!=M&&J.push(M);return Jb.apply([],J)},guid:1,proxy:function(h,u){if("string"===typeof u){var z=h[u];u=h;h=z}if(!B.isFunction(h))return w;var D=eb.call(arguments,2);z=function(){return h.apply(u||this,D.concat(eb.call(arguments)))};z.guid=h.guid=h.guid||B.guid++;return z},now:Date.now,
support:Ba});"function"===typeof Symbol&&(B.fn[Symbol.iterator]=Wa[Symbol.iterator]);B.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(h,u){tb["[object "+u+"]"]=u.toLowerCase()});var vb=function(h){function u(K,P,N,U){var aa,fa,da,qa,ha=P&&P.ownerDocument,ua=P?P.nodeType:9;N=N||[];if("string"!==typeof K||!K||1!==ua&&9!==ua&&11!==ua)return N;if(!U&&((P?P.ownerDocument||P:Ia)!==va&&mc(P),P=P||va,La)){if(11!==ua&&(qa=ld.exec(K)))if(aa=qa[1])if(9===ua)if(fa=
P.getElementById(aa)){if(fa.id===aa)return N.push(fa),N}else return N;else{if(ha&&(fa=ha.getElementById(aa))&&ib(P,fa)&&fa.id===aa)return N.push(fa),N}else{if(qa[2])return dc.apply(N,P.getElementsByTagName(K)),N;if((aa=qa[3])&&Na.getElementsByClassName&&P.getElementsByClassName)return dc.apply(N,P.getElementsByClassName(aa)),N}if(!(!Na.qsa||gb[K+" "]||Da&&Da.test(K))){if(1!==ua){ha=P;var Aa=K}else if("object"!==P.nodeName.toLowerCase()){(da=P.getAttribute("id"))?da=da.replace(md,"\\$&"):P.setAttribute("id",
da=Ca);qa=Nc(K);aa=qa.length;for(fa=cd.test(da)?"#"+da:"[id='"+da+"']";aa--;)qa[aa]=fa+" "+la(qa[aa]);Aa=qa.join(",");ha=Uc.test(K)&&ea(P.parentNode)||P}if(Aa)try{return dc.apply(N,ha.querySelectorAll(Aa)),N}catch(ra){}finally{da===Ca&&P.removeAttribute("id")}}}return nd(K.replace(Oc,"$1"),P,N,U)}function z(){function K(N,U){P.push(N+" ")>Fa.cacheLength&&delete K[P.shift()];return K[N+" "]=U}var P=[];return K}function D(K){K[Ca]=!0;return K}function G(K){var P=va.createElement("div");try{return!!K(P)}catch(N){return!1}finally{P.parentNode&&
P.parentNode.removeChild(P)}}function J(K,P){K=K.split("|");for(var N=K.length;N--;)Fa.attrHandle[K[N]]=P}function M(K,P){var N=P&&K,U=N&&1===K.nodeType&&1===P.nodeType&&(~P.sourceIndex||-2147483648)-(~K.sourceIndex||-2147483648);if(U)return U;if(N)for(;N=N.nextSibling;)if(N===P)return-1;return K?1:-1}function Q(K){return function(P){return"input"===P.nodeName.toLowerCase()&&P.type===K}}function R(K){return function(P){var N=P.nodeName.toLowerCase();return("input"===N||"button"===N)&&P.type===K}}
function T(K){return D(function(P){P=+P;return D(function(N,U){for(var aa,fa=K([],N.length,P),da=fa.length;da--;)N[aa=fa[da]]&&(N[aa]=!(U[aa]=N[aa]))})})}function ea(K){return K&&"undefined"!==typeof K.getElementsByTagName&&K}function ja(){}function la(K){for(var P=0,N=K.length,U="";P<N;P++)U+=K[P].value;return U}function Sa(K,P,N){var U=P.dir,aa=N&&"parentNode"===U,fa=Db++;return P.first?function(da,qa,ha){for(;da=da[U];)if(1===da.nodeType||aa)return K(da,qa,ha)}:function(da,qa,ha){var ua,Aa=[ab,
fa];if(ha)for(;da=da[U];){if((1===da.nodeType||aa)&&K(da,qa,ha))return!0}else for(;da=da[U];)if(1===da.nodeType||aa){var ra=da[Ca]||(da[Ca]={});ra=ra[da.uniqueID]||(ra[da.uniqueID]={});if((ua=ra[U])&&ua[0]===ab&&ua[1]===fa)return Aa[2]=ua[2];ra[U]=Aa;if(Aa[2]=K(da,qa,ha))return!0}}}function Ha(K){return 1<K.length?function(P,N,U){for(var aa=K.length;aa--;)if(!K[aa](P,N,U))return!1;return!0}:K[0]}function ub(K,P,N,U,aa){for(var fa,da=[],qa=0,ha=K.length,ua=null!=P;qa<ha;qa++)if(fa=K[qa])if(!N||N(fa,
U,aa))da.push(fa),ua&&P.push(qa);return da}function pb(K,P,N,U,aa,fa){U&&!U[Ca]&&(U=pb(U));aa&&!aa[Ca]&&(aa=pb(aa,fa));return D(function(da,qa,ha,ua){var Aa,ra=[],Oa=[],bb=qa.length,$a;if(!($a=da)){$a=P||"*";for(var wa=ha.nodeType?[ha]:ha,Ob=[],Ra=0,Pc=wa.length;Ra<Pc;Ra++)u($a,wa[Ra],Ob);$a=Ob}$a=!K||!da&&P?$a:ub($a,ra,K,ha,ua);wa=N?aa||(da?K:bb||U)?[]:qa:$a;N&&N($a,wa,ha,ua);if(U){var Eb=ub(wa,Oa);U(Eb,[],ha,ua);for(ha=Eb.length;ha--;)if(Aa=Eb[ha])wa[Oa[ha]]=!($a[Oa[ha]]=Aa)}if(da){if(aa||K){if(aa){Eb=
[];for(ha=wa.length;ha--;)(Aa=wa[ha])&&Eb.push($a[ha]=Aa);aa(null,wa=[],Eb,ua)}for(ha=wa.length;ha--;)(Aa=wa[ha])&&-1<(Eb=aa?nc(da,Aa):ra[ha])&&(da[Eb]=!(qa[Eb]=Aa))}}else wa=ub(wa===qa?wa.splice(bb,wa.length):wa),aa?aa(null,qa,wa,ua):dc.apply(qa,wa)})}function jb(K){var P,N,U=K.length,aa=Fa.relative[K[0].type];var fa=aa||Fa.relative[" "];for(var da=aa?1:0,qa=Sa(function(Aa){return Aa===P},fa,!0),ha=Sa(function(Aa){return-1<nc(P,Aa)},fa,!0),ua=[function(Aa,ra,Oa){Aa=!aa&&(Oa||ra!==hb)||((P=ra).nodeType?
qa(Aa,ra,Oa):ha(Aa,ra,Oa));P=null;return Aa}];da<U;da++)if(fa=Fa.relative[K[da].type])ua=[Sa(Ha(ua),fa)];else{fa=Fa.filter[K[da].type].apply(null,K[da].matches);if(fa[Ca]){for(N=++da;N<U&&!Fa.relative[K[N].type];N++);return pb(1<da&&Ha(ua),1<da&&la(K.slice(0,da-1).concat({value:" "===K[da-2].type?"*":""})).replace(Oc,"$1"),fa,da<N&&jb(K.slice(da,N)),N<U&&jb(K=K.slice(N)),N<U&&la(K))}ua.push(fa)}return Ha(ua)}function Qc(K,P){var N=0<P.length,U=0<K.length,aa=function(fa,da,qa,ha,ua){var Aa,ra,Oa=0,
bb="0",$a=fa&&[],wa=[],Ob=hb,Ra=fa||U&&Fa.find.TAG("*",ua),Pc=ab+=null==Ob?1:Math.random()||.1,Eb=Ra.length;for(ua&&(hb=da===va||da||ua);bb!==Eb&&null!=(Aa=Ra[bb]);bb++){if(U&&Aa){var Vc=0;da||Aa.ownerDocument===va||(mc(Aa),qa=!La);for(;ra=K[Vc++];)if(ra(Aa,da||va,qa)){ha.push(Aa);break}ua&&(ab=Pc)}N&&((Aa=!ra&&Aa)&&Oa--,fa&&$a.push(Aa))}Oa+=bb;if(N&&bb!==Oa){for(Vc=0;ra=P[Vc++];)ra($a,wa,da,qa);if(fa){if(0<Oa)for(;bb--;)$a[bb]||wa[bb]||(wa[bb]=od.call(ha));wa=ub(wa)}dc.apply(ha,wa);ua&&!fa&&0<wa.length&&
1<Oa+P.length&&u.uniqueSort(ha)}ua&&(ab=Pc,hb=Ob);return $a};return N?D(aa):aa}var ya,hb,za,Pa,va,Xa,La,Da,cb,db,ib,Ca="sizzle"+1*new Date,Ia=h.document,ab=0,Db=0,oc=z(),Pb=z(),gb=z(),xc=function(K,P){K===P&&(Pa=!0);return 0},yc={}.hasOwnProperty,Wb=[],od=Wb.pop,pd=Wb.push,dc=Wb.push,dd=Wb.slice,nc=function(K,P){for(var N=0,U=K.length;N<U;N++)if(K[N]===P)return N;return-1},qd=RegExp("[\\x20\\t\\r\\n\\f]+","g"),Oc=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),rd=
RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),sd=RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),td=RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*?)[\\x20\\t\\r\\n\\f]*\\]","g"),ud=RegExp(":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
cd=RegExp("^(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+$"),Rc={ID:RegExp("^#((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)"),CLASS:RegExp("^\\.((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)"),TAG:RegExp("^((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+|[*])"),ATTR:RegExp("^\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\]"),PSEUDO:RegExp("^:((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)",
"i")},vd=/^(?:input|select|textarea|button)$/i,wd=/^h\d$/i,Hc=/^[^{]+\{\s*\[native \w/,ld=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Uc=/[+~]/,md=/'|\\/g,Xb=RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)","ig"),Yb=function(K,P,N){K="0x"+P-65536;return K!==K||N?P:0>K?String.fromCharCode(K+65536):String.fromCharCode(K>>10|55296,K&1023|56320)},ed=function(){mc()};try{dc.apply(Wb=dd.call(Ia.childNodes),Ia.childNodes),Wb[Ia.childNodes.length].nodeType}catch(K){dc={apply:Wb.length?function(P,
N){pd.apply(P,dd.call(N))}:function(P,N){for(var U=P.length,aa=0;P[U++]=N[aa++];);P.length=U-1}}}var Na=u.support={};var xd=u.isXML=function(K){return(K=K&&(K.ownerDocument||K).documentElement)?"HTML"!==K.nodeName:!1};var mc=u.setDocument=function(K){var P;K=K?K.ownerDocument||K:Ia;if(K===va||9!==K.nodeType||!K.documentElement)return va;va=K;Xa=va.documentElement;La=!xd(va);(P=va.defaultView)&&P.top!==P&&(P.addEventListener?P.addEventListener("unload",ed,!1):P.attachEvent&&P.attachEvent("onunload",
ed));Na.attributes=G(function(N){N.className="i";return!N.getAttribute("className")});Na.getElementsByTagName=G(function(N){N.appendChild(va.createComment(""));return!N.getElementsByTagName("*").length});Na.getElementsByClassName=Hc.test(va.getElementsByClassName);Na.getById=G(function(N){Xa.appendChild(N).id=Ca;return!va.getElementsByName||!va.getElementsByName(Ca).length});Na.getById?(Fa.find.ID=function(N,U){if("undefined"!==typeof U.getElementById&&La)return(N=U.getElementById(N))?[N]:[]},Fa.filter.ID=
function(N){var U=N.replace(Xb,Yb);return function(aa){return aa.getAttribute("id")===U}}):(delete Fa.find.ID,Fa.filter.ID=function(N){var U=N.replace(Xb,Yb);return function(aa){return(aa="undefined"!==typeof aa.getAttributeNode&&aa.getAttributeNode("id"))&&aa.value===U}});Fa.find.TAG=Na.getElementsByTagName?function(N,U){if("undefined"!==typeof U.getElementsByTagName)return U.getElementsByTagName(N);if(Na.qsa)return U.querySelectorAll(N)}:function(N,U){var aa=[],fa=0;U=U.getElementsByTagName(N);
if("*"===N){for(;N=U[fa++];)1===N.nodeType&&aa.push(N);return aa}return U};Fa.find.CLASS=Na.getElementsByClassName&&function(N,U){if("undefined"!==typeof U.getElementsByClassName&&La)return U.getElementsByClassName(N)};cb=[];Da=[];if(Na.qsa=Hc.test(va.querySelectorAll))G(function(N){Xa.appendChild(N).innerHTML="<a id='"+Ca+"'></a><select id='"+Ca+"-\r\\' msallowcapture=''><option selected=''></option></select>";N.querySelectorAll("[msallowcapture^='']").length&&Da.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");
N.querySelectorAll("[selected]").length||Da.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");N.querySelectorAll("[id~="+Ca+"-]").length||Da.push("~=");N.querySelectorAll(":checked").length||Da.push(":checked");N.querySelectorAll("a#"+Ca+"+*").length||Da.push(".#.+[+~]")}),G(function(N){var U=va.createElement("input");U.setAttribute("type","hidden");N.appendChild(U).setAttribute("name",
"D");N.querySelectorAll("[name=d]").length&&Da.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?=");N.querySelectorAll(":enabled").length||Da.push(":enabled",":disabled");N.querySelectorAll("*,:x");Da.push(",.*:")});(Na.matchesSelector=Hc.test(db=Xa.matches||Xa.webkitMatchesSelector||Xa.mozMatchesSelector||Xa.oMatchesSelector||Xa.msMatchesSelector))&&G(function(N){Na.disconnectedMatch=db.call(N,"div");db.call(N,"[s!='']:x");cb.push("!=",":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)")});
Da=Da.length&&new RegExp(Da.join("|"));cb=cb.length&&new RegExp(cb.join("|"));ib=(P=Hc.test(Xa.compareDocumentPosition))||Hc.test(Xa.contains)?function(N,U){var aa=9===N.nodeType?N.documentElement:N;U=U&&U.parentNode;return N===U||!!(U&&1===U.nodeType&&(aa.contains?aa.contains(U):N.compareDocumentPosition&&N.compareDocumentPosition(U)&16))}:function(N,U){if(U)for(;U=U.parentNode;)if(U===N)return!0;return!1};xc=P?function(N,U){if(N===U)return Pa=!0,0;var aa=!N.compareDocumentPosition-!U.compareDocumentPosition;
if(aa)return aa;aa=(N.ownerDocument||N)===(U.ownerDocument||U)?N.compareDocumentPosition(U):1;return aa&1||!Na.sortDetached&&U.compareDocumentPosition(N)===aa?N===va||N.ownerDocument===Ia&&ib(Ia,N)?-1:U===va||U.ownerDocument===Ia&&ib(Ia,U)?1:za?nc(za,N)-nc(za,U):0:aa&4?-1:1}:function(N,U){if(N===U)return Pa=!0,0;var aa=0,fa=N.parentNode,da=U.parentNode,qa=[N],ha=[U];if(!fa||!da)return N===va?-1:U===va?1:fa?-1:da?1:za?nc(za,N)-nc(za,U):0;if(fa===da)return M(N,U);for(;N=N.parentNode;)qa.unshift(N);
for(N=U;N=N.parentNode;)ha.unshift(N);for(;qa[aa]===ha[aa];)aa++;return aa?M(qa[aa],ha[aa]):qa[aa]===Ia?-1:ha[aa]===Ia?1:0};return va};u.matches=function(K,P){return u(K,null,null,P)};u.matchesSelector=function(K,P){(K.ownerDocument||K)!==va&&mc(K);P=P.replace(td,"='$1']");if(!(!Na.matchesSelector||!La||gb[P+" "]||cb&&cb.test(P)||Da&&Da.test(P)))try{var N=db.call(K,P);if(N||Na.disconnectedMatch||K.document&&11!==K.document.nodeType)return N}catch(U){}return 0<u(P,va,null,[K]).length};u.contains=function(K,
P){(K.ownerDocument||K)!==va&&mc(K);return ib(K,P)};u.attr=function(K,P){(K.ownerDocument||K)!==va&&mc(K);var N=Fa.attrHandle[P.toLowerCase()];N=N&&yc.call(Fa.attrHandle,P.toLowerCase())?N(K,P,!La):w;return N!==w?N:Na.attributes||!La?K.getAttribute(P):(N=K.getAttributeNode(P))&&N.specified?N.value:null};u.error=function(K){throw Error("Syntax error, unrecognized expression: "+K);};u.uniqueSort=function(K){var P,N=[],U=0,aa=0;Pa=!Na.detectDuplicates;za=!Na.sortStable&&K.slice(0);K.sort(xc);if(Pa){for(;P=
K[aa++];)P===K[aa]&&(U=N.push(aa));for(;U--;)K.splice(N[U],1)}za=null;return K};var Wc=u.getText=function(K){var P="",N=0;var U=K.nodeType;if(!U)for(;U=K[N++];)P+=Wc(U);else if(1===U||9===U||11===U){if("string"===typeof K.textContent)return K.textContent;for(K=K.firstChild;K;K=K.nextSibling)P+=Wc(K)}else if(3===U||4===U)return K.nodeValue;return P};var Fa=u.selectors={cacheLength:50,createPseudo:D,match:Rc,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",
first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(K){K[1]=K[1].replace(Xb,Yb);K[3]=(K[3]||K[4]||K[5]||"").replace(Xb,Yb);"~="===K[2]&&(K[3]=" "+K[3]+" ");return K.slice(0,4)},CHILD:function(K){K[1]=K[1].toLowerCase();"nth"===K[1].slice(0,3)?(K[3]||u.error(K[0]),K[4]=+(K[4]?K[5]+(K[6]||1):2*("even"===K[3]||"odd"===K[3])),K[5]=+(K[7]+K[8]||"odd"===K[3])):K[3]&&u.error(K[0]);return K},PSEUDO:function(K){var P,N=!K[6]&&K[2];if(Rc.CHILD.test(K[0]))return null;K[3]?K[2]=K[4]||K[5]||"":N&&
ud.test(N)&&(P=Nc(N,!0))&&(P=N.indexOf(")",N.length-P)-N.length)&&(K[0]=K[0].slice(0,P),K[2]=N.slice(0,P));return K.slice(0,3)}},filter:{TAG:function(K){var P=K.replace(Xb,Yb).toLowerCase();return"*"===K?function(){return!0}:function(N){return N.nodeName&&N.nodeName.toLowerCase()===P}},CLASS:function(K){var P=oc[K+" "];return P||(P=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+K+"([\\x20\\t\\r\\n\\f]|$)"),oc(K,function(N){return P.test("string"===typeof N.className&&N.className||"undefined"!==typeof N.getAttribute&&
N.getAttribute("class")||"")}))},ATTR:function(K,P,N){return function(U){U=u.attr(U,K);if(null==U)return"!="===P;if(!P)return!0;U+="";return"="===P?U===N:"!="===P?U!==N:"^="===P?N&&0===U.indexOf(N):"*="===P?N&&-1<U.indexOf(N):"$="===P?N&&U.slice(-N.length)===N:"~="===P?-1<(" "+U.replace(qd," ")+" ").indexOf(N):"|="===P?U===N||U.slice(0,N.length+1)===N+"-":!1}},CHILD:function(K,P,N,U,aa){var fa="nth"!==K.slice(0,3),da="last"!==K.slice(-4),qa="of-type"===P;return 1===U&&0===aa?function(ha){return!!ha.parentNode}:
function(ha,ua,Aa){var ra,Oa;ua=fa!==da?"nextSibling":"previousSibling";var bb=ha.parentNode,$a=qa&&ha.nodeName.toLowerCase();Aa=!Aa&&!qa;var wa=!1;if(bb){if(fa){for(;ua;){for(ra=ha;ra=ra[ua];)if(qa?ra.nodeName.toLowerCase()===$a:1===ra.nodeType)return!1;var Ob=ua="only"===K&&!Ob&&"nextSibling"}return!0}Ob=[da?bb.firstChild:bb.lastChild];if(da&&Aa){ra=bb;var Ra=ra[Ca]||(ra[Ca]={});Ra=Ra[ra.uniqueID]||(Ra[ra.uniqueID]={});wa=Ra[K]||[];wa=(Oa=wa[0]===ab&&wa[1])&&wa[2];for(ra=Oa&&bb.childNodes[Oa];ra=
++Oa&&ra&&ra[ua]||(wa=Oa=0)||Ob.pop();)if(1===ra.nodeType&&++wa&&ra===ha){Ra[K]=[ab,Oa,wa];break}}else if(Aa&&(ra=ha,Ra=ra[Ca]||(ra[Ca]={}),Ra=Ra[ra.uniqueID]||(Ra[ra.uniqueID]={}),wa=Ra[K]||[],wa=Oa=wa[0]===ab&&wa[1]),!1===wa)for(;(ra=++Oa&&ra&&ra[ua]||(wa=Oa=0)||Ob.pop())&&((qa?ra.nodeName.toLowerCase()!==$a:1!==ra.nodeType)||!++wa||(Aa&&(Ra=ra[Ca]||(ra[Ca]={}),Ra=Ra[ra.uniqueID]||(Ra[ra.uniqueID]={}),Ra[K]=[ab,wa]),ra!==ha)););wa-=aa;return wa===U||0===wa%U&&0<=wa/U}}},PSEUDO:function(K,P){var N=
Fa.pseudos[K]||Fa.setFilters[K.toLowerCase()]||u.error("unsupported pseudo: "+K);if(N[Ca])return N(P);if(1<N.length){var U=[K,K,"",P];return Fa.setFilters.hasOwnProperty(K.toLowerCase())?D(function(aa,fa){for(var da,qa=N(aa,P),ha=qa.length;ha--;)da=nc(aa,qa[ha]),aa[da]=!(fa[da]=qa[ha])}):function(aa){return N(aa,0,U)}}return N}},pseudos:{not:D(function(K){var P=[],N=[],U=fd(K.replace(Oc,"$1"));return U[Ca]?D(function(aa,fa,da,qa){qa=U(aa,null,qa,[]);for(var ha=aa.length;ha--;)if(da=qa[ha])aa[ha]=
!(fa[ha]=da)}):function(aa,fa,da){P[0]=aa;U(P,null,da,N);P[0]=null;return!N.pop()}}),has:D(function(K){return function(P){return 0<u(K,P).length}}),contains:D(function(K){K=K.replace(Xb,Yb);return function(P){return-1<(P.textContent||P.innerText||Wc(P)).indexOf(K)}}),lang:D(function(K){cd.test(K||"")||u.error("unsupported lang: "+K);K=K.replace(Xb,Yb).toLowerCase();return function(P){var N;do if(N=La?P.lang:P.getAttribute("xml:lang")||P.getAttribute("lang"))return N=N.toLowerCase(),N===K||0===N.indexOf(K+
"-");while((P=P.parentNode)&&1===P.nodeType);return!1}}),target:function(K){var P=h.location&&h.location.hash;return P&&P.slice(1)===K.id},root:function(K){return K===Xa},focus:function(K){return K===va.activeElement&&(!va.hasFocus||va.hasFocus())&&!!(K.type||K.href||~K.tabIndex)},enabled:function(K){return!1===K.disabled},disabled:function(K){return!0===K.disabled},checked:function(K){var P=K.nodeName.toLowerCase();return"input"===P&&!!K.checked||"option"===P&&!!K.selected},selected:function(K){K.parentNode&&
K.parentNode.selectedIndex;return!0===K.selected},empty:function(K){for(K=K.firstChild;K;K=K.nextSibling)if(6>K.nodeType)return!1;return!0},parent:function(K){return!Fa.pseudos.empty(K)},header:function(K){return wd.test(K.nodeName)},input:function(K){return vd.test(K.nodeName)},button:function(K){var P=K.nodeName.toLowerCase();return"input"===P&&"button"===K.type||"button"===P},text:function(K){var P;return"input"===K.nodeName.toLowerCase()&&"text"===K.type&&(null==(P=K.getAttribute("type"))||"text"===
P.toLowerCase())},first:T(function(){return[0]}),last:T(function(K,P){return[P-1]}),eq:T(function(K,P,N){return[0>N?N+P:N]}),even:T(function(K,P){for(var N=0;N<P;N+=2)K.push(N);return K}),odd:T(function(K,P){for(var N=1;N<P;N+=2)K.push(N);return K}),lt:T(function(K,P,N){for(P=0>N?N+P:N;0<=--P;)K.push(P);return K}),gt:T(function(K,P,N){for(N=0>N?N+P:N;++N<P;)K.push(N);return K})}};Fa.pseudos.nth=Fa.pseudos.eq;for(ya in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Fa.pseudos[ya]=Q(ya);for(ya in{submit:!0,
reset:!0})Fa.pseudos[ya]=R(ya);ja.prototype=Fa.filters=Fa.pseudos;Fa.setFilters=new ja;var Nc=u.tokenize=function(K,P){var N,U,aa,fa,da;if(fa=Pb[K+" "])return P?0:fa.slice(0);fa=K;var qa=[];for(da=Fa.preFilter;fa;){if(!ha||(N=rd.exec(fa)))N&&(fa=fa.slice(N[0].length)||fa),qa.push(U=[]);var ha=!1;if(N=sd.exec(fa))ha=N.shift(),U.push({value:ha,type:N[0].replace(Oc," ")}),fa=fa.slice(ha.length);for(aa in Fa.filter)!(N=Rc[aa].exec(fa))||da[aa]&&!(N=da[aa](N))||(ha=N.shift(),U.push({value:ha,type:aa,matches:N}),
fa=fa.slice(ha.length));if(!ha)break}return P?fa.length:fa?u.error(K):Pb(K,qa).slice(0)};var fd=u.compile=function(K,P){var N,U=[],aa=[],fa=gb[K+" "];if(!fa){P||(P=Nc(K));for(N=P.length;N--;)fa=jb(P[N]),fa[Ca]?U.push(fa):aa.push(fa);fa=gb(K,Qc(aa,U));fa.selector=K}return fa};var nd=u.select=function(K,P,N,U){var aa,fa,da,qa="function"===typeof K&&K,ha=!U&&Nc(K=qa.selector||K);N=N||[];if(1===ha.length){var ua=ha[0]=ha[0].slice(0);if(2<ua.length&&"ID"===(fa=ua[0]).type&&Na.getById&&9===P.nodeType&&
La&&Fa.relative[ua[1].type]){P=(Fa.find.ID(fa.matches[0].replace(Xb,Yb),P)||[])[0];if(!P)return N;qa&&(P=P.parentNode);K=K.slice(ua.shift().value.length)}for(aa=Rc.needsContext.test(K)?0:ua.length;aa--;){fa=ua[aa];if(Fa.relative[da=fa.type])break;if(da=Fa.find[da])if(U=da(fa.matches[0].replace(Xb,Yb),Uc.test(ua[0].type)&&ea(P.parentNode)||P)){ua.splice(aa,1);K=U.length&&la(ua);if(!K)return dc.apply(N,U),N;break}}}(qa||fd(K,ha))(U,P,!La,N,!P||Uc.test(K)&&ea(P.parentNode)||P);return N};Na.sortStable=
Ca.split("").sort(xc).join("")===Ca;Na.detectDuplicates=!!Pa;mc();Na.sortDetached=G(function(K){return K.compareDocumentPosition(va.createElement("div"))&1});G(function(K){K.innerHTML="<a href='#'></a>";return"#"===K.firstChild.getAttribute("href")})||J("type|href|height|width",function(K,P,N){if(!N)return K.getAttribute(P,"type"===P.toLowerCase()?1:2)});Na.attributes&&G(function(K){K.innerHTML="<input/>";K.firstChild.setAttribute("value","");return""===K.firstChild.getAttribute("value")})||J("value",
function(K,P,N){if(!N&&"input"===K.nodeName.toLowerCase())return K.defaultValue});G(function(K){return null==K.getAttribute("disabled")})||J("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(K,P,N){var U;if(!N)return!0===K[P]?P.toLowerCase():(U=K.getAttributeNode(P))&&U.specified?U.value:null});return u}(v);B.find=vb;B.expr=vb.selectors;B.expr[":"]=B.expr.pseudos;B.uniqueSort=B.unique=vb.uniqueSort;B.text=vb.getText;
B.isXMLDoc=vb.isXML;B.contains=vb.contains;var kb=function(h,u,z){for(var D=[],G=z!==w;(h=h[u])&&9!==h.nodeType;)if(1===h.nodeType){if(G&&B(h).is(z))break;D.push(h)}return D},Fb=function(h,u){for(var z=[];h;h=h.nextSibling)1===h.nodeType&&h!==u&&z.push(h);return z},pc=B.expr.match.needsContext,Zb=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,Ib=/^.[^:#\[\.,]*$/;B.filter=function(h,u,z){var D=u[0];z&&(h=":not("+h+")");return 1===u.length&&1===D.nodeType?B.find.matchesSelector(D,h)?[D]:[]:B.find.matches(h,B.grep(u,
function(G){return 1===G.nodeType}))};B.fn.extend({find:function(h){var u,z=this.length,D=[],G=this;if("string"!==typeof h)return this.pushStack(B(h).filter(function(){for(u=0;u<z;u++)if(B.contains(G[u],this))return!0}));for(u=0;u<z;u++)B.find(h,G[u],D);D=this.pushStack(1<z?B.unique(D):D);D.selector=this.selector?this.selector+" "+h:h;return D},filter:function(h){return this.pushStack(d(this,h||[],!1))},not:function(h){return this.pushStack(d(this,h||[],!0))},is:function(h){return!!d(this,"string"===
typeof h&&pc.test(h)?B(h):h||[],!1).length}});var $b=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(B.fn.init=function(h,u,z){if(!h)return this;z=z||Gb;if("string"===typeof h){var D="<"===h[0]&&">"===h[h.length-1]&&3<=h.length?[null,h,null]:$b.exec(h);if(!D||!D[1]&&u)return!u||u.jquery?(u||z).find(h):this.constructor(u).find(h);if(D[1]){if(u=u instanceof B?u[0]:u,B.merge(this,B.parseHTML(D[1],u&&u.nodeType?u.ownerDocument||u:ma,!0)),Zb.test(D[1])&&B.isPlainObject(u))for(D in u)if(B.isFunction(this[D]))this[D](u[D]);
else this.attr(D,u[D])}else(u=ma.getElementById(D[2]))&&u.parentNode&&(this.length=1,this[0]=u),this.context=ma,this.selector=h;return this}if(h.nodeType)return this.context=this[0]=h,this.length=1,this;if(B.isFunction(h))return z.ready!==w?z.ready(h):h(B);h.selector!==w&&(this.selector=h.selector,this.context=h.context);return B.makeArray(h,this)}).prototype=B.fn;var Gb=B(ma);var Hb=/^(?:parents|prev(?:Until|All))/,zc={children:!0,contents:!0,next:!0,prev:!0};B.fn.extend({has:function(h){var u=B(h,
this),z=u.length;return this.filter(function(){for(var D=0;D<z;D++)if(B.contains(this,u[D]))return!0})},closest:function(h,u){for(var z,D=0,G=this.length,J=[],M=pc.test(h)||"string"!==typeof h?B(h,u||this.context):0;D<G;D++)for(z=this[D];z&&z!==u;z=z.parentNode)if(11>z.nodeType&&(M?-1<M.index(z):1===z.nodeType&&B.find.matchesSelector(z,h))){J.push(z);break}return this.pushStack(1<J.length?B.uniqueSort(J):J)},index:function(h){return h?"string"===typeof h?Tb.call(B(h),this[0]):Tb.call(this,h.jquery?
h[0]:h):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(h,u){return this.pushStack(B.uniqueSort(B.merge(this.get(),B(h,u))))},addBack:function(h){return this.add(null==h?this.prevObject:this.prevObject.filter(h))}});B.each({parent:function(h){return(h=h.parentNode)&&11!==h.nodeType?h:null},parents:function(h){return kb(h,"parentNode")},parentsUntil:function(h,u,z){return kb(h,"parentNode",z)},next:function(h){return c(h,"nextSibling")},prev:function(h){return c(h,"previousSibling")},
nextAll:function(h){return kb(h,"nextSibling")},prevAll:function(h){return kb(h,"previousSibling")},nextUntil:function(h,u,z){return kb(h,"nextSibling",z)},prevUntil:function(h,u,z){return kb(h,"previousSibling",z)},siblings:function(h){return Fb((h.parentNode||{}).firstChild,h)},children:function(h){return Fb(h.firstChild)},contents:function(h){return h.contentDocument||B.merge([],h.childNodes)}},function(h,u){B.fn[h]=function(z,D){var G=B.map(this,u,z);"Until"!==h.slice(-5)&&(D=z);D&&"string"===
typeof D&&(G=B.filter(D,G));1<this.length&&(zc[h]||B.uniqueSort(G),Hb.test(h)&&G.reverse());return this.pushStack(G)}});var Ga=/\S+/g;B.Callbacks=function(h){h="string"===typeof h?e(h):B.extend({},h);var u,z,D,G,J=[],M=[],Q=-1,R=function(){G=h.once;for(D=u=!0;M.length;Q=-1)for(z=M.shift();++Q<J.length;)!1===J[Q].apply(z[0],z[1])&&h.stopOnFalse&&(Q=J.length,z=!1);h.memory||(z=!1);u=!1;G&&(J=z?[]:"")},T={add:function(){J&&(z&&!u&&(Q=J.length-1,M.push(z)),function la(ja){B.each(ja,function(Sa,Ha){B.isFunction(Ha)?
h.unique&&T.has(Ha)||J.push(Ha):Ha&&Ha.length&&"string"!==B.type(Ha)&&la(Ha)})}(arguments),z&&!u&&R());return this},remove:function(){B.each(arguments,function(ea,ja){for(var la;-1<(la=B.inArray(ja,J,la));)J.splice(la,1),la<=Q&&Q--});return this},has:function(ea){return ea?-1<B.inArray(ea,J):0<J.length},empty:function(){J&&(J=[]);return this},disable:function(){G=M=[];J=z="";return this},disabled:function(){return!J},lock:function(){G=M=[];z||(J=z="");return this},locked:function(){return!!G},fireWith:function(ea,
ja){G||(ja=ja||[],ja=[ea,ja.slice?ja.slice():ja],M.push(ja),u||R());return this},fire:function(){T.fireWith(this,arguments);return this},fired:function(){return!!D}};return T};B.extend({Deferred:function(h){var u=[["resolve","done",B.Callbacks("once memory"),"resolved"],["reject","fail",B.Callbacks("once memory"),"rejected"],["notify","progress",B.Callbacks("memory")]],z="pending",D={state:function(){return z},always:function(){G.done(arguments).fail(arguments);return this},then:function(){var J=
arguments;return B.Deferred(function(M){B.each(u,function(Q,R){var T=B.isFunction(J[Q])&&J[Q];G[R[1]](function(){var ea=T&&T.apply(this,arguments);if(ea&&B.isFunction(ea.promise))ea.promise().progress(M.notify).done(M.resolve).fail(M.reject);else M[R[0]+"With"](this===D?M.promise():this,T?[ea]:arguments)})});J=null}).promise()},promise:function(J){return null!=J?B.extend(J,D):D}},G={};D.pipe=D.then;B.each(u,function(J,M){var Q=M[2],R=M[3];D[M[1]]=Q.add;R&&Q.add(function(){z=R},u[J^1][2].disable,u[2][2].lock);
G[M[0]]=function(){G[M[0]+"With"](this===G?D:this,arguments);return this};G[M[0]+"With"]=Q.fireWith});D.promise(G);h&&h.call(G,G);return G},when:function(h){var u=0,z=eb.call(arguments),D=z.length,G=1!==D||h&&B.isFunction(h.promise)?D:0,J=1===G?h:B.Deferred(),M=function(ea,ja,la){return function(Sa){ja[ea]=this;la[ea]=1<arguments.length?eb.call(arguments):Sa;la===R?J.notifyWith(ja,la):--G||J.resolveWith(ja,la)}},Q;if(1<D){var R=Array(D);var T=Array(D);for(Q=Array(D);u<D;u++)z[u]&&B.isFunction(z[u].promise)?
z[u].promise().progress(M(u,T,R)).done(M(u,Q,z)).fail(J.reject):--G}G||J.resolveWith(Q,z);return J.promise()}});var wb;B.fn.ready=function(h){B.ready.promise().done(h);return this};B.extend({isReady:!1,readyWait:1,holdReady:function(h){h?B.readyWait++:B.ready(!0)},ready:function(h){(!0===h?--B.readyWait:B.isReady)||(B.isReady=!0,!0!==h&&0<--B.readyWait||(wb.resolveWith(ma,[B]),B.fn.triggerHandler&&(B(ma).triggerHandler("ready"),B(ma).off("ready"))))}});B.ready.promise=function(h){wb||(wb=B.Deferred(),
"complete"===ma.readyState||"loading"!==ma.readyState&&!ma.documentElement.doScroll?v.setTimeout(B.ready):(ma.addEventListener("DOMContentLoaded",b),v.addEventListener("load",b)));return wb.promise(h)};B.ready.promise();var qb=function(h,u,z,D,G,J,M){var Q=0,R=h.length,T=null==z;if("object"===B.type(z))for(Q in G=!0,z)qb(h,u,Q,z[Q],!0,J,M);else if(D!==w&&(G=!0,B.isFunction(D)||(M=!0),T&&(M?(u.call(h,D),u=null):(T=u,u=function(ea,ja,la){return T.call(B(ea),la)})),u))for(;Q<R;Q++)u(h[Q],z,M?D:D.call(h[Q],
Q,u(h[Q],z)));return G?h:T?u.call(h):R?u(h[0],z):J},Qb=function(h){return 1===h.nodeType||9===h.nodeType||!+h.nodeType};g.uid=1;g.prototype={register:function(h,u){u=u||{};h.nodeType?h[this.expando]=u:Object.defineProperty(h,this.expando,{value:u,writable:!0,configurable:!0});return h[this.expando]},cache:function(h){if(!Qb(h))return{};var u=h[this.expando];u||(u={},Qb(h)&&(h.nodeType?h[this.expando]=u:Object.defineProperty(h,this.expando,{value:u,configurable:!0})));return u},set:function(h,u,z){var D;
h=this.cache(h);if("string"===typeof u)h[u]=z;else for(D in u)h[D]=u[D];return h},get:function(h,u){return u===w?this.cache(h):h[this.expando]&&h[this.expando][u]},access:function(h,u,z){if(u===w||u&&"string"===typeof u&&z===w)return z=this.get(h,u),z!==w?z:this.get(h,B.camelCase(u));this.set(h,u,z);return z!==w?z:u},remove:function(h,u){var z=h[this.expando];if(z!==w){if(u===w)this.register(h);else{if(B.isArray(u))var D=u.concat(u.map(B.camelCase));else{var G=B.camelCase(u);u in z?D=[u,G]:(D=G,D=
D in z?[D]:D.match(Ga)||[])}for(G=D.length;G--;)delete z[D[G]]}if(u===w||B.isEmptyObject(z))h.nodeType?h[this.expando]=w:delete h[this.expando]}},hasData:function(h){h=h[this.expando];return h!==w&&!B.isEmptyObject(h)}};var sa=new g,Ma=new g,Fc=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,bc=/[A-Z]/g;B.extend({hasData:function(h){return Ma.hasData(h)||sa.hasData(h)},data:function(h,u,z){return Ma.access(h,u,z)},removeData:function(h,u){Ma.remove(h,u)},_data:function(h,u,z){return sa.access(h,u,z)},_removeData:function(h,
u){sa.remove(h,u)}});B.fn.extend({data:function(h,u){var z,D=this[0],G=D&&D.attributes;if(h===w){if(this.length){var J=Ma.get(D);if(1===D.nodeType&&!sa.get(D,"hasDataAttrs")){for(z=G.length;z--;)if(G[z]){var M=G[z].name;0===M.indexOf("data-")&&(M=B.camelCase(M.slice(5)),m(D,M,J[M]))}sa.set(D,"hasDataAttrs",!0)}}return J}return"object"===typeof h?this.each(function(){Ma.set(this,h)}):qb(this,function(Q){if(D&&Q===w){var R=Ma.get(D,h)||Ma.get(D,h.replace(bc,"-$&").toLowerCase());if(R!==w)return R;var T=
B.camelCase(h);R=Ma.get(D,T);if(R!==w)return R;R=m(D,T,w);if(R!==w)return R}else T=B.camelCase(h),this.each(function(){var ea=Ma.get(this,T);Ma.set(this,T,Q);-1<h.indexOf("-")&&ea!==w&&Ma.set(this,h,Q)})},null,u,1<arguments.length,null,!0)},removeData:function(h){return this.each(function(){Ma.remove(this,h)})}});B.extend({queue:function(h,u,z){if(h){u=(u||"fx")+"queue";var D=sa.get(h,u);z&&(!D||B.isArray(z)?D=sa.access(h,u,B.makeArray(z)):D.push(z));return D||[]}},dequeue:function(h,u){u=u||"fx";
var z=B.queue(h,u),D=z.length,G=z.shift(),J=B._queueHooks(h,u),M=function(){B.dequeue(h,u)};"inprogress"===G&&(G=z.shift(),D--);G&&("fx"===u&&z.unshift("inprogress"),delete J.stop,G.call(h,M,J));!D&&J&&J.empty.fire()},_queueHooks:function(h,u){var z=u+"queueHooks";return sa.get(h,z)||sa.access(h,z,{empty:B.Callbacks("once memory").add(function(){sa.remove(h,[u+"queue",z])})})}});B.fn.extend({queue:function(h,u){var z=2;"string"!==typeof h&&(u=h,h="fx",z--);return arguments.length<z?B.queue(this[0],
h):u===w?this:this.each(function(){var D=B.queue(this,h,u);B._queueHooks(this,h);"fx"===h&&"inprogress"!==D[0]&&B.dequeue(this,h)})},dequeue:function(h){return this.each(function(){B.dequeue(this,h)})},clearQueue:function(h){return this.queue(h||"fx",[])},promise:function(h,u){var z,D=1,G=B.Deferred(),J=this,M=this.length,Q=function(){--D||G.resolveWith(J,[J])};"string"!==typeof h&&(u=h,h=w);for(h=h||"fx";M--;)(z=sa.get(J[M],h+"queueHooks"))&&z.empty&&(D++,z.empty.add(Q));Q();return G.promise(u)}});
var ec=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,yb=new RegExp("^(?:([+-])=|)("+ec+")([a-z%]*)$","i"),lb=["Top","Right","Bottom","Left"],Ta=function(h,u){h=u||h;return"none"===B.css(h,"display")||!B.contains(h.ownerDocument,h)},Ya=/^(?:checkbox|radio)$/i,Za=/<([\w:-]+)/,kc=/^$|\/(?:java|ecma)script/i,xa={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>",
"</tr></tbody></table>"],_default:[0,"",""]};xa.optgroup=xa.option;xa.tbody=xa.tfoot=xa.colgroup=xa.caption=xa.thead;xa.th=xa.td;var jc=/<|&#?\w+;/;(function(){var h=ma.createDocumentFragment().appendChild(ma.createElement("div")),u=ma.createElement("input");u.setAttribute("type","radio");u.setAttribute("checked","checked");u.setAttribute("name","t");h.appendChild(u);Ba.checkClone=h.cloneNode(!0).cloneNode(!0).lastChild.checked;h.innerHTML="<textarea>x</textarea>";Ba.noCloneChecked=!!h.cloneNode(!0).lastChild.defaultValue})();
var qc=/^key/,Ic=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,fc=/^([^.]*)(?:\.(.+)|)/;B.event={global:{},add:function(h,u,z,D,G){var J,M,Q,R,T;if(Q=sa.get(h)){if(z.handler){var ea=z;z=ea.handler;G=ea.selector}z.guid||(z.guid=B.guid++);(M=Q.events)||(M=Q.events={});(J=Q.handle)||(J=Q.handle=function(Ha){return"undefined"!==typeof B&&B.event.triggered!==Ha.type?B.event.dispatch.apply(h,arguments):w});u=(u||"").match(Ga)||[""];for(Q=u.length;Q--;){var ja=fc.exec(u[Q])||[];var la=R=ja[1];var Sa=
(ja[2]||"").split(".").sort();la&&(ja=B.event.special[la]||{},la=(G?ja.delegateType:ja.bindType)||la,ja=B.event.special[la]||{},R=B.extend({type:la,origType:R,data:D,handler:z,guid:z.guid,selector:G,needsContext:G&&B.expr.match.needsContext.test(G),namespace:Sa.join(".")},ea),(T=M[la])||(T=M[la]=[],T.delegateCount=0,ja.setup&&!1!==ja.setup.call(h,D,Sa,J)||h.addEventListener&&h.addEventListener(la,J)),ja.add&&(ja.add.call(h,R),R.handler.guid||(R.handler.guid=z.guid)),G?T.splice(T.delegateCount++,0,
R):T.push(R),B.event.global[la]=!0)}}},remove:function(h,u,z,D,G){var J,M,Q,R,T,ea=sa.hasData(h)&&sa.get(h);if(ea&&(Q=ea.events)){u=(u||"").match(Ga)||[""];for(R=u.length;R--;){var ja=fc.exec(u[R])||[];var la=T=ja[1];var Sa=(ja[2]||"").split(".").sort();if(la){var Ha=B.event.special[la]||{};la=(D?Ha.delegateType:Ha.bindType)||la;var ub=Q[la]||[];ja=ja[2]&&new RegExp("(^|\\.)"+Sa.join("\\.(?:.*\\.|)")+"(\\.|$)");for(M=J=ub.length;J--;){var pb=ub[J];!G&&T!==pb.origType||z&&z.guid!==pb.guid||ja&&!ja.test(pb.namespace)||
D&&D!==pb.selector&&("**"!==D||!pb.selector)||(ub.splice(J,1),pb.selector&&ub.delegateCount--,Ha.remove&&Ha.remove.call(h,pb))}M&&!ub.length&&(Ha.teardown&&!1!==Ha.teardown.call(h,Sa,ea.handle)||B.removeEvent(h,la,ea.handle),delete Q[la])}else for(la in Q)B.event.remove(h,la+u[R],z,D,!0)}B.isEmptyObject(Q)&&sa.remove(h,"handle events")}},dispatch:function(h){h=B.event.fix(h);var u,z,D,G=eb.call(arguments);var J=(sa.get(this,"events")||{})[h.type]||[];var M=B.event.special[h.type]||{};G[0]=h;h.delegateTarget=
this;if(!M.preDispatch||!1!==M.preDispatch.call(this,h)){var Q=B.event.handlers.call(this,h,J);for(J=0;(D=Q[J++])&&!h.isPropagationStopped();)for(h.currentTarget=D.elem,u=0;(z=D.handlers[u++])&&!h.isImmediatePropagationStopped();)if(!h.rnamespace||h.rnamespace.test(z.namespace))h.handleObj=z,h.data=z.data,z=((B.event.special[z.origType]||{}).handle||z.handler).apply(D.elem,G),z!==w&&!1===(h.result=z)&&(h.preventDefault(),h.stopPropagation());M.postDispatch&&M.postDispatch.call(this,h);return h.result}},
handlers:function(h,u){var z,D=[],G=u.delegateCount,J=h.target;if(G&&J.nodeType&&("click"!==h.type||isNaN(h.button)||1>h.button))for(;J!==this;J=J.parentNode||this)if(1===J.nodeType&&(!0!==J.disabled||"click"!==h.type)){var M=[];for(z=0;z<G;z++){var Q=u[z];var R=Q.selector+" ";M[R]===w&&(M[R]=Q.needsContext?-1<B(R,this).index(J):B.find(R,this,null,[J]).length);M[R]&&M.push(Q)}M.length&&D.push({elem:J,handlers:M})}G<u.length&&D.push({elem:this,handlers:u.slice(G)});return D},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(h,u){null==h.which&&(h.which=null!=u.charCode?u.charCode:u.keyCode);return h}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(h,u){var z=u.button;if(null==h.pageX&&null!=u.clientX){var D=h.target.ownerDocument||ma;var G=D.documentElement;D=D.body;h.pageX=u.clientX+(G&&G.scrollLeft||D&&D.scrollLeft||0)-(G&&G.clientLeft||D&&D.clientLeft||
0);h.pageY=u.clientY+(G&&G.scrollTop||D&&D.scrollTop||0)-(G&&G.clientTop||D&&D.clientTop||0)}h.which||z===w||(h.which=z&1?1:z&2?3:z&4?2:0);return h}},fix:function(h){if(h[B.expando])return h;var u=h.type;var z=h,D=this.fixHooks[u];D||(this.fixHooks[u]=D=Ic.test(u)?this.mouseHooks:qc.test(u)?this.keyHooks:{});var G=D.props?this.props.concat(D.props):this.props;h=new B.Event(z);for(u=G.length;u--;){var J=G[u];h[J]=z[J]}h.target||(h.target=ma);3===h.target.nodeType&&(h.target=h.target.parentNode);return D.filter?
D.filter(h,z):h},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==H()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===H()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&B.nodeName(this,"input"))return this.click(),!1},_default:function(h){return B.nodeName(h.target,"a")}},beforeunload:{postDispatch:function(h){h.result!==w&&h.originalEvent&&(h.originalEvent.returnValue=
h.result)}}}};B.removeEvent=function(h,u,z){h.removeEventListener&&h.removeEventListener(u,z)};B.Event=function(h,u){if(!(this instanceof B.Event))return new B.Event(h,u);h&&h.type?(this.originalEvent=h,this.type=h.type,this.isDefaultPrevented=h.defaultPrevented||h.defaultPrevented===w&&!1===h.returnValue?x:A):this.type=h;u&&B.extend(this,u);this.timeStamp=h&&h.timeStamp||B.now();this[B.expando]=!0};B.Event.prototype={constructor:B.Event,isDefaultPrevented:A,isPropagationStopped:A,isImmediatePropagationStopped:A,
isSimulated:!1,preventDefault:function(){var h=this.originalEvent;this.isDefaultPrevented=x;h&&!this.isSimulated&&h.preventDefault()},stopPropagation:function(){var h=this.originalEvent;this.isPropagationStopped=x;h&&!this.isSimulated&&h.stopPropagation()},stopImmediatePropagation:function(){var h=this.originalEvent;this.isImmediatePropagationStopped=x;h&&!this.isSimulated&&h.stopImmediatePropagation();this.stopPropagation()}};B.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",
pointerleave:"pointerout"},function(h,u){B.event.special[h]={delegateType:u,bindType:u,handle:function(z){var D=z.relatedTarget,G=z.handleObj;if(!D||D!==this&&!B.contains(this,D)){z.type=G.origType;var J=G.handler.apply(this,arguments);z.type=u}return J}}});B.fn.extend({on:function(h,u,z,D){return a(this,h,u,z,D)},one:function(h,u,z,D){return a(this,h,u,z,D,1)},off:function(h,u,z){if(h&&h.preventDefault&&h.handleObj){var D=h.handleObj;B(h.delegateTarget).off(D.namespace?D.origType+"."+D.namespace:
D.origType,D.selector,D.handler);return this}if("object"===typeof h){for(D in h)this.off(D,u,h[D]);return this}if(!1===u||"function"===typeof u)z=u,u=w;!1===z&&(z=A);return this.each(function(){B.event.remove(this,h,z,u)})}});var Jc=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,Ac=/<script|<style|<link/i,Vb=/checked\s*(?:[^=]|=\s*.checked.)/i,Ub=/^true\/(.*)/,ob=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;B.extend({htmlPrefilter:function(h){return h.replace(Jc,"<$1></$2>")},
clone:function(h,u,z){var D,G=h.cloneNode(!0),J=B.contains(h.ownerDocument,h);if(!(Ba.noCloneChecked||1!==h.nodeType&&11!==h.nodeType||B.isXMLDoc(h))){var M=l(G);var Q=l(h);var R=0;for(D=Q.length;R<D;R++){var T=Q[R],ea=M[R],ja=ea.nodeName.toLowerCase();if("input"===ja&&Ya.test(T.type))ea.checked=T.checked;else if("input"===ja||"textarea"===ja)ea.defaultValue=T.defaultValue}}if(u)if(z)for(Q=Q||l(h),M=M||l(G),R=0,D=Q.length;R<D;R++)F(Q[R],M[R]);else F(h,G);M=l(G,"script");0<M.length&&r(M,!J&&l(h,"script"));
return G},cleanData:function(h){for(var u,z,D,G=B.event.special,J=0;(z=h[J])!==w;J++)if(Qb(z)){if(u=z[sa.expando]){if(u.events)for(D in u.events)G[D]?B.event.remove(z,D):B.removeEvent(z,D,u.handle);z[sa.expando]=w}z[Ma.expando]&&(z[Ma.expando]=w)}}});B.fn.extend({domManip:I,detach:function(h){return L(this,h,!0)},remove:function(h){return L(this,h)},text:function(h){return qb(this,function(u){return u===w?B.text(this):this.empty().each(function(){if(1===this.nodeType||11===this.nodeType||9===this.nodeType)this.textContent=
u})},null,h,arguments.length)},append:function(){return I(this,arguments,function(h){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||f(this,h).appendChild(h)})},prepend:function(){return I(this,arguments,function(h){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var u=f(this,h);u.insertBefore(h,u.firstChild)}})},before:function(){return I(this,arguments,function(h){this.parentNode&&this.parentNode.insertBefore(h,this)})},after:function(){return I(this,arguments,function(h){this.parentNode&&
this.parentNode.insertBefore(h,this.nextSibling)})},empty:function(){for(var h,u=0;null!=(h=this[u]);u++)1===h.nodeType&&(B.cleanData(l(h,!1)),h.textContent="");return this},clone:function(h,u){h=null==h?!1:h;u=null==u?h:u;return this.map(function(){return B.clone(this,h,u)})},html:function(h){return qb(this,function(u){var z=this[0]||{},D=0,G=this.length;if(u===w&&1===z.nodeType)return z.innerHTML;if("string"===typeof u&&!Ac.test(u)&&!xa[(Za.exec(u)||["",""])[1].toLowerCase()]){u=B.htmlPrefilter(u);
try{for(;D<G;D++)z=this[D]||{},1===z.nodeType&&(B.cleanData(l(z,!1)),z.innerHTML=u);z=0}catch(J){}}z&&this.empty().append(u)},null,h,arguments.length)},replaceWith:function(){var h=[];return I(this,arguments,function(u){var z=this.parentNode;0>B.inArray(this,h)&&(B.cleanData(l(this)),z&&z.replaceChild(u,this))},h)}});B.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(h,u){B.fn[h]=function(z){for(var D=[],G=B(z),J=G.length-1,M=
0;M<=J;M++)z=M===J?this:this.clone(!0),B(G[M])[u](z),fb.apply(D,z.get());return this.pushStack(D)}});var zb,lc={HTML:"block",BODY:"block"},sb=/^margin/,Kb=new RegExp("^("+ec+")(?!px)[a-z%]+$","i"),Ab=function(h){var u=h.ownerDocument.defaultView;u&&u.opener||(u=v);return u.getComputedStyle(h)},rc=function(h,u,z,D){var G,J={};for(G in u)J[G]=h.style[G],h.style[G]=u[G];z=z.apply(h,D||[]);for(G in u)h.style[G]=J[G];return z},rb=ma.documentElement;(function(){function h(){M.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%";
M.innerHTML="";rb.appendChild(J);var Q=v.getComputedStyle(M);u="1%"!==Q.top;G="2px"===Q.marginLeft;z="4px"===Q.width;M.style.marginRight="50%";D="4px"===Q.marginRight;rb.removeChild(J)}var u,z,D,G,J=ma.createElement("div"),M=ma.createElement("div");M.style&&(M.style.backgroundClip="content-box",M.cloneNode(!0).style.backgroundClip="",Ba.clearCloneStyle="content-box"===M.style.backgroundClip,J.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",
J.appendChild(M),B.extend(Ba,{pixelPosition:function(){h();return u},boxSizingReliable:function(){null==z&&h();return z},pixelMarginRight:function(){null==z&&h();return D},reliableMarginLeft:function(){null==z&&h();return G},reliableMarginRight:function(){var Q=M.appendChild(ma.createElement("div"));Q.style.cssText=M.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0";Q.style.marginRight=Q.style.width="0";M.style.width="1px";rb.appendChild(J);
var R=!parseFloat(v.getComputedStyle(Q).marginRight);rb.removeChild(J);M.removeChild(Q);return R}}))})();var sc=/^(none|table(?!-c[ea]).+)/,Bc={position:"absolute",visibility:"hidden",display:"block"},tc={letterSpacing:"0",fontWeight:"400"},Lb=["Webkit","O","Moz","ms"],uc=ma.createElement("div").style;B.extend({cssHooks:{opacity:{get:function(h,u){if(u)return h=W(h,"opacity"),""===h?"1":h}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,
lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(h,u,z,D){if(h&&3!==h.nodeType&&8!==h.nodeType&&h.style){var G,J=B.camelCase(u),M=h.style;u=B.cssProps[J]||(B.cssProps[J]=Y(J)||J);var Q=B.cssHooks[u]||B.cssHooks[J];if(z!==w){var R=typeof z;"string"===R&&(G=yb.exec(z))&&G[1]&&(z=p(h,u,G),R="number");null!=z&&z===z&&("number"===R&&(z+=G&&G[3]||(B.cssNumber[J]?"":"px")),Ba.clearCloneStyle||""!==z||0!==u.indexOf("background")||(M[u]=
"inherit"),Q&&"set"in Q&&(z=Q.set(h,z,D))===w||(M[u]=z))}else return Q&&"get"in Q&&(G=Q.get(h,!1,D))!==w?G:M[u]}},css:function(h,u,z,D){var G;var J=B.camelCase(u);u=B.cssProps[J]||(B.cssProps[J]=Y(J)||J);(J=B.cssHooks[u]||B.cssHooks[J])&&"get"in J&&(G=J.get(h,!0,z));G===w&&(G=W(h,u,D));"normal"===G&&u in tc&&(G=tc[u]);return""===z||z?(h=parseFloat(G),!0===z||isFinite(h)?h||0:G):G}});B.each(["height","width"],function(h,u){B.cssHooks[u]={get:function(z,D,G){if(D)return sc.test(B.css(z,"display"))&&
0===z.offsetWidth?rc(z,Bc,function(){return ca(z,u,G)}):ca(z,u,G)},set:function(z,D,G){var J,M=G&&Ab(z);(G=G&&X(z,u,G,"border-box"===B.css(z,"boxSizing",!1,M),M))&&(J=yb.exec(D))&&"px"!==(J[3]||"px")&&(z.style[u]=D,D=B.css(z,u));return ba(z,D,G)}}});B.cssHooks.marginLeft=V(Ba.reliableMarginLeft,function(h,u){if(u)return(parseFloat(W(h,"marginLeft"))||h.getBoundingClientRect().left-rc(h,{marginLeft:0},function(){return h.getBoundingClientRect().left}))+"px"});B.cssHooks.marginRight=V(Ba.reliableMarginRight,
function(h,u){if(u)return rc(h,{display:"inline-block"},W,[h,"marginRight"])});B.each({margin:"",padding:"",border:"Width"},function(h,u){B.cssHooks[h+u]={expand:function(z){var D=0,G={};for(z="string"===typeof z?z.split(" "):[z];4>D;D++)G[h+lb[D]+u]=z[D]||z[D-2]||z[0];return G}};sb.test(h)||(B.cssHooks[h+u].set=ba)});B.fn.extend({css:function(h,u){return qb(this,function(z,D,G){var J,M={},Q=0;if(B.isArray(D)){G=Ab(z);for(J=D.length;Q<J;Q++)M[D[Q]]=B.css(z,D[Q],!1,G);return M}return G!==w?B.style(z,
D,G):B.css(z,D)},h,u,1<arguments.length)},show:function(){return ia(this,!0)},hide:function(){return ia(this)},toggle:function(h){return"boolean"===typeof h?h?this.show():this.hide():this.each(function(){Ta(this)?B(this).show():B(this).hide()})}});B.Tween=Z;Z.prototype={constructor:Z,init:function(h,u,z,D,G,J){this.elem=h;this.prop=z;this.easing=G||B.easing._default;this.options=u;this.start=this.now=this.cur();this.end=D;this.unit=J||(B.cssNumber[z]?"":"px")},cur:function(){var h=Z.propHooks[this.prop];
return h&&h.get?h.get(this):Z.propHooks._default.get(this)},run:function(h){var u,z=Z.propHooks[this.prop];this.pos=this.options.duration?u=B.easing[this.easing](h,this.options.duration*h,0,1,this.options.duration):u=h;this.now=(this.end-this.start)*u+this.start;this.options.step&&this.options.step.call(this.elem,this.now,this);z&&z.set?z.set(this):Z.propHooks._default.set(this);return this}};Z.prototype.init.prototype=Z.prototype;Z.propHooks={_default:{get:function(h){return 1!==h.elem.nodeType||
null!=h.elem[h.prop]&&null==h.elem.style[h.prop]?h.elem[h.prop]:(h=B.css(h.elem,h.prop,""))&&"auto"!==h?h:0},set:function(h){if(B.fx.step[h.prop])B.fx.step[h.prop](h);else 1!==h.elem.nodeType||null==h.elem.style[B.cssProps[h.prop]]&&!B.cssHooks[h.prop]?h.elem[h.prop]=h.now:B.style(h.elem,h.prop,h.now+h.unit)}}};Z.propHooks.scrollTop=Z.propHooks.scrollLeft={set:function(h){h.elem.nodeType&&h.elem.parentNode&&(h.elem[h.prop]=h.now)}};B.easing={linear:function(h){return h},swing:function(h){return.5-
Math.cos(h*Math.PI)/2},_default:"swing"};B.fx=Z.prototype.init;B.fx.step={};var Bb,Rb,Kc=/^(?:toggle|show|hide)$/,Cc=/queueHooks$/;B.Animation=B.extend(ta,{tweeners:{"*":[function(h,u){var z=this.createTween(h,u);p(z.elem,h,yb.exec(u),z);return z}]},tweener:function(h,u){B.isFunction(h)?(u=h,h=["*"]):h=h.match(Ga);for(var z,D=0,G=h.length;D<G;D++)z=h[D],ta.tweeners[z]=ta.tweeners[z]||[],ta.tweeners[z].unshift(u)},prefilters:[function(h,u,z){var D,G=this,J={},M=h.style,Q=h.nodeType&&Ta(h),R=sa.get(h,
"fxshow");if(!z.queue){var T=B._queueHooks(h,"fx");if(null==T.unqueued){T.unqueued=0;var ea=T.empty.fire;T.empty.fire=function(){T.unqueued||ea()}}T.unqueued++;G.always(function(){G.always(function(){T.unqueued--;B.queue(h,"fx").length||T.empty.fire()})})}if(1===h.nodeType&&("height"in u||"width"in u)){z.overflow=[M.overflow,M.overflowX,M.overflowY];var ja=B.css(h,"display");var la="none"===ja?sa.get(h,"olddisplay")||S(h.nodeName):ja;"inline"===la&&"none"===B.css(h,"float")&&(M.display="inline-block")}z.overflow&&
(M.overflow="hidden",G.always(function(){M.overflow=z.overflow[0];M.overflowX=z.overflow[1];M.overflowY=z.overflow[2]}));for(D in u)if(la=u[D],Kc.exec(la)){delete u[D];var Sa=Sa||"toggle"===la;if(la===(Q?"hide":"show"))if("show"===la&&R&&R[D]!==w)Q=!0;else continue;J[D]=R&&R[D]||B.style(h,D)}else ja=w;if(B.isEmptyObject(J))"inline"===("none"===ja?S(h.nodeName):ja)&&(M.display=ja);else for(D in R?"hidden"in R&&(Q=R.hidden):R=sa.access(h,"fxshow",{}),Sa&&(R.hidden=!Q),Q?B(h).show():G.done(function(){B(h).hide()}),
G.done(function(){var Ha;sa.remove(h,"fxshow");for(Ha in J)B.style(h,Ha,J[Ha])}),J)u=na(Q?R[D]:0,D,G),D in R||(R[D]=u.start,Q&&(u.end=u.start,u.start="width"===D||"height"===D?1:0))}],prefilter:function(h,u){u?ta.prefilters.unshift(h):ta.prefilters.push(h)}});B.speed=function(h,u,z){var D=h&&"object"===typeof h?B.extend({},h):{complete:z||!z&&u||B.isFunction(h)&&h,duration:h,easing:z&&u||u&&!B.isFunction(u)&&u};D.duration=B.fx.off?0:"number"===typeof D.duration?D.duration:D.duration in B.fx.speeds?
B.fx.speeds[D.duration]:B.fx.speeds._default;if(null==D.queue||!0===D.queue)D.queue="fx";D.old=D.complete;D.complete=function(){B.isFunction(D.old)&&D.old.call(this);D.queue&&B.dequeue(this,D.queue)};return D};B.fn.extend({fadeTo:function(h,u,z,D){return this.filter(Ta).css("opacity",0).show().end().animate({opacity:u},h,z,D)},animate:function(h,u,z,D){var G=B.isEmptyObject(h),J=B.speed(u,z,D);u=function(){var M=ta(this,B.extend({},h),J);(G||sa.get(this,"finish"))&&M.stop(!0)};u.finish=u;return G||
!1===J.queue?this.each(u):this.queue(J.queue,u)},stop:function(h,u,z){var D=function(G){var J=G.stop;delete G.stop;J(z)};"string"!==typeof h&&(z=u,u=h,h=w);u&&!1!==h&&this.queue(h||"fx",[]);return this.each(function(){var G=!0,J=null!=h&&h+"queueHooks",M=B.timers,Q=sa.get(this);if(J)Q[J]&&Q[J].stop&&D(Q[J]);else for(J in Q)Q[J]&&Q[J].stop&&Cc.test(J)&&D(Q[J]);for(J=M.length;J--;)M[J].elem!==this||null!=h&&M[J].queue!==h||(M[J].anim.stop(z),G=!1,M.splice(J,1));!G&&z||B.dequeue(this,h)})},finish:function(h){!1!==
h&&(h=h||"fx");return this.each(function(){var u=sa.get(this),z=u[h+"queue"];var D=u[h+"queueHooks"];var G=B.timers,J=z?z.length:0;u.finish=!0;B.queue(this,h,[]);D&&D.stop&&D.stop.call(this,!0);for(D=G.length;D--;)G[D].elem===this&&G[D].queue===h&&(G[D].anim.stop(!0),G.splice(D,1));for(D=0;D<J;D++)z[D]&&z[D].finish&&z[D].finish.call(this);delete u.finish})}});B.each(["toggle","show","hide"],function(h,u){var z=B.fn[u];B.fn[u]=function(D,G,J){return null==D||"boolean"===typeof D?z.apply(this,arguments):
this.animate(ka(u,!0),D,G,J)}});B.each({slideDown:ka("show"),slideUp:ka("hide"),slideToggle:ka("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(h,u){B.fn[h]=function(z,D,G){return this.animate(u,z,D,G)}});B.timers=[];B.fx.tick=function(){var h=0,u=B.timers;for(Bb=B.now();h<u.length;h++){var z=u[h];z()||u[h]!==z||u.splice(h--,1)}u.length||B.fx.stop();Bb=w};B.fx.timer=function(h){B.timers.push(h);h()?B.fx.start():B.timers.pop()};B.fx.interval=13;B.fx.start=
function(){Rb||(Rb=v.setInterval(B.fx.tick,B.fx.interval))};B.fx.stop=function(){v.clearInterval(Rb);Rb=null};B.fx.speeds={slow:600,fast:200,_default:400};B.fn.delay=function(h,u){h=B.fx?B.fx.speeds[h]||h:h;return this.queue(u||"fx",function(z,D){var G=v.setTimeout(z,h);D.stop=function(){v.clearTimeout(G)}})};(function(){var h=ma.createElement("input"),u=ma.createElement("select"),z=u.appendChild(ma.createElement("option"));h.type="checkbox";Ba.checkOn=""!==h.value;Ba.optSelected=z.selected;u.disabled=
!0;Ba.optDisabled=!z.disabled;h=ma.createElement("input");h.value="t";h.type="radio";Ba.radioValue="t"===h.value})();var Sb=B.expr.attrHandle;B.fn.extend({attr:function(h,u){return qb(this,B.attr,h,u,1<arguments.length)},removeAttr:function(h){return this.each(function(){B.removeAttr(this,h)})}});B.extend({attr:function(h,u,z){var D,G=h.nodeType;if(3!==G&&8!==G&&2!==G){if("undefined"===typeof h.getAttribute)return B.prop(h,u,z);if(1!==G||!B.isXMLDoc(h)){u=u.toLowerCase();var J=B.attrHooks[u]||(B.expr.match.bool.test(u)?
Dc:w)}if(z!==w){if(null===z){B.removeAttr(h,u);return}if(J&&"set"in J&&(D=J.set(h,z,u))!==w)return D;h.setAttribute(u,z+"");return z}if(J&&"get"in J&&null!==(D=J.get(h,u)))return D;D=B.find.attr(h,u);return null==D?w:D}},attrHooks:{type:{set:function(h,u){if(!Ba.radioValue&&"radio"===u&&B.nodeName(h,"input")){var z=h.value;h.setAttribute("type",u);z&&(h.value=z);return u}}}},removeAttr:function(h,u){var z=0,D=u&&u.match(Ga);if(D&&1===h.nodeType)for(;u=D[z++];){var G=B.propFix[u]||u;B.expr.match.bool.test(u)&&
(h[G]=!1);h.removeAttribute(u)}}});var Dc={set:function(h,u,z){!1===u?B.removeAttr(h,z):h.setAttribute(z,z);return z}};B.each(B.expr.match.bool.source.match(/\w+/g),function(h,u){var z=Sb[u]||B.find.attr;Sb[u]=function(D,G,J){if(!J){var M=Sb[G];Sb[G]=Q;var Q=null!=z(D,G,J)?G.toLowerCase():null;Sb[G]=M}return Q}});var gc=/^(?:input|select|textarea|button)$/i,Ec=/^(?:a|area)$/i;B.fn.extend({prop:function(h,u){return qb(this,B.prop,h,u,1<arguments.length)},removeProp:function(h){return this.each(function(){delete this[B.propFix[h]||
h]})}});B.extend({prop:function(h,u,z){var D,G=h.nodeType;if(3!==G&&8!==G&&2!==G){if(1!==G||!B.isXMLDoc(h)){u=B.propFix[u]||u;var J=B.propHooks[u]}return z!==w?J&&"set"in J&&(D=J.set(h,z,u))!==w?D:h[u]=z:J&&"get"in J&&null!==(D=J.get(h,u))?D:h[u]}},propHooks:{tabIndex:{get:function(h){var u=B.find.attr(h,"tabindex");return u?parseInt(u,10):gc.test(h.nodeName)||Ec.test(h.nodeName)&&h.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}});Ba.optSelected||(B.propHooks.selected={get:function(h){(h=
h.parentNode)&&h.parentNode&&h.parentNode.selectedIndex;return null},set:function(h){if(h=h.parentNode)h.selectedIndex,h.parentNode&&h.parentNode.selectedIndex}});B.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){B.propFix[this.toLowerCase()]=this});var ac=/[\t\r\n\f]/g;B.fn.extend({addClass:function(h){var u,z,D,G,J,M=0;if(B.isFunction(h))return this.each(function(R){B(this).addClass(h.call(this,R,Ea(this)))});if("string"===
typeof h&&h)for(u=h.match(Ga)||[];z=this[M++];){var Q=Ea(z);if(D=1===z.nodeType&&(" "+Q+" ").replace(ac," ")){for(J=0;G=u[J++];)0>D.indexOf(" "+G+" ")&&(D+=G+" ");D=B.trim(D);Q!==D&&z.setAttribute("class",D)}}return this},removeClass:function(h){var u,z,D,G,J,M=0;if(B.isFunction(h))return this.each(function(R){B(this).removeClass(h.call(this,R,Ea(this)))});if(!arguments.length)return this.attr("class","");if("string"===typeof h&&h)for(u=h.match(Ga)||[];z=this[M++];){var Q=Ea(z);if(D=1===z.nodeType&&
(" "+Q+" ").replace(ac," ")){for(J=0;G=u[J++];)for(;-1<D.indexOf(" "+G+" ");)D=D.replace(" "+G+" "," ");D=B.trim(D);Q!==D&&z.setAttribute("class",D)}}return this},toggleClass:function(h,u){var z=typeof h;return"boolean"===typeof u&&"string"===z?u?this.addClass(h):this.removeClass(h):B.isFunction(h)?this.each(function(D){B(this).toggleClass(h.call(this,D,Ea(this),u),u)}):this.each(function(){var D,G;if("string"===z){var J=0;var M=B(this);for(G=h.match(Ga)||[];D=G[J++];)M.hasClass(D)?M.removeClass(D):
M.addClass(D)}else if(h===w||"boolean"===z)(D=Ea(this))&&sa.set(this,"__className__",D),this.setAttribute&&this.setAttribute("class",D||!1===h?"":sa.get(this,"__className__")||"")})},hasClass:function(h){var u,z=0;for(h=" "+h+" ";u=this[z++];)if(1===u.nodeType&&-1<(" "+Ea(u)+" ").replace(ac," ").indexOf(h))return!0;return!1}});var hc=/\r/g,nb=/[\x20\t\r\n\f]+/g;B.fn.extend({val:function(h){var u,z,D=this[0];if(arguments.length){var G=B.isFunction(h);return this.each(function(J){1===this.nodeType&&
(J=G?h.call(this,J,B(this).val()):h,null==J?J="":"number"===typeof J?J+="":B.isArray(J)&&(J=B.map(J,function(M){return null==M?"":M+""})),u=B.valHooks[this.type]||B.valHooks[this.nodeName.toLowerCase()],u&&"set"in u&&u.set(this,J,"value")!==w||(this.value=J))})}if(D){if((u=B.valHooks[D.type]||B.valHooks[D.nodeName.toLowerCase()])&&"get"in u&&(z=u.get(D,"value"))!==w)return z;z=D.value;return"string"===typeof z?z.replace(hc,""):null==z?"":z}}});B.extend({valHooks:{option:{get:function(h){var u=B.find.attr(h,
"value");return null!=u?u:B.trim(B.text(h)).replace(nb," ")}},select:{get:function(h){for(var u,z=h.options,D=h.selectedIndex,G=(h="select-one"===h.type||0>D)?null:[],J=h?D+1:z.length,M=0>D?J:h?D:0;M<J;M++)if(u=z[M],!(!u.selected&&M!==D||(Ba.optDisabled?u.disabled:null!==u.getAttribute("disabled"))||u.parentNode.disabled&&B.nodeName(u.parentNode,"optgroup"))){u=B(u).val();if(h)return u;G.push(u)}return G},set:function(h,u){for(var z,D=h.options,G=B.makeArray(u),J=D.length;J--;)if(u=D[J],u.selected=
-1<B.inArray(B.valHooks.option.get(u),G))z=!0;z||(h.selectedIndex=-1);return G}}}});B.each(["radio","checkbox"],function(){B.valHooks[this]={set:function(h,u){if(B.isArray(u))return h.checked=-1<B.inArray(B(h).val(),u)}};Ba.checkOn||(B.valHooks[this].get=function(h){return null===h.getAttribute("value")?"on":h.value})});var Ja=/^(?:focusinfocus|focusoutblur)$/;B.extend(B.event,{trigger:function(h,u,z,D){var G,J,M=[z||ma],Q=Cb.call(h,"type")?h.type:h;var R=Cb.call(h,"namespace")?h.namespace.split("."):
[];var T=G=z=z||ma;if(3!==z.nodeType&&8!==z.nodeType&&!Ja.test(Q+B.event.triggered)){-1<Q.indexOf(".")&&(R=Q.split("."),Q=R.shift(),R.sort());var ea=0>Q.indexOf(":")&&"on"+Q;h=h[B.expando]?h:new B.Event(Q,"object"===typeof h&&h);h.isTrigger=D?2:3;h.namespace=R.join(".");h.rnamespace=h.namespace?new RegExp("(^|\\.)"+R.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;h.result=w;h.target||(h.target=z);u=null==u?[h]:B.makeArray(u,[h]);R=B.event.special[Q]||{};if(D||!R.trigger||!1!==R.trigger.apply(z,u)){if(!D&&
!R.noBubble&&!B.isWindow(z)){var ja=R.delegateType||Q;Ja.test(ja+Q)||(T=T.parentNode);for(;T;T=T.parentNode)M.push(T),G=T;G===(z.ownerDocument||ma)&&M.push(G.defaultView||G.parentWindow||v)}for(G=0;(T=M[G++])&&!h.isPropagationStopped();)h.type=1<G?ja:R.bindType||Q,(J=(sa.get(T,"events")||{})[h.type]&&sa.get(T,"handle"))&&J.apply(T,u),(J=ea&&T[ea])&&J.apply&&Qb(T)&&(h.result=J.apply(T,u),!1===h.result&&h.preventDefault());h.type=Q;D||h.isDefaultPrevented()||R._default&&!1!==R._default.apply(M.pop(),
u)||!Qb(z)||!ea||!B.isFunction(z[Q])||B.isWindow(z)||((G=z[ea])&&(z[ea]=null),B.event.triggered=Q,z[Q](),B.event.triggered=w,G&&(z[ea]=G));return h.result}}},simulate:function(h,u,z){h=B.extend(new B.Event,z,{type:h,isSimulated:!0});B.event.trigger(h,null,u)}});B.fn.extend({trigger:function(h,u){return this.each(function(){B.event.trigger(h,u,this)})},triggerHandler:function(h,u){var z=this[0];if(z)return B.event.trigger(h,u,z,!0)}});B.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),
function(h,u){B.fn[u]=function(z,D){return 0<arguments.length?this.on(u,null,z,D):this.trigger(u)}});B.fn.extend({hover:function(h,u){return this.mouseenter(h).mouseleave(u||h)}});Ba.focusin="onfocusin"in v;Ba.focusin||B.each({focus:"focusin",blur:"focusout"},function(h,u){var z=function(D){B.event.simulate(u,D.target,B.event.fix(D))};B.event.special[u]={setup:function(){var D=this.ownerDocument||this,G=sa.access(D,u);G||D.addEventListener(h,z,!0);sa.access(D,u,(G||0)+1)},teardown:function(){var D=
this.ownerDocument||this,G=sa.access(D,u)-1;G?sa.access(D,u,G):(D.removeEventListener(h,z,!0),sa.remove(D,u))}}});var xb=v.location,ic=B.now(),Lc=/\?/;B.parseJSON=function(h){return JSON.parse(h+"")};B.parseXML=function(h){if(!h||"string"!==typeof h)return null;try{var u=(new v.DOMParser).parseFromString(h,"text/xml")}catch(z){u=w}u&&!u.getElementsByTagName("parsererror").length||B.error("Invalid XML: "+h);return u};var Xc=/#.*$/,Sc=/([?&])_=[^&]*/,Yc=/^(.*?):[ \t]*([^\r\n]*)$/mg,Zc=/^(?:GET|HEAD)$/,
$c=/^\/\//,Tc={},Gc={},gd="*/".concat("*"),ad=ma.createElement("a");ad.href=xb.href;B.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:xb.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(xb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":gd,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,
json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":B.parseJSON,"text xml":B.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(h,u){return u?Va(Va(h,B.ajaxSettings),u):Va(B.ajaxSettings,h)},ajaxPrefilter:Ua(Tc),ajaxTransport:Ua(Gc),ajax:function(h,u){function z(za,Pa,va,Xa){var La=Pa;if(2!==jb){jb=2;M&&v.clearTimeout(M);D=w;G=Xa||"";ya.readyState=0<za?4:0;Xa=200<=za&&300>za||304===za;if(va){var Da=
T;for(var cb=ya,db,ib,Ca,Ia,ab=Da.contents,Db=Da.dataTypes;"*"===Db[0];)Db.shift(),db===w&&(db=Da.mimeType||cb.getResponseHeader("Content-Type"));if(db)for(ib in ab)if(ab[ib]&&ab[ib].test(db)){Db.unshift(ib);break}if(Db[0]in va)Ca=Db[0];else{for(ib in va){if(!Db[0]||Da.converters[ib+" "+Db[0]]){Ca=ib;break}Ia||(Ia=ib)}Ca=Ca||Ia}Ca?(Ca!==Db[0]&&Db.unshift(Ca),Da=va[Ca]):Da=void 0}a:{va=T;db=Da;ib=ya;Ca=Xa;var oc;cb={};ab=va.dataTypes.slice();if(ab[1])for(gb in va.converters)cb[gb.toLowerCase()]=va.converters[gb];
for(Ia=ab.shift();Ia;){va.responseFields[Ia]&&(ib[va.responseFields[Ia]]=db);!Pb&&Ca&&va.dataFilter&&(db=va.dataFilter(db,va.dataType));var Pb=Ia;if(Ia=ab.shift())if("*"===Ia)Ia=Pb;else if("*"!==Pb&&Pb!==Ia){var gb=cb[Pb+" "+Ia]||cb["* "+Ia];if(!gb)for(oc in cb)if(Da=oc.split(" "),Da[1]===Ia&&(gb=cb[Pb+" "+Da[0]]||cb["* "+Da[0]])){!0===gb?gb=cb[oc]:!0!==cb[oc]&&(Ia=Da[0],ab.unshift(Da[1]));break}if(!0!==gb)if(gb&&va.throws)db=gb(db);else try{db=gb(db)}catch(Wb){Da={state:"parsererror",error:gb?Wb:
"No conversion from "+Pb+" to "+Ia};break a}}}Da={state:"success",data:db}}if(Xa)if(T.ifModified&&((La=ya.getResponseHeader("Last-Modified"))&&(B.lastModified[hb]=La),(La=ya.getResponseHeader("etag"))&&(B.etag[hb]=La)),204===za||"HEAD"===T.type)La="nocontent";else if(304===za)La="notmodified";else{La=Da.state;var xc=Da.data;var yc=Da.error;Xa=!yc}else if(yc=La,za||!La)La="error",0>za&&(za=0);ya.status=za;ya.statusText=(Pa||La)+"";Xa?la.resolveWith(ea,[xc,La,ya]):la.rejectWith(ea,[ya,La,yc]);ya.statusCode(Ha);
Ha=w;Q&&ja.trigger(Xa?"ajaxSuccess":"ajaxError",[ya,T,Xa?xc:yc]);Sa.fireWith(ea,[ya,La]);Q&&(ja.trigger("ajaxComplete",[ya,T]),--B.active||B.event.trigger("ajaxStop"))}}"object"===typeof h&&(u=h,h=w);u=u||{};var D,G,J,M,Q,R,T=B.ajaxSetup({},u),ea=T.context||T,ja=T.context&&(ea.nodeType||ea.jquery)?B(ea):B.event,la=B.Deferred(),Sa=B.Callbacks("once memory"),Ha=T.statusCode||{},ub={},pb={},jb=0,Qc="canceled",ya={readyState:0,getResponseHeader:function(za){var Pa;if(2===jb){if(!J)for(J={};Pa=Yc.exec(G);)J[Pa[1].toLowerCase()]=
Pa[2];Pa=J[za.toLowerCase()]}return null==Pa?null:Pa},getAllResponseHeaders:function(){return 2===jb?G:null},setRequestHeader:function(za,Pa){var va=za.toLowerCase();jb||(za=pb[va]=pb[va]||za,ub[za]=Pa);return this},overrideMimeType:function(za){jb||(T.mimeType=za);return this},statusCode:function(za){var Pa;if(za)if(2>jb)for(Pa in za)Ha[Pa]=[Ha[Pa],za[Pa]];else ya.always(za[ya.status]);return this},abort:function(za){za=za||Qc;D&&D.abort(za);z(0,za);return this}};la.promise(ya).complete=Sa.add;ya.success=
ya.done;ya.error=ya.fail;T.url=((h||T.url||xb.href)+"").replace(Xc,"").replace($c,xb.protocol+"//");T.type=u.method||u.type||T.method||T.type;T.dataTypes=B.trim(T.dataType||"*").toLowerCase().match(Ga)||[""];if(null==T.crossDomain){h=ma.createElement("a");try{h.href=T.url,h.href=h.href,T.crossDomain=ad.protocol+"//"+ad.host!==h.protocol+"//"+h.host}catch(za){T.crossDomain=!0}}T.data&&T.processData&&"string"!==typeof T.data&&(T.data=B.param(T.data,T.traditional));Qa(Tc,T,u,ya);if(2===jb)return ya;
(Q=B.event&&T.global)&&0===B.active++&&B.event.trigger("ajaxStart");T.type=T.type.toUpperCase();T.hasContent=!Zc.test(T.type);var hb=T.url;T.hasContent||(T.data&&(hb=T.url+=(Lc.test(hb)?"&":"?")+T.data,delete T.data),!1===T.cache&&(T.url=Sc.test(hb)?hb.replace(Sc,"$1_="+ic++):hb+(Lc.test(hb)?"&":"?")+"_="+ic++));T.ifModified&&(B.lastModified[hb]&&ya.setRequestHeader("If-Modified-Since",B.lastModified[hb]),B.etag[hb]&&ya.setRequestHeader("If-None-Match",B.etag[hb]));(T.data&&T.hasContent&&!1!==T.contentType||
u.contentType)&&ya.setRequestHeader("Content-Type",T.contentType);ya.setRequestHeader("Accept",T.dataTypes[0]&&T.accepts[T.dataTypes[0]]?T.accepts[T.dataTypes[0]]+("*"!==T.dataTypes[0]?", "+gd+"; q=0.01":""):T.accepts["*"]);for(R in T.headers)ya.setRequestHeader(R,T.headers[R]);if(T.beforeSend&&(!1===T.beforeSend.call(ea,ya,T)||2===jb))return ya.abort();Qc="abort";for(R in{success:1,error:1,complete:1})ya[R](T[R]);if(D=Qa(Gc,T,u,ya)){ya.readyState=1;Q&&ja.trigger("ajaxSend",[ya,T]);if(2===jb)return ya;
T.async&&0<T.timeout&&(M=v.setTimeout(function(){ya.abort("timeout")},T.timeout));try{jb=1,D.send(ub,z)}catch(za){if(2>jb)z(-1,za);else throw za;}}else z(-1,"No Transport");return ya},getJSON:function(h,u,z){return B.get(h,u,z,"json")},getScript:function(h,u){return B.get(h,w,u,"script")}});B.each(["get","post"],function(h,u){B[u]=function(z,D,G,J){B.isFunction(D)&&(J=J||G,G=D,D=w);return B.ajax(B.extend({url:z,type:u,dataType:J,data:D,success:G},B.isPlainObject(z)&&z))}});B._evalUrl=function(h){return B.ajax({url:h,
type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})};B.fn.extend({wrapAll:function(h){if(B.isFunction(h))return this.each(function(z){B(this).wrapAll(h.call(this,z))});if(this[0]){var u=B(h,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&u.insertBefore(this[0]);u.map(function(){for(var z=this;z.firstElementChild;)z=z.firstElementChild;return z}).append(this)}return this},wrapInner:function(h){return B.isFunction(h)?this.each(function(u){B(this).wrapInner(h.call(this,u))}):this.each(function(){var u=
B(this),z=u.contents();z.length?z.wrapAll(h):u.append(h)})},wrap:function(h){var u=B.isFunction(h);return this.each(function(z){B(this).wrapAll(u?h.call(this,z):h)})},unwrap:function(){return this.parent().each(function(){B.nodeName(this,"body")||B(this).replaceWith(this.childNodes)}).end()}});B.expr.filters.hidden=function(h){return!B.expr.filters.visible(h)};B.expr.filters.visible=function(h){return 0<h.offsetWidth||0<h.offsetHeight||0<h.getClientRects().length};var yd=/%20/g,kd=/\[\]$/,hd=/\r?\n/g,
zd=/^(?:submit|button|image|reset|file)$/i,Ad=/^(?:input|select|textarea|keygen)/i;B.param=function(h,u){var z,D=[],G=function(J,M){M=B.isFunction(M)?M():null==M?"":M;D[D.length]=encodeURIComponent(J)+"="+encodeURIComponent(M)};u===w&&(u=B.ajaxSettings&&B.ajaxSettings.traditional);if(B.isArray(h)||h.jquery&&!B.isPlainObject(h))B.each(h,function(){G(this.name,this.value)});else for(z in h)Ka(z,h[z],u,G);return D.join("&").replace(yd,"+")};B.fn.extend({serialize:function(){return B.param(this.serializeArray())},
serializeArray:function(){return this.map(function(){var h=B.prop(this,"elements");return h?B.makeArray(h):this}).filter(function(){var h=this.type;return this.name&&!B(this).is(":disabled")&&Ad.test(this.nodeName)&&!zd.test(h)&&(this.checked||!Ya.test(h))}).map(function(h,u){h=B(this).val();return null==h?null:B.isArray(h)?B.map(h,function(z){return{name:u.name,value:z.replace(hd,"\r\n")}}):{name:u.name,value:h.replace(hd,"\r\n")}}).get()}});B.ajaxSettings.xhr=function(){try{return new v.XMLHttpRequest}catch(h){}};
var Bd={0:200,1223:204},Mc=B.ajaxSettings.xhr();Ba.cors=!!Mc&&"withCredentials"in Mc;Ba.ajax=Mc=!!Mc;B.ajaxTransport(function(h){var u,z;if(Ba.cors||Mc&&!h.crossDomain)return{send:function(D,G){var J,M=h.xhr();M.open(h.type,h.url,h.async,h.username,h.password);if(h.xhrFields)for(J in h.xhrFields)M[J]=h.xhrFields[J];h.mimeType&&M.overrideMimeType&&M.overrideMimeType(h.mimeType);h.crossDomain||D["X-Requested-With"]||(D["X-Requested-With"]="XMLHttpRequest");for(J in D)M.setRequestHeader(J,D[J]);u=function(Q){return function(){u&&
(u=z=M.onload=M.onerror=M.onabort=M.onreadystatechange=null,"abort"===Q?M.abort():"error"===Q?"number"!==typeof M.status?G(0,"error"):G(M.status,M.statusText):G(Bd[M.status]||M.status,M.statusText,"text"!==(M.responseType||"text")||"string"!==typeof M.responseText?{binary:M.response}:{text:M.responseText},M.getAllResponseHeaders()))}};M.onload=u();z=M.onerror=u("error");M.onabort!==w?M.onabort=z:M.onreadystatechange=function(){4===M.readyState&&v.setTimeout(function(){u&&z()})};u=u("abort");try{M.send(h.hasContent&&
h.data||null)}catch(Q){if(u)throw Q;}},abort:function(){u&&u()}}});B.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(h){B.globalEval(h);return h}}});B.ajaxPrefilter("script",function(h){h.cache===w&&(h.cache=!1);h.crossDomain&&(h.type="GET")});B.ajaxTransport("script",function(h){if(h.crossDomain){var u,z;return{send:function(D,G){u=B("<script>").prop({charset:h.scriptCharset,
src:h.url}).on("load error",z=function(J){u.remove();z=null;J&&G("error"===J.type?404:200,J.type)});ma.head.appendChild(u[0])},abort:function(){z&&z()}}}});var id=[],bd=/(=)\?(?=&|$)|\?\?/;B.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var h=id.pop()||B.expando+"_"+ic++;this[h]=!0;return h}});B.ajaxPrefilter("json jsonp",function(h,u,z){var D,G=!1!==h.jsonp&&(bd.test(h.url)?"url":"string"===typeof h.data&&0===(h.contentType||"").indexOf("application/x-www-form-urlencoded")&&bd.test(h.data)&&
"data");if(G||"jsonp"===h.dataTypes[0]){var J=h.jsonpCallback=B.isFunction(h.jsonpCallback)?h.jsonpCallback():h.jsonpCallback;G?h[G]=h[G].replace(bd,"$1"+J):!1!==h.jsonp&&(h.url+=(Lc.test(h.url)?"&":"?")+h.jsonp+"="+J);h.converters["script json"]=function(){D||B.error(J+" was not called");return D[0]};h.dataTypes[0]="json";var M=v[J];v[J]=function(){D=arguments};z.always(function(){M===w?B(v).removeProp(J):v[J]=M;h[J]&&(h.jsonpCallback=u.jsonpCallback,id.push(J));D&&B.isFunction(M)&&M(D[0]);D=M=w});
return"script"}});B.parseHTML=function(h,u,z){if(!h||"string"!==typeof h)return null;"boolean"===typeof u&&(z=u,u=!1);u=u||ma;var D=Zb.exec(h);z=!z&&[];if(D)return[u.createElement(D[1])];D=y([h],u,z);z&&z.length&&B(z).remove();return B.merge([],D.childNodes)};var jd=B.fn.load;B.fn.load=function(h,u,z){if("string"!==typeof h&&jd)return jd.apply(this,arguments);var D,G,J=this,M=h.indexOf(" ");if(-1<M){var Q=B.trim(h.slice(M));h=h.slice(0,M)}B.isFunction(u)?(z=u,u=w):u&&"object"===typeof u&&(D="POST");
0<J.length&&B.ajax({url:h,type:D||"GET",dataType:"html",data:u}).done(function(R){G=arguments;J.html(Q?B("<div>").append(B.parseHTML(R)).find(Q):R)}).always(z&&function(R,T){J.each(function(){z.apply(this,G||[R.responseText,T,R])})});return this};B.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(h,u){B.fn[u]=function(z){return this.on(u,z)}});B.expr.filters.animated=function(h){return B.grep(B.timers,function(u){return h===u.elem}).length};B.offset={setOffset:function(h,
u,z){var D=B.css(h,"position"),G=B(h),J={};"static"===D&&(h.style.position="relative");var M=G.offset();var Q=B.css(h,"top");var R=B.css(h,"left");("absolute"===D||"fixed"===D)&&-1<(Q+R).indexOf("auto")?(R=G.position(),Q=R.top,R=R.left):(Q=parseFloat(Q)||0,R=parseFloat(R)||0);B.isFunction(u)&&(u=u.call(h,z,B.extend({},M)));null!=u.top&&(J.top=u.top-M.top+Q);null!=u.left&&(J.left=u.left-M.left+R);"using"in u?u.using.call(h,J):G.css(J)}};B.fn.extend({offset:function(h){if(arguments.length)return h===
w?this:this.each(function(J){B.offset.setOffset(this,h,J)});var u=this[0];var z={top:0,left:0},D=u&&u.ownerDocument;if(D){var G=D.documentElement;if(!B.contains(G,u))return z;z=u.getBoundingClientRect();u=mb(D);return{top:z.top+u.pageYOffset-G.clientTop,left:z.left+u.pageXOffset-G.clientLeft}}},position:function(){if(this[0]){var h=this[0],u={top:0,left:0};if("fixed"===B.css(h,"position"))var z=h.getBoundingClientRect();else{var D=this.offsetParent();z=this.offset();B.nodeName(D[0],"html")||(u=D.offset());
u.top+=B.css(D[0],"borderTopWidth",!0);u.left+=B.css(D[0],"borderLeftWidth",!0)}return{top:z.top-u.top-B.css(h,"marginTop",!0),left:z.left-u.left-B.css(h,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var h=this.offsetParent;h&&"static"===B.css(h,"position");)h=h.offsetParent;return h||rb})}});B.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(h,u){var z="pageYOffset"===u;B.fn[h]=function(D){return qb(this,function(G,J,M){var Q=mb(G);if(M===w)return Q?Q[u]:
G[J];Q?Q.scrollTo(z?Q.pageXOffset:M,z?M:Q.pageYOffset):G[J]=M},h,D,arguments.length)}});B.each(["top","left"],function(h,u){B.cssHooks[u]=V(Ba.pixelPosition,function(z,D){if(D)return D=W(z,u),Kb.test(D)?B(z).position()[u]+"px":D})});B.each({Height:"height",Width:"width"},function(h,u){B.each({padding:"inner"+h,content:u,"":"outer"+h},function(z,D){B.fn[D]=function(G,J){var M=arguments.length&&(z||"boolean"!==typeof G),Q=z||(!0===G||!0===J?"margin":"border");return qb(this,function(R,T,ea){return B.isWindow(R)?
R.document.documentElement["client"+h]:9===R.nodeType?(T=R.documentElement,Math.max(R.body["scroll"+h],T["scroll"+h],R.body["offset"+h],T["offset"+h],T["client"+h])):ea===w?B.css(R,T,Q):B.style(R,T,ea,Q)},u,M?G:w,M,null)}})});B.fn.extend({bind:function(h,u,z){return this.on(h,null,u,z)},unbind:function(h,u){return this.off(h,null,u)},delegate:function(h,u,z,D){return this.on(u,h,z,D)},undelegate:function(h,u,z){return 1===arguments.length?this.off(h,"**"):this.off(u,h||"**",z)},size:function(){return this.length}});
B.fn.andSelf=B.fn.addBack;"function"===typeof define&&define.amd&&define("jquery",[],function(){return B});var Cd=v.jQuery,Dd=v.$;B.noConflict=function(h){v.$===B&&(v.$=Dd);h&&v.jQuery===B&&(v.jQuery=Cd);return B};k||(v.jQuery=v.$=B);return B});E.jQuery=jQuery;jQuery.noConflict(!0)})(window,ChemDoodle.lib);
(function(n){"function"===typeof define&&define.amd?define(["jquery"],n):"object"===typeof exports?module.exports=n:n(ChemDoodle.lib.jQuery)})(function(n){function E(g){var m=g||window.event,p=q.call(arguments,1),l=0,r=0,y=0,x=0;g=n.event.fix(m);g.type="mousewheel";"detail"in m&&(r=-1*m.detail);"wheelDelta"in m&&(r=m.wheelDelta);"wheelDeltaY"in m&&(r=m.wheelDeltaY);"wheelDeltaX"in m&&(l=-1*m.wheelDeltaX);"axis"in m&&m.axis===m.HORIZONTAL_AXIS&&(l=-1*r,r=0);var A=0===r?l:r;"deltaY"in m&&(A=r=-1*m.deltaY);
"deltaX"in m&&(l=m.deltaX,0===r&&(A=-1*l));if(0!==r||0!==l){if(1===m.deltaMode){var H=n.data(this,"mousewheel-line-height");A*=H;r*=H;l*=H}else 2===m.deltaMode&&(H=n.data(this,"mousewheel-page-height"),A*=H,r*=H,l*=H);H=Math.max(Math.abs(r),Math.abs(l));if(!c||H<c)c=H,b.settings.adjustOldDeltas&&"mousewheel"===m.type&&0===H%120&&(c/=40);b.settings.adjustOldDeltas&&"mousewheel"===m.type&&0===H%120&&(A/=40,l/=40,r/=40);A=Math[1<=A?"floor":"ceil"](A/c);l=Math[1<=l?"floor":"ceil"](l/c);r=Math[1<=r?"floor":
"ceil"](r/c);b.settings.normalizeOffset&&this.getBoundingClientRect&&(m=this.getBoundingClientRect(),y=g.clientX-m.left,x=g.clientY-m.top);g.deltaX=l;g.deltaY=r;g.deltaFactor=c;g.offsetX=y;g.offsetY=x;g.deltaMode=0;p.unshift(g,A,l,r);d&&clearTimeout(d);d=setTimeout(w,200);return(n.event.dispatch||n.event.handle).apply(this,p)}}function w(){c=null}var v=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],k="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll",
"MozMousePixelScroll"],q=Array.prototype.slice,d,c;if(n.event.fixHooks)for(var e=v.length;e;)n.event.fixHooks[v[--e]]=n.event.mouseHooks;var b=n.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var g=k.length;g;)this.addEventListener(k[--g],E,!1);else this.onmousewheel=E;n.data(this,"mousewheel-line-height",b.getLineHeight(this));n.data(this,"mousewheel-page-height",b.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var g=k.length;g;)this.removeEventListener(k[--g],
E,!1);else this.onmousewheel=null;n.removeData(this,"mousewheel-line-height");n.removeData(this,"mousewheel-page-height")},getLineHeight:function(g){g=n(g);var m=g["offsetParent"in n.fn?"offsetParent":"parent"]();m.length||(m=n("body"));return parseInt(m.css("fontSize"),10)||parseInt(g.css("fontSize"),10)||16},getPageHeight:function(g){return n(g).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};n.fn.extend({mousewheel:function(g){return g?this.bind("mousewheel",g):this.trigger("mousewheel")},
unmousewheel:function(g){return this.unbind("mousewheel",g)}})});
(function(n,E){"object"===typeof exports?module.exports=E(global):"function"===typeof define&&define.amd?define([],function(){return E(n)}):E(n)})(ChemDoodle.lib,function(n){function E(a){return k=a}function w(){return k="undefined"!==typeof Float32Array?Float32Array:Array}var v={};(function(){if("undefined"!=typeof Float32Array){var a=new Float32Array(1),f=new Int32Array(a.buffer);v.invsqrt=function(t){a[0]=t;f[0]=1597463007-(f[0]>>1);var C=a[0];return C*(1.5-.5*t*C*C)}}else v.invsqrt=function(t){return 1/
Math.sqrt(t)}})();var k=null;w();var q={create:function(a){var f=new k(3);a?(f[0]=a[0],f[1]=a[1],f[2]=a[2]):f[0]=f[1]=f[2]=0;return f},createFrom:function(a,f,t){var C=new k(3);C[0]=a;C[1]=f;C[2]=t;return C},set:function(a,f){f[0]=a[0];f[1]=a[1];f[2]=a[2];return f},equal:function(a,f){return a===f||1E-6>Math.abs(a[0]-f[0])&&1E-6>Math.abs(a[1]-f[1])&&1E-6>Math.abs(a[2]-f[2])},add:function(a,f,t){if(!t||a===t)return a[0]+=f[0],a[1]+=f[1],a[2]+=f[2],a;t[0]=a[0]+f[0];t[1]=a[1]+f[1];t[2]=a[2]+f[2];return t},
subtract:function(a,f,t){if(!t||a===t)return a[0]-=f[0],a[1]-=f[1],a[2]-=f[2],a;t[0]=a[0]-f[0];t[1]=a[1]-f[1];t[2]=a[2]-f[2];return t},multiply:function(a,f,t){if(!t||a===t)return a[0]*=f[0],a[1]*=f[1],a[2]*=f[2],a;t[0]=a[0]*f[0];t[1]=a[1]*f[1];t[2]=a[2]*f[2];return t},negate:function(a,f){f||(f=a);f[0]=-a[0];f[1]=-a[1];f[2]=-a[2];return f},scale:function(a,f,t){if(!t||a===t)return a[0]*=f,a[1]*=f,a[2]*=f,a;t[0]=a[0]*f;t[1]=a[1]*f;t[2]=a[2]*f;return t},normalize:function(a,f){f||(f=a);var t=a[0],
C=a[1];a=a[2];var F=Math.sqrt(t*t+C*C+a*a);if(!F)return f[0]=0,f[1]=0,f[2]=0,f;if(1===F)return f[0]=t,f[1]=C,f[2]=a,f;F=1/F;f[0]=t*F;f[1]=C*F;f[2]=a*F;return f},cross:function(a,f,t){t||(t=a);var C=a[0],F=a[1];a=a[2];var I=f[0],L=f[1];f=f[2];t[0]=F*f-a*L;t[1]=a*I-C*f;t[2]=C*L-F*I;return t},length:function(a){var f=a[0],t=a[1];a=a[2];return Math.sqrt(f*f+t*t+a*a)},squaredLength:function(a){var f=a[0],t=a[1];a=a[2];return f*f+t*t+a*a},dot:function(a,f){return a[0]*f[0]+a[1]*f[1]+a[2]*f[2]},direction:function(a,
f,t){t||(t=a);var C=a[0]-f[0],F=a[1]-f[1];a=a[2]-f[2];f=Math.sqrt(C*C+F*F+a*a);if(!f)return t[0]=0,t[1]=0,t[2]=0,t;f=1/f;t[0]=C*f;t[1]=F*f;t[2]=a*f;return t},lerp:function(a,f,t,C){C||(C=a);C[0]=a[0]+t*(f[0]-a[0]);C[1]=a[1]+t*(f[1]-a[1]);C[2]=a[2]+t*(f[2]-a[2]);return C},dist:function(a,f){var t=f[0]-a[0],C=f[1]-a[1];a=f[2]-a[2];return Math.sqrt(t*t+C*C+a*a)}},d=null,c=new k(4);q.unproject=function(a,f,t,C,F){F||(F=a);d||(d=l.create());var I=d;c[0]=2*(a[0]-C[0])/C[2]-1;c[1]=2*(a[1]-C[1])/C[3]-1;c[2]=
2*a[2]-1;c[3]=1;l.multiply(t,f,I);if(!l.inverse(I))return null;l.multiplyVec4(I,c);if(0===c[3])return null;F[0]=c[0]/c[3];F[1]=c[1]/c[3];F[2]=c[2]/c[3];return F};var e=q.createFrom(1,0,0),b=q.createFrom(0,1,0),g=q.createFrom(0,0,1),m=q.create();q.rotationTo=function(a,f,t){t||(t=r.create());var C=q.dot(a,f);if(1<=C)r.set(y,t);else if(-.999999>C)q.cross(e,a,m),1E-6>q.length(m)&&q.cross(b,a,m),1E-6>q.length(m)&&q.cross(g,a,m),q.normalize(m),r.fromAngleAxis(Math.PI,m,t);else{C=Math.sqrt(2*(1+C));var F=
1/C;q.cross(a,f,m);t[0]=m[0]*F;t[1]=m[1]*F;t[2]=m[2]*F;t[3]=.5*C;r.normalize(t)}1<t[3]?t[3]=1:-1>t[3]&&(t[3]=-1);return t};q.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};var p={create:function(a){var f=new k(9);a?(f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3],f[4]=a[4],f[5]=a[5],f[6]=a[6],f[7]=a[7],f[8]=a[8]):f[0]=f[1]=f[2]=f[3]=f[4]=f[5]=f[6]=f[7]=f[8]=0;return f},createFrom:function(a,f,t,C,F,I,L,O,S){var W=new k(9);W[0]=a;W[1]=f;W[2]=t;W[3]=C;W[4]=F;W[5]=I;W[6]=L;W[7]=O;W[8]=S;return W},determinant:function(a){var f=
a[3],t=a[4],C=a[5],F=a[6],I=a[7],L=a[8];return a[0]*(L*t-C*I)+a[1]*(-L*f+C*F)+a[2]*(I*f-t*F)},inverse:function(a,f){var t=a[0],C=a[1],F=a[2],I=a[3],L=a[4],O=a[5],S=a[6],W=a[7];a=a[8];var V=a*L-O*W,Y=-a*I+O*S,ba=W*I-L*S,X=t*V+C*Y+F*ba;if(!X)return null;X=1/X;f||(f=p.create());f[0]=V*X;f[1]=(-a*C+F*W)*X;f[2]=(O*C-F*L)*X;f[3]=Y*X;f[4]=(a*t-F*S)*X;f[5]=(-O*t+F*I)*X;f[6]=ba*X;f[7]=(-W*t+C*S)*X;f[8]=(L*t-C*I)*X;return f},multiply:function(a,f,t){t||(t=a);var C=a[0],F=a[1],I=a[2],L=a[3],O=a[4],S=a[5],W=
a[6],V=a[7];a=a[8];var Y=f[0],ba=f[1],X=f[2],ca=f[3],ia=f[4],Z=f[5],oa=f[6],ka=f[7];f=f[8];t[0]=Y*C+ba*L+X*W;t[1]=Y*F+ba*O+X*V;t[2]=Y*I+ba*S+X*a;t[3]=ca*C+ia*L+Z*W;t[4]=ca*F+ia*O+Z*V;t[5]=ca*I+ia*S+Z*a;t[6]=oa*C+ka*L+f*W;t[7]=oa*F+ka*O+f*V;t[8]=oa*I+ka*S+f*a;return t},multiplyVec2:function(a,f,t){t||(t=f);var C=f[0];f=f[1];t[0]=C*a[0]+f*a[3]+a[6];t[1]=C*a[1]+f*a[4]+a[7];return t},multiplyVec3:function(a,f,t){t||(t=f);var C=f[0],F=f[1];f=f[2];t[0]=C*a[0]+F*a[3]+f*a[6];t[1]=C*a[1]+F*a[4]+f*a[7];t[2]=
C*a[2]+F*a[5]+f*a[8];return t},set:function(a,f){f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[3];f[4]=a[4];f[5]=a[5];f[6]=a[6];f[7]=a[7];f[8]=a[8];return f},equal:function(a,f){return a===f||1E-6>Math.abs(a[0]-f[0])&&1E-6>Math.abs(a[1]-f[1])&&1E-6>Math.abs(a[2]-f[2])&&1E-6>Math.abs(a[3]-f[3])&&1E-6>Math.abs(a[4]-f[4])&&1E-6>Math.abs(a[5]-f[5])&&1E-6>Math.abs(a[6]-f[6])&&1E-6>Math.abs(a[7]-f[7])&&1E-6>Math.abs(a[8]-f[8])},identity:function(a){a||(a=p.create());a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=
0;a[7]=0;a[8]=1;return a},transpose:function(a,f){if(!f||a===f){f=a[1];var t=a[2],C=a[5];a[1]=a[3];a[2]=a[6];a[3]=f;a[5]=a[7];a[6]=t;a[7]=C;return a}f[0]=a[0];f[1]=a[3];f[2]=a[6];f[3]=a[1];f[4]=a[4];f[5]=a[7];f[6]=a[2];f[7]=a[5];f[8]=a[8];return f},toMat4:function(a,f){f||(f=l.create());f[15]=1;f[14]=0;f[13]=0;f[12]=0;f[11]=0;f[10]=a[8];f[9]=a[7];f[8]=a[6];f[7]=0;f[6]=a[5];f[5]=a[4];f[4]=a[3];f[3]=0;f[2]=a[2];f[1]=a[1];f[0]=a[0];return f},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+
", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"}},l={create:function(a){var f=new k(16);a&&(f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3],f[4]=a[4],f[5]=a[5],f[6]=a[6],f[7]=a[7],f[8]=a[8],f[9]=a[9],f[10]=a[10],f[11]=a[11],f[12]=a[12],f[13]=a[13],f[14]=a[14],f[15]=a[15]);return f},createFrom:function(a,f,t,C,F,I,L,O,S,W,V,Y,ba,X,ca,ia){var Z=new k(16);Z[0]=a;Z[1]=f;Z[2]=t;Z[3]=C;Z[4]=F;Z[5]=I;Z[6]=L;Z[7]=O;Z[8]=S;Z[9]=W;Z[10]=V;Z[11]=Y;Z[12]=ba;Z[13]=X;Z[14]=ca;Z[15]=ia;return Z},set:function(a,f){f[0]=
a[0];f[1]=a[1];f[2]=a[2];f[3]=a[3];f[4]=a[4];f[5]=a[5];f[6]=a[6];f[7]=a[7];f[8]=a[8];f[9]=a[9];f[10]=a[10];f[11]=a[11];f[12]=a[12];f[13]=a[13];f[14]=a[14];f[15]=a[15];return f},equal:function(a,f){return a===f||1E-6>Math.abs(a[0]-f[0])&&1E-6>Math.abs(a[1]-f[1])&&1E-6>Math.abs(a[2]-f[2])&&1E-6>Math.abs(a[3]-f[3])&&1E-6>Math.abs(a[4]-f[4])&&1E-6>Math.abs(a[5]-f[5])&&1E-6>Math.abs(a[6]-f[6])&&1E-6>Math.abs(a[7]-f[7])&&1E-6>Math.abs(a[8]-f[8])&&1E-6>Math.abs(a[9]-f[9])&&1E-6>Math.abs(a[10]-f[10])&&1E-6>
Math.abs(a[11]-f[11])&&1E-6>Math.abs(a[12]-f[12])&&1E-6>Math.abs(a[13]-f[13])&&1E-6>Math.abs(a[14]-f[14])&&1E-6>Math.abs(a[15]-f[15])},identity:function(a){a||(a=l.create());a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,f){if(!f||a===f){f=a[1];var t=a[2],C=a[3],F=a[6],I=a[7],L=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=f;a[6]=a[9];a[7]=a[13];a[8]=t;a[9]=F;a[11]=a[14];a[12]=C;a[13]=I;a[14]=L;return a}f[0]=
a[0];f[1]=a[4];f[2]=a[8];f[3]=a[12];f[4]=a[1];f[5]=a[5];f[6]=a[9];f[7]=a[13];f[8]=a[2];f[9]=a[6];f[10]=a[10];f[11]=a[14];f[12]=a[3];f[13]=a[7];f[14]=a[11];f[15]=a[15];return f},determinant:function(a){var f=a[0],t=a[1],C=a[2],F=a[3],I=a[4],L=a[5],O=a[6],S=a[7],W=a[8],V=a[9],Y=a[10],ba=a[11],X=a[12],ca=a[13],ia=a[14];a=a[15];return X*V*O*F-W*ca*O*F-X*L*Y*F+I*ca*Y*F+W*L*ia*F-I*V*ia*F-X*V*C*S+W*ca*C*S+X*t*Y*S-f*ca*Y*S-W*t*ia*S+f*V*ia*S+X*L*C*ba-I*ca*C*ba-X*t*O*ba+f*ca*O*ba+I*t*ia*ba-f*L*ia*ba-W*L*C*
a+I*V*C*a+W*t*O*a-f*V*O*a-I*t*Y*a+f*L*Y*a},inverse:function(a,f){f||(f=a);var t=a[0],C=a[1],F=a[2],I=a[3],L=a[4],O=a[5],S=a[6],W=a[7],V=a[8],Y=a[9],ba=a[10],X=a[11],ca=a[12],ia=a[13],Z=a[14];a=a[15];var oa=t*O-C*L,ka=t*S-F*L,na=t*W-I*L,pa=C*S-F*O,ta=C*W-I*O,Ea=F*W-I*S,Ua=V*ia-Y*ca,Qa=V*Z-ba*ca,Va=V*a-X*ca,Ka=Y*Z-ba*ia,mb=Y*a-X*ia,Wa=ba*a-X*Z,ma=oa*Wa-ka*mb+na*Ka+pa*Va-ta*Qa+Ea*Ua;if(!ma)return null;ma=1/ma;f[0]=(O*Wa-S*mb+W*Ka)*ma;f[1]=(-C*Wa+F*mb-I*Ka)*ma;f[2]=(ia*Ea-Z*ta+a*pa)*ma;f[3]=(-Y*Ea+ba*
ta-X*pa)*ma;f[4]=(-L*Wa+S*Va-W*Qa)*ma;f[5]=(t*Wa-F*Va+I*Qa)*ma;f[6]=(-ca*Ea+Z*na-a*ka)*ma;f[7]=(V*Ea-ba*na+X*ka)*ma;f[8]=(L*mb-O*Va+W*Ua)*ma;f[9]=(-t*mb+C*Va-I*Ua)*ma;f[10]=(ca*ta-ia*na+a*oa)*ma;f[11]=(-V*ta+Y*na-X*oa)*ma;f[12]=(-L*Ka+O*Qa-S*Ua)*ma;f[13]=(t*Ka-C*Qa+F*Ua)*ma;f[14]=(-ca*pa+ia*ka-Z*oa)*ma;f[15]=(V*pa-Y*ka+ba*oa)*ma;return f},toRotationMat:function(a,f){f||(f=l.create());f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[3];f[4]=a[4];f[5]=a[5];f[6]=a[6];f[7]=a[7];f[8]=a[8];f[9]=a[9];f[10]=a[10];f[11]=
a[11];f[12]=0;f[13]=0;f[14]=0;f[15]=1;return f},toMat3:function(a,f){f||(f=p.create());f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[4];f[4]=a[5];f[5]=a[6];f[6]=a[8];f[7]=a[9];f[8]=a[10];return f},toInverseMat3:function(a,f){var t=a[0],C=a[1],F=a[2],I=a[4],L=a[5],O=a[6],S=a[8],W=a[9];a=a[10];var V=a*L-O*W,Y=-a*I+O*S,ba=W*I-L*S,X=t*V+C*Y+F*ba;if(!X)return null;X=1/X;f||(f=p.create());f[0]=V*X;f[1]=(-a*C+F*W)*X;f[2]=(O*C-F*L)*X;f[3]=Y*X;f[4]=(a*t-F*S)*X;f[5]=(-O*t+F*I)*X;f[6]=ba*X;f[7]=(-W*t+C*S)*X;f[8]=(L*
t-C*I)*X;return f},multiply:function(a,f,t){t||(t=a);var C=a[0],F=a[1],I=a[2],L=a[3],O=a[4],S=a[5],W=a[6],V=a[7],Y=a[8],ba=a[9],X=a[10],ca=a[11],ia=a[12],Z=a[13],oa=a[14];a=a[15];var ka=f[0],na=f[1],pa=f[2],ta=f[3];t[0]=ka*C+na*O+pa*Y+ta*ia;t[1]=ka*F+na*S+pa*ba+ta*Z;t[2]=ka*I+na*W+pa*X+ta*oa;t[3]=ka*L+na*V+pa*ca+ta*a;ka=f[4];na=f[5];pa=f[6];ta=f[7];t[4]=ka*C+na*O+pa*Y+ta*ia;t[5]=ka*F+na*S+pa*ba+ta*Z;t[6]=ka*I+na*W+pa*X+ta*oa;t[7]=ka*L+na*V+pa*ca+ta*a;ka=f[8];na=f[9];pa=f[10];ta=f[11];t[8]=ka*C+na*
O+pa*Y+ta*ia;t[9]=ka*F+na*S+pa*ba+ta*Z;t[10]=ka*I+na*W+pa*X+ta*oa;t[11]=ka*L+na*V+pa*ca+ta*a;ka=f[12];na=f[13];pa=f[14];ta=f[15];t[12]=ka*C+na*O+pa*Y+ta*ia;t[13]=ka*F+na*S+pa*ba+ta*Z;t[14]=ka*I+na*W+pa*X+ta*oa;t[15]=ka*L+na*V+pa*ca+ta*a;return t},multiplyVec3:function(a,f,t){t||(t=f);var C=f[0],F=f[1];f=f[2];t[0]=a[0]*C+a[4]*F+a[8]*f+a[12];t[1]=a[1]*C+a[5]*F+a[9]*f+a[13];t[2]=a[2]*C+a[6]*F+a[10]*f+a[14];return t},multiplyVec4:function(a,f,t){t||(t=f);var C=f[0],F=f[1],I=f[2];f=f[3];t[0]=a[0]*C+a[4]*
F+a[8]*I+a[12]*f;t[1]=a[1]*C+a[5]*F+a[9]*I+a[13]*f;t[2]=a[2]*C+a[6]*F+a[10]*I+a[14]*f;t[3]=a[3]*C+a[7]*F+a[11]*I+a[15]*f;return t},translate:function(a,f,t){var C=f[0],F=f[1];f=f[2];if(!t||a===t)return a[12]=a[0]*C+a[4]*F+a[8]*f+a[12],a[13]=a[1]*C+a[5]*F+a[9]*f+a[13],a[14]=a[2]*C+a[6]*F+a[10]*f+a[14],a[15]=a[3]*C+a[7]*F+a[11]*f+a[15],a;var I=a[0];var L=a[1];var O=a[2];var S=a[3];var W=a[4];var V=a[5];var Y=a[6];var ba=a[7];var X=a[8];var ca=a[9];var ia=a[10];var Z=a[11];t[0]=I;t[1]=L;t[2]=O;t[3]=
S;t[4]=W;t[5]=V;t[6]=Y;t[7]=ba;t[8]=X;t[9]=ca;t[10]=ia;t[11]=Z;t[12]=I*C+W*F+X*f+a[12];t[13]=L*C+V*F+ca*f+a[13];t[14]=O*C+Y*F+ia*f+a[14];t[15]=S*C+ba*F+Z*f+a[15];return t},scale:function(a,f,t){var C=f[0],F=f[1];f=f[2];if(!t||a===t)return a[0]*=C,a[1]*=C,a[2]*=C,a[3]*=C,a[4]*=F,a[5]*=F,a[6]*=F,a[7]*=F,a[8]*=f,a[9]*=f,a[10]*=f,a[11]*=f,a;t[0]=a[0]*C;t[1]=a[1]*C;t[2]=a[2]*C;t[3]=a[3]*C;t[4]=a[4]*F;t[5]=a[5]*F;t[6]=a[6]*F;t[7]=a[7]*F;t[8]=a[8]*f;t[9]=a[9]*f;t[10]=a[10]*f;t[11]=a[11]*f;t[12]=a[12];t[13]=
a[13];t[14]=a[14];t[15]=a[15];return t},rotate:function(a,f,t,C){var F=t[0],I=t[1];t=t[2];var L=Math.sqrt(F*F+I*I+t*t);if(!L)return null;1!==L&&(L=1/L,F*=L,I*=L,t*=L);var O=Math.sin(f);var S=Math.cos(f);var W=1-S;f=a[0];L=a[1];var V=a[2];var Y=a[3];var ba=a[4];var X=a[5];var ca=a[6];var ia=a[7];var Z=a[8];var oa=a[9];var ka=a[10];var na=a[11];var pa=F*F*W+S;var ta=I*F*W+t*O;var Ea=t*F*W-I*O;var Ua=F*I*W-t*O;var Qa=I*I*W+S;var Va=t*I*W+F*O;var Ka=F*t*W+I*O;F=I*t*W-F*O;I=t*t*W+S;C?a!==C&&(C[12]=a[12],
C[13]=a[13],C[14]=a[14],C[15]=a[15]):C=a;C[0]=f*pa+ba*ta+Z*Ea;C[1]=L*pa+X*ta+oa*Ea;C[2]=V*pa+ca*ta+ka*Ea;C[3]=Y*pa+ia*ta+na*Ea;C[4]=f*Ua+ba*Qa+Z*Va;C[5]=L*Ua+X*Qa+oa*Va;C[6]=V*Ua+ca*Qa+ka*Va;C[7]=Y*Ua+ia*Qa+na*Va;C[8]=f*Ka+ba*F+Z*I;C[9]=L*Ka+X*F+oa*I;C[10]=V*Ka+ca*F+ka*I;C[11]=Y*Ka+ia*F+na*I;return C},rotateX:function(a,f,t){var C=Math.sin(f);f=Math.cos(f);var F=a[4],I=a[5],L=a[6],O=a[7],S=a[8],W=a[9],V=a[10],Y=a[11];t?a!==t&&(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[12]=a[12],t[13]=a[13],t[14]=
a[14],t[15]=a[15]):t=a;t[4]=F*f+S*C;t[5]=I*f+W*C;t[6]=L*f+V*C;t[7]=O*f+Y*C;t[8]=F*-C+S*f;t[9]=I*-C+W*f;t[10]=L*-C+V*f;t[11]=O*-C+Y*f;return t},rotateY:function(a,f,t){var C=Math.sin(f);f=Math.cos(f);var F=a[0],I=a[1],L=a[2],O=a[3],S=a[8],W=a[9],V=a[10],Y=a[11];t?a!==t&&(t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]):t=a;t[0]=F*f+S*-C;t[1]=I*f+W*-C;t[2]=L*f+V*-C;t[3]=O*f+Y*-C;t[8]=F*C+S*f;t[9]=I*C+W*f;t[10]=L*C+V*f;t[11]=O*C+Y*f;return t},rotateZ:function(a,
f,t){var C=Math.sin(f);f=Math.cos(f);var F=a[0],I=a[1],L=a[2],O=a[3],S=a[4],W=a[5],V=a[6],Y=a[7];t?a!==t&&(t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]):t=a;t[0]=F*f+S*C;t[1]=I*f+W*C;t[2]=L*f+V*C;t[3]=O*f+Y*C;t[4]=F*-C+S*f;t[5]=I*-C+W*f;t[6]=L*-C+V*f;t[7]=O*-C+Y*f;return t},frustum:function(a,f,t,C,F,I,L){L||(L=l.create());var O=f-a,S=C-t,W=I-F;L[0]=2*F/O;L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=2*F/S;L[6]=0;L[7]=0;L[8]=(f+a)/O;L[9]=(C+t)/S;L[10]=-(I+F)/W;L[11]=
-1;L[12]=0;L[13]=0;L[14]=-(I*F*2)/W;L[15]=0;return L},perspective:function(a,f,t,C,F){a=t*Math.tan(a*Math.PI/360);f*=a;return l.frustum(-f,f,-a,a,t,C,F)},ortho:function(a,f,t,C,F,I,L){L||(L=l.create());var O=f-a,S=C-t,W=I-F;L[0]=2/O;L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=2/S;L[6]=0;L[7]=0;L[8]=0;L[9]=0;L[10]=-2/W;L[11]=0;L[12]=-(a+f)/O;L[13]=-(C+t)/S;L[14]=-(I+F)/W;L[15]=1;return L},lookAt:function(a,f,t,C){C||(C=l.create());var F=a[0],I=a[1];a=a[2];var L=t[0];var O=t[1];var S=t[2];var W=f[0];t=f[1];var V=
f[2];if(F===W&&I===t&&a===V)return l.identity(C);f=F-W;t=I-t;W=a-V;var Y=1/Math.sqrt(f*f+t*t+W*W);f*=Y;t*=Y;W*=Y;V=O*W-S*t;S=S*f-L*W;L=L*t-O*f;(Y=Math.sqrt(V*V+S*S+L*L))?(Y=1/Y,V*=Y,S*=Y,L*=Y):L=S=V=0;O=t*L-W*S;var ba=W*V-f*L;var X=f*S-t*V;(Y=Math.sqrt(O*O+ba*ba+X*X))?(Y=1/Y,O*=Y,ba*=Y,X*=Y):X=ba=O=0;C[0]=V;C[1]=O;C[2]=f;C[3]=0;C[4]=S;C[5]=ba;C[6]=t;C[7]=0;C[8]=L;C[9]=X;C[10]=W;C[11]=0;C[12]=-(V*F+S*I+L*a);C[13]=-(O*F+ba*I+X*a);C[14]=-(f*F+t*I+W*a);C[15]=1;return C},fromRotationTranslation:function(a,
f,t){t||(t=l.create());var C=a[0],F=a[1],I=a[2],L=a[3],O=C+C,S=F+F,W=I+I;a=C*O;var V=C*S;C*=W;var Y=F*S;F*=W;I*=W;O*=L;S*=L;L*=W;t[0]=1-(Y+I);t[1]=V+L;t[2]=C-S;t[3]=0;t[4]=V-L;t[5]=1-(a+I);t[6]=F+O;t[7]=0;t[8]=C+S;t[9]=F-O;t[10]=1-(a+Y);t[11]=0;t[12]=f[0];t[13]=f[1];t[14]=f[2];t[15]=1;return t},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"}},r={create:function(a){var f=
new k(4);a?(f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3]):f[0]=f[1]=f[2]=f[3]=0;return f},createFrom:function(a,f,t,C){var F=new k(4);F[0]=a;F[1]=f;F[2]=t;F[3]=C;return F},set:function(a,f){f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[3];return f},equal:function(a,f){return a===f||1E-6>Math.abs(a[0]-f[0])&&1E-6>Math.abs(a[1]-f[1])&&1E-6>Math.abs(a[2]-f[2])&&1E-6>Math.abs(a[3]-f[3])},identity:function(a){a||(a=r.create());a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}},y=r.identity();r.calculateW=function(a,f){var t=a[0],
C=a[1],F=a[2];if(!f||a===f)return a[3]=-Math.sqrt(Math.abs(1-t*t-C*C-F*F)),a;f[0]=t;f[1]=C;f[2]=F;f[3]=-Math.sqrt(Math.abs(1-t*t-C*C-F*F));return f};r.dot=function(a,f){return a[0]*f[0]+a[1]*f[1]+a[2]*f[2]+a[3]*f[3]};r.inverse=function(a,f){var t=a[0],C=a[1],F=a[2],I=a[3];t=(t=t*t+C*C+F*F+I*I)?1/t:0;if(!f||a===f)return a[0]*=-t,a[1]*=-t,a[2]*=-t,a[3]*=t,a;f[0]=-a[0]*t;f[1]=-a[1]*t;f[2]=-a[2]*t;f[3]=a[3]*t;return f};r.conjugate=function(a,f){if(!f||a===f)return a[0]*=-1,a[1]*=-1,a[2]*=-1,a;f[0]=-a[0];
f[1]=-a[1];f[2]=-a[2];f[3]=a[3];return f};r.length=function(a){var f=a[0],t=a[1],C=a[2];a=a[3];return Math.sqrt(f*f+t*t+C*C+a*a)};r.normalize=function(a,f){f||(f=a);var t=a[0],C=a[1],F=a[2];a=a[3];var I=Math.sqrt(t*t+C*C+F*F+a*a);if(0===I)return f[0]=0,f[1]=0,f[2]=0,f[3]=0,f;I=1/I;f[0]=t*I;f[1]=C*I;f[2]=F*I;f[3]=a*I;return f};r.add=function(a,f,t){if(!t||a===t)return a[0]+=f[0],a[1]+=f[1],a[2]+=f[2],a[3]+=f[3],a;t[0]=a[0]+f[0];t[1]=a[1]+f[1];t[2]=a[2]+f[2];t[3]=a[3]+f[3];return t};r.multiply=function(a,
f,t){t||(t=a);var C=a[0],F=a[1],I=a[2];a=a[3];var L=f[0],O=f[1],S=f[2];f=f[3];t[0]=C*f+a*L+F*S-I*O;t[1]=F*f+a*O+I*L-C*S;t[2]=I*f+a*S+C*O-F*L;t[3]=a*f-C*L-F*O-I*S;return t};r.multiplyVec3=function(a,f,t){t||(t=f);var C=f[0],F=f[1],I=f[2];f=a[0];var L=a[1],O=a[2];a=a[3];var S=a*C+L*I-O*F,W=a*F+O*C-f*I,V=a*I+f*F-L*C;C=-f*C-L*F-O*I;t[0]=S*a+C*-f+W*-O-V*-L;t[1]=W*a+C*-L+V*-f-S*-O;t[2]=V*a+C*-O+S*-L-W*-f;return t};r.scale=function(a,f,t){if(!t||a===t)return a[0]*=f,a[1]*=f,a[2]*=f,a[3]*=f,a;t[0]=a[0]*f;
t[1]=a[1]*f;t[2]=a[2]*f;t[3]=a[3]*f;return t};r.toMat3=function(a,f){f||(f=p.create());var t=a[0],C=a[1],F=a[2],I=a[3],L=t+t,O=C+C,S=F+F;a=t*L;var W=t*O;t*=S;var V=C*O;C*=S;F*=S;L*=I;O*=I;I*=S;f[0]=1-(V+F);f[1]=W+I;f[2]=t-O;f[3]=W-I;f[4]=1-(a+F);f[5]=C+L;f[6]=t+O;f[7]=C-L;f[8]=1-(a+V);return f};r.toMat4=function(a,f){f||(f=l.create());var t=a[0],C=a[1],F=a[2],I=a[3],L=t+t,O=C+C,S=F+F;a=t*L;var W=t*O;t*=S;var V=C*O;C*=S;F*=S;L*=I;O*=I;I*=S;f[0]=1-(V+F);f[1]=W+I;f[2]=t-O;f[3]=0;f[4]=W-I;f[5]=1-(a+F);
f[6]=C+L;f[7]=0;f[8]=t+O;f[9]=C-L;f[10]=1-(a+V);f[11]=0;f[12]=0;f[13]=0;f[14]=0;f[15]=1;return f};r.slerp=function(a,f,t,C){C||(C=a);var F=a[0]*f[0]+a[1]*f[1]+a[2]*f[2]+a[3]*f[3];if(1<=Math.abs(F))return C!==a&&(C[0]=a[0],C[1]=a[1],C[2]=a[2],C[3]=a[3]),C;var I=Math.acos(F);var L=Math.sqrt(1-F*F);if(.001>Math.abs(L))return C[0]=.5*a[0]+.5*f[0],C[1]=.5*a[1]+.5*f[1],C[2]=.5*a[2]+.5*f[2],C[3]=.5*a[3]+.5*f[3],C;F=Math.sin((1-t)*I)/L;t=Math.sin(t*I)/L;C[0]=a[0]*F+f[0]*t;C[1]=a[1]*F+f[1]*t;C[2]=a[2]*F+f[2]*
t;C[3]=a[3]*F+f[3]*t;return C};r.fromRotationMatrix=function(a,f){f||(f=r.create());var t=a[0]+a[4]+a[8];if(0<t){var C=Math.sqrt(t+1);f[3]=.5*C;C=.5/C;f[0]=(a[7]-a[5])*C;f[1]=(a[2]-a[6])*C;f[2]=(a[3]-a[1])*C}else{C=r.fromRotationMatrix.s_iNext=r.fromRotationMatrix.s_iNext||[1,2,0];t=0;a[4]>a[0]&&(t=1);a[8]>a[3*t+t]&&(t=2);var F=C[t],I=C[F];C=Math.sqrt(a[3*t+t]-a[3*F+F]-a[3*I+I]+1);f[t]=.5*C;C=.5/C;f[3]=(a[3*I+F]-a[3*F+I])*C;f[F]=(a[3*F+t]+a[3*t+F])*C;f[I]=(a[3*I+t]+a[3*t+I])*C}return f};p.toQuat4=
r.fromRotationMatrix;(function(){var a=p.create();r.fromAxes=function(f,t,C,F){a[0]=t[0];a[3]=t[1];a[6]=t[2];a[1]=C[0];a[4]=C[1];a[7]=C[2];a[2]=f[0];a[5]=f[1];a[8]=f[2];return r.fromRotationMatrix(a,F)}})();r.identity=function(a){a||(a=r.create());a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};r.fromAngleAxis=function(a,f,t){t||(t=r.create());a*=.5;var C=Math.sin(a);t[3]=Math.cos(a);t[0]=C*f[0];t[1]=C*f[1];t[2]=C*f[2];return t};r.toAngleAxis=function(a,f){f||(f=a);var t=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<t?(f[3]=
2*Math.acos(a[3]),t=v.invsqrt(t),f[0]=a[0]*t,f[1]=a[1]*t,f[2]=a[2]*t):(f[3]=0,f[0]=1,f[1]=0,f[2]=0);return f};r.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};var x={create:function(a){var f=new k(2);a?(f[0]=a[0],f[1]=a[1]):(f[0]=0,f[1]=0);return f},createFrom:function(a,f){var t=new k(2);t[0]=a;t[1]=f;return t},add:function(a,f,t){t||(t=f);t[0]=a[0]+f[0];t[1]=a[1]+f[1];return t},subtract:function(a,f,t){t||(t=f);t[0]=a[0]-f[0];t[1]=a[1]-f[1];return t},multiply:function(a,f,t){t||
(t=f);t[0]=a[0]*f[0];t[1]=a[1]*f[1];return t},divide:function(a,f,t){t||(t=f);t[0]=a[0]/f[0];t[1]=a[1]/f[1];return t},scale:function(a,f,t){t||(t=a);t[0]=a[0]*f;t[1]=a[1]*f;return t},dist:function(a,f){var t=f[0]-a[0];a=f[1]-a[1];return Math.sqrt(t*t+a*a)},set:function(a,f){f[0]=a[0];f[1]=a[1];return f},equal:function(a,f){return a===f||1E-6>Math.abs(a[0]-f[0])&&1E-6>Math.abs(a[1]-f[1])},negate:function(a,f){f||(f=a);f[0]=-a[0];f[1]=-a[1];return f},normalize:function(a,f){f||(f=a);var t=a[0]*a[0]+
a[1]*a[1];0<t?(t=Math.sqrt(t),f[0]=a[0]/t,f[1]=a[1]/t):f[0]=f[1]=0;return f},cross:function(a,f,t){a=a[0]*f[1]-a[1]*f[0];if(!t)return a;t[0]=t[1]=0;t[2]=a;return t},length:function(a){var f=a[0];a=a[1];return Math.sqrt(f*f+a*a)},squaredLength:function(a){var f=a[0];a=a[1];return f*f+a*a},dot:function(a,f){return a[0]*f[0]+a[1]*f[1]},direction:function(a,f,t){t||(t=a);var C=a[0]-f[0];a=a[1]-f[1];f=C*C+a*a;if(!f)return t[0]=0,t[1]=0,t[2]=0,t;f=1/Math.sqrt(f);t[0]=C*f;t[1]=a*f;return t},lerp:function(a,
f,t,C){C||(C=a);C[0]=a[0]+t*(f[0]-a[0]);C[1]=a[1]+t*(f[1]-a[1]);return C},str:function(a){return"["+a[0]+", "+a[1]+"]"}},A={create:function(a){var f=new k(4);a?(f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3]):f[0]=f[1]=f[2]=f[3]=0;return f},createFrom:function(a,f,t,C){var F=new k(4);F[0]=a;F[1]=f;F[2]=t;F[3]=C;return F},set:function(a,f){f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[3];return f},equal:function(a,f){return a===f||1E-6>Math.abs(a[0]-f[0])&&1E-6>Math.abs(a[1]-f[1])&&1E-6>Math.abs(a[2]-f[2])&&1E-6>
Math.abs(a[3]-f[3])},identity:function(a){a||(a=A.create());a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},transpose:function(a,f){if(!f||a===f)return f=a[1],a[1]=a[2],a[2]=f,a;f[0]=a[0];f[1]=a[2];f[2]=a[1];f[3]=a[3];return f},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},inverse:function(a,f){f||(f=a);var t=a[0],C=a[1],F=a[2];a=a[3];var I=t*a-F*C;if(!I)return null;I=1/I;f[0]=a*I;f[1]=-C*I;f[2]=-F*I;f[3]=t*I;return f},multiply:function(a,f,t){t||(t=a);var C=a[0],F=a[1],I=a[2];a=a[3];t[0]=C*f[0]+F*f[2];
t[1]=C*f[1]+F*f[3];t[2]=I*f[0]+a*f[2];t[3]=I*f[1]+a*f[3];return t},rotate:function(a,f,t){t||(t=a);var C=a[0],F=a[1],I=a[2];a=a[3];var L=Math.sin(f);f=Math.cos(f);t[0]=C*f+F*L;t[1]=C*-L+F*f;t[2]=I*f+a*L;t[3]=I*-L+a*f;return t},multiplyVec2:function(a,f,t){t||(t=f);var C=f[0];f=f[1];t[0]=C*a[0]+f*a[1];t[1]=C*a[2]+f*a[3];return t},scale:function(a,f,t){t||(t=a);var C=a[1],F=a[2],I=a[3],L=f[0];f=f[1];t[0]=a[0]*L;t[1]=C*f;t[2]=F*L;t[3]=I*f;return t},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+
", "+a[3]+"]"}},H={create:function(a){var f=new k(4);a?(f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3]):(f[0]=0,f[1]=0,f[2]=0,f[3]=0);return f},createFrom:function(a,f,t,C){var F=new k(4);F[0]=a;F[1]=f;F[2]=t;F[3]=C;return F},add:function(a,f,t){t||(t=f);t[0]=a[0]+f[0];t[1]=a[1]+f[1];t[2]=a[2]+f[2];t[3]=a[3]+f[3];return t},subtract:function(a,f,t){t||(t=f);t[0]=a[0]-f[0];t[1]=a[1]-f[1];t[2]=a[2]-f[2];t[3]=a[3]-f[3];return t},multiply:function(a,f,t){t||(t=f);t[0]=a[0]*f[0];t[1]=a[1]*f[1];t[2]=a[2]*f[2];
t[3]=a[3]*f[3];return t},divide:function(a,f,t){t||(t=f);t[0]=a[0]/f[0];t[1]=a[1]/f[1];t[2]=a[2]/f[2];t[3]=a[3]/f[3];return t},scale:function(a,f,t){t||(t=a);t[0]=a[0]*f;t[1]=a[1]*f;t[2]=a[2]*f;t[3]=a[3]*f;return t},set:function(a,f){f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[3];return f},equal:function(a,f){return a===f||1E-6>Math.abs(a[0]-f[0])&&1E-6>Math.abs(a[1]-f[1])&&1E-6>Math.abs(a[2]-f[2])&&1E-6>Math.abs(a[3]-f[3])},negate:function(a,f){f||(f=a);f[0]=-a[0];f[1]=-a[1];f[2]=-a[2];f[3]=-a[3];return f},
length:function(a){var f=a[0],t=a[1],C=a[2];a=a[3];return Math.sqrt(f*f+t*t+C*C+a*a)},squaredLength:function(a){var f=a[0],t=a[1],C=a[2];a=a[3];return f*f+t*t+C*C+a*a},lerp:function(a,f,t,C){C||(C=a);C[0]=a[0]+t*(f[0]-a[0]);C[1]=a[1]+t*(f[1]-a[1]);C[2]=a[2]+t*(f[2]-a[2]);C[3]=a[3]+t*(f[3]-a[3]);return C},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}};n&&(n.glMatrixArrayType=k,n.MatrixArray=k,n.setMatrixArrayType=E,n.determineMatrixArrayType=w,n.glMath=v,n.vec2=x,n.vec3=q,n.vec4=
H,n.mat2=A,n.mat3=p,n.mat4=l,n.quat4=r);return{glMatrixArrayType:k,MatrixArray:k,setMatrixArrayType:E,determineMatrixArrayType:w,glMath:v,vec2:x,vec3:q,vec4:H,mat2:A,mat3:p,mat4:l,quat4:r}});
(function(n){function E(l){return 0==l?0:0<l?1:-1}var w={subtract:function(l,r){return{x:l.x-r.x,y:l.y-r.y}},dotProduct:function(l,r){return l.x*r.x+l.y*r.y},square:function(l){return Math.sqrt(l.x*l.x+l.y*l.y)},scale:function(l,r){return{x:l.x*r,y:l.y*r}}},v=Math.pow(2,-65),k=function(l,r){for(var y=[],x=r.length-1,A=2*x-1,H=[],a=[],f=[],t=[],C=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],F=0;F<=x;F++)H[F]=w.subtract(r[F],l);for(F=0;F<=x-1;F++)a[F]=w.subtract(r[F+1],r[F]),a[F]=w.scale(a[F],3);for(F=
0;F<=x-1;F++)for(var I=0;I<=x;I++)f[F]||(f[F]=[]),f[F][I]=w.dotProduct(a[F],H[I]);for(F=0;F<=A;F++)t[F]||(t[F]=[]),t[F].y=0,t[F].x=parseFloat(F)/A;A=x-1;for(H=0;H<=x+A;H++)for(a=Math.min(H,x),F=Math.max(0,H-A);F<=a;F++)I=H-F,t[F+I].y+=f[I][F]*C[I][F];x=r.length-1;t=q(t,2*x-1,y,0);A=w.subtract(l,r[0]);f=w.square(A);for(F=C=0;F<t;F++)A=w.subtract(l,d(r,x,y[F],null,null)),A=w.square(A),A<f&&(f=A,C=y[F]);A=w.subtract(l,r[x]);A=w.square(A);A<f&&(f=A,C=1);return{location:C,distance:f}},q=function(l,r,y,
x){var A=[],H=[],a=[],f=[],t=0;var C=E(l[0].y);for(var F=1;F<=r;F++){var I=E(l[F].y);I!=C&&t++;C=I}switch(t){case 0:return 0;case 1:if(64<=x)return y[0]=(l[0].x+l[r].x)/2,1;var L,O;t=l[0].y-l[r].y;I=l[r].x-l[0].x;C=l[0].x*l[r].y-l[r].x*l[0].y;F=L=0;for(O=1;O<r;O++){var S=t*l[O].x+I*l[O].y+C;S>L?L=S:S<F&&(F=S)}O=I;L=1/(0*O-1*t)*(C-L-0*O);O=I;t=1/(0*O-1*t)*(C-F-0*O);if(Math.max(L,t)-Math.min(L,t)<v)return a=l[r].x-l[0].x,f=l[r].y-l[0].y,y[0]=1/(0*a-1*f)*(a*(l[0].y-0)-f*(l[0].x-0)),1}d(l,r,.5,A,H);l=
q(A,r,a,x+1);r=q(H,r,f,x+1);for(x=0;x<l;x++)y[x]=a[x];for(x=0;x<r;x++)y[x+l]=f[x];return l+r},d=function(l,r,y,x,A){for(var H=[[]],a=0;a<=r;a++)H[0][a]=l[a];for(l=1;l<=r;l++)for(a=0;a<=r-l;a++)H[l]||(H[l]=[]),H[l][a]||(H[l][a]={}),H[l][a].x=(1-y)*H[l-1][a].x+y*H[l-1][a+1].x,H[l][a].y=(1-y)*H[l-1][a].y+y*H[l-1][a+1].y;if(null!=x)for(a=0;a<=r;a++)x[a]=H[a][0];if(null!=A)for(a=0;a<=r;a++)A[a]=H[r-a][a];return H[r][0]},c={},e=function(l){var r=c[l];if(!r){r=[];var y=function(C){return function(F){return C}},
x=function(){return function(C){return C}},A=function(){return function(C){return 1-C}},H=function(C){return function(F){for(var I=1,L=0;L<C.length;L++)I*=C[L](F);return I}};r.push(new function(){return function(C){return Math.pow(C,l)}});for(var a=1;a<l;a++){for(var f=[new y(l)],t=0;t<l-a;t++)f.push(new x);for(t=0;t<a;t++)f.push(new A);r.push(new H(f))}r.push(new function(){return function(C){return Math.pow(1-C,l)}});c[l]=r}return r},b=function(l,r){for(var y=e(l.length-1),x=0,A=0,H=0;H<l.length;H++)x+=
l[H].x*y[H](r),A+=l[H].y*y[H](r);return{x:x,y:A}},g=function(l,r){return Math.sqrt(Math.pow(l.x-r.x,2)+Math.pow(l.y-r.y,2))},m=function(l,r,y){for(var x=b(l,r),A=0,H=0<y?1:-1,a=null;A<Math.abs(y);)r+=.005*H,a=b(l,r),A+=g(a,x),x=a;return{point:a,location:r}},p=function(l,r){var y=b(l,r);r=b(l.slice(0,l.length-1),r);l=r.y-y.y;y=r.x-y.x;return 0==l?Infinity:Math.atan(l/y)};ChemDoodle.lib.jsBezier={distanceFromCurve:k,gradientAtPoint:p,gradientAtPointAlongCurveFrom:function(l,r,y){r=m(l,r,y);1<r.location&&
(r.location=1);0>r.location&&(r.location=0);return p(l,r.location)},nearestPointOnCurve:function(l,r){l=k(l,r);return{point:d(r,r.length-1,l.location,null,null),location:l.location}},pointOnCurve:b,pointAlongCurveFrom:function(l,r,y){return m(l,r,y).point},perpendicularToCurveAt:function(l,r,y,x){r=m(l,r,null==x?0:x);l=p(l,r.location);x=Math.atan(-1/l);l=y/2*Math.sin(x);y=y/2*Math.cos(x);return[{x:r.point.x+y,y:r.point.y+l},{x:r.point.x-y,y:r.point.y-l}]},locationAlongCurveFrom:function(l,r,y){return m(l,
r,y).location},getLength:function(l){for(var r=b(l,0),y=0,x=0,A;1>x;)x+=.005,A=b(l,x),y+=g(A,r),r=A;return y}}})(ChemDoodle.lib);
ChemDoodle.lib.MarchingCubes=function(){var n=new Uint32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,
2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,
2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),E=[[],[0,8,3],[0,1,9],[1,8,3,9,8,1],[1,2,10],[0,8,3,1,2,10],[9,2,10,0,2,9],[2,8,3,2,10,8,10,9,8],[3,11,2],[0,11,2,8,11,0],[1,9,0,2,3,11],[1,11,2,1,9,11,9,8,11],[3,10,1,11,10,3],[0,10,1,0,8,10,8,11,10],[3,9,0,3,11,9,11,10,9],[9,8,10,10,
8,11],[4,7,8],[4,3,0,7,3,4],[0,1,9,8,4,7],[4,1,9,4,7,1,7,3,1],[1,2,10,8,4,7],[3,4,7,3,0,4,1,2,10],[9,2,10,9,0,2,8,4,7],[2,10,9,2,9,7,2,7,3,7,9,4],[8,4,7,3,11,2],[11,4,7,11,2,4,2,0,4],[9,0,1,8,4,7,2,3,11],[4,7,11,9,4,11,9,11,2,9,2,1],[3,10,1,3,11,10,7,8,4],[1,11,10,1,4,11,1,0,4,7,11,4],[4,7,8,9,0,11,9,11,10,11,0,3],[4,7,11,4,11,9,9,11,10],[9,5,4],[9,5,4,0,8,3],[0,5,4,1,5,0],[8,5,4,8,3,5,3,1,5],[1,2,10,9,5,4],[3,0,8,1,2,10,4,9,5],[5,2,10,5,4,2,4,0,2],[2,10,5,3,2,5,3,5,4,3,4,8],[9,5,4,2,3,11],[0,11,
2,0,8,11,4,9,5],[0,5,4,0,1,5,2,3,11],[2,1,5,2,5,8,2,8,11,4,8,5],[10,3,11,10,1,3,9,5,4],[4,9,5,0,8,1,8,10,1,8,11,10],[5,4,0,5,0,11,5,11,10,11,0,3],[5,4,8,5,8,10,10,8,11],[9,7,8,5,7,9],[9,3,0,9,5,3,5,7,3],[0,7,8,0,1,7,1,5,7],[1,5,3,3,5,7],[9,7,8,9,5,7,10,1,2],[10,1,2,9,5,0,5,3,0,5,7,3],[8,0,2,8,2,5,8,5,7,10,5,2],[2,10,5,2,5,3,3,5,7],[7,9,5,7,8,9,3,11,2],[9,5,7,9,7,2,9,2,0,2,7,11],[2,3,11,0,1,8,1,7,8,1,5,7],[11,2,1,11,1,7,7,1,5],[9,5,8,8,5,7,10,1,3,10,3,11],[5,7,0,5,0,9,7,11,0,1,0,10,11,10,0],[11,10,
0,11,0,3,10,5,0,8,0,7,5,7,0],[11,10,5,7,11,5],[10,6,5],[0,8,3,5,10,6],[9,0,1,5,10,6],[1,8,3,1,9,8,5,10,6],[1,6,5,2,6,1],[1,6,5,1,2,6,3,0,8],[9,6,5,9,0,6,0,2,6],[5,9,8,5,8,2,5,2,6,3,2,8],[2,3,11,10,6,5],[11,0,8,11,2,0,10,6,5],[0,1,9,2,3,11,5,10,6],[5,10,6,1,9,2,9,11,2,9,8,11],[6,3,11,6,5,3,5,1,3],[0,8,11,0,11,5,0,5,1,5,11,6],[3,11,6,0,3,6,0,6,5,0,5,9],[6,5,9,6,9,11,11,9,8],[5,10,6,4,7,8],[4,3,0,4,7,3,6,5,10],[1,9,0,5,10,6,8,4,7],[10,6,5,1,9,7,1,7,3,7,9,4],[6,1,2,6,5,1,4,7,8],[1,2,5,5,2,6,3,0,4,3,4,
7],[8,4,7,9,0,5,0,6,5,0,2,6],[7,3,9,7,9,4,3,2,9,5,9,6,2,6,9],[3,11,2,7,8,4,10,6,5],[5,10,6,4,7,2,4,2,0,2,7,11],[0,1,9,4,7,8,2,3,11,5,10,6],[9,2,1,9,11,2,9,4,11,7,11,4,5,10,6],[8,4,7,3,11,5,3,5,1,5,11,6],[5,1,11,5,11,6,1,0,11,7,11,4,0,4,11],[0,5,9,0,6,5,0,3,6,11,6,3,8,4,7],[6,5,9,6,9,11,4,7,9,7,11,9],[10,4,9,6,4,10],[4,10,6,4,9,10,0,8,3],[10,0,1,10,6,0,6,4,0],[8,3,1,8,1,6,8,6,4,6,1,10],[1,4,9,1,2,4,2,6,4],[3,0,8,1,2,9,2,4,9,2,6,4],[0,2,4,4,2,6],[8,3,2,8,2,4,4,2,6],[10,4,9,10,6,4,11,2,3],[0,8,2,2,8,
11,4,9,10,4,10,6],[3,11,2,0,1,6,0,6,4,6,1,10],[6,4,1,6,1,10,4,8,1,2,1,11,8,11,1],[9,6,4,9,3,6,9,1,3,11,6,3],[8,11,1,8,1,0,11,6,1,9,1,4,6,4,1],[3,11,6,3,6,0,0,6,4],[6,4,8,11,6,8],[7,10,6,7,8,10,8,9,10],[0,7,3,0,10,7,0,9,10,6,7,10],[10,6,7,1,10,7,1,7,8,1,8,0],[10,6,7,10,7,1,1,7,3],[1,2,6,1,6,8,1,8,9,8,6,7],[2,6,9,2,9,1,6,7,9,0,9,3,7,3,9],[7,8,0,7,0,6,6,0,2],[7,3,2,6,7,2],[2,3,11,10,6,8,10,8,9,8,6,7],[2,0,7,2,7,11,0,9,7,6,7,10,9,10,7],[1,8,0,1,7,8,1,10,7,6,7,10,2,3,11],[11,2,1,11,1,7,10,6,1,6,7,1],[8,
9,6,8,6,7,9,1,6,11,6,3,1,3,6],[0,9,1,11,6,7],[7,8,0,7,0,6,3,11,0,11,6,0],[7,11,6],[7,6,11],[3,0,8,11,7,6],[0,1,9,11,7,6],[8,1,9,8,3,1,11,7,6],[10,1,2,6,11,7],[1,2,10,3,0,8,6,11,7],[2,9,0,2,10,9,6,11,7],[6,11,7,2,10,3,10,8,3,10,9,8],[7,2,3,6,2,7],[7,0,8,7,6,0,6,2,0],[2,7,6,2,3,7,0,1,9],[1,6,2,1,8,6,1,9,8,8,7,6],[10,7,6,10,1,7,1,3,7],[10,7,6,1,7,10,1,8,7,1,0,8],[0,3,7,0,7,10,0,10,9,6,10,7],[7,6,10,7,10,8,8,10,9],[6,8,4,11,8,6],[3,6,11,3,0,6,0,4,6],[8,6,11,8,4,6,9,0,1],[9,4,6,9,6,3,9,3,1,11,3,6],[6,
8,4,6,11,8,2,10,1],[1,2,10,3,0,11,0,6,11,0,4,6],[4,11,8,4,6,11,0,2,9,2,10,9],[10,9,3,10,3,2,9,4,3,11,3,6,4,6,3],[8,2,3,8,4,2,4,6,2],[0,4,2,4,6,2],[1,9,0,2,3,4,2,4,6,4,3,8],[1,9,4,1,4,2,2,4,6],[8,1,3,8,6,1,8,4,6,6,10,1],[10,1,0,10,0,6,6,0,4],[4,6,3,4,3,8,6,10,3,0,3,9,10,9,3],[10,9,4,6,10,4],[4,9,5,7,6,11],[0,8,3,4,9,5,11,7,6],[5,0,1,5,4,0,7,6,11],[11,7,6,8,3,4,3,5,4,3,1,5],[9,5,4,10,1,2,7,6,11],[6,11,7,1,2,10,0,8,3,4,9,5],[7,6,11,5,4,10,4,2,10,4,0,2],[3,4,8,3,5,4,3,2,5,10,5,2,11,7,6],[7,2,3,7,6,2,
5,4,9],[9,5,4,0,8,6,0,6,2,6,8,7],[3,6,2,3,7,6,1,5,0,5,4,0],[6,2,8,6,8,7,2,1,8,4,8,5,1,5,8],[9,5,4,10,1,6,1,7,6,1,3,7],[1,6,10,1,7,6,1,0,7,8,7,0,9,5,4],[4,0,10,4,10,5,0,3,10,6,10,7,3,7,10],[7,6,10,7,10,8,5,4,10,4,8,10],[6,9,5,6,11,9,11,8,9],[3,6,11,0,6,3,0,5,6,0,9,5],[0,11,8,0,5,11,0,1,5,5,6,11],[6,11,3,6,3,5,5,3,1],[1,2,10,9,5,11,9,11,8,11,5,6],[0,11,3,0,6,11,0,9,6,5,6,9,1,2,10],[11,8,5,11,5,6,8,0,5,10,5,2,0,2,5],[6,11,3,6,3,5,2,10,3,10,5,3],[5,8,9,5,2,8,5,6,2,3,8,2],[9,5,6,9,6,0,0,6,2],[1,5,8,1,
8,0,5,6,8,3,8,2,6,2,8],[1,5,6,2,1,6],[1,3,6,1,6,10,3,8,6,5,6,9,8,9,6],[10,1,0,10,0,6,9,5,0,5,6,0],[0,3,8,5,6,10],[10,5,6],[11,5,10,7,5,11],[11,5,10,11,7,5,8,3,0],[5,11,7,5,10,11,1,9,0],[10,7,5,10,11,7,9,8,1,8,3,1],[11,1,2,11,7,1,7,5,1],[0,8,3,1,2,7,1,7,5,7,2,11],[9,7,5,9,2,7,9,0,2,2,11,7],[7,5,2,7,2,11,5,9,2,3,2,8,9,8,2],[2,5,10,2,3,5,3,7,5],[8,2,0,8,5,2,8,7,5,10,2,5],[9,0,1,5,10,3,5,3,7,3,10,2],[9,8,2,9,2,1,8,7,2,10,2,5,7,5,2],[1,3,5,3,7,5],[0,8,7,0,7,1,1,7,5],[9,0,3,9,3,5,5,3,7],[9,8,7,5,9,7],[5,
8,4,5,10,8,10,11,8],[5,0,4,5,11,0,5,10,11,11,3,0],[0,1,9,8,4,10,8,10,11,10,4,5],[10,11,4,10,4,5,11,3,4,9,4,1,3,1,4],[2,5,1,2,8,5,2,11,8,4,5,8],[0,4,11,0,11,3,4,5,11,2,11,1,5,1,11],[0,2,5,0,5,9,2,11,5,4,5,8,11,8,5],[9,4,5,2,11,3],[2,5,10,3,5,2,3,4,5,3,8,4],[5,10,2,5,2,4,4,2,0],[3,10,2,3,5,10,3,8,5,4,5,8,0,1,9],[5,10,2,5,2,4,1,9,2,9,4,2],[8,4,5,8,5,3,3,5,1],[0,4,5,1,0,5],[8,4,5,8,5,3,9,0,5,0,3,5],[9,4,5],[4,11,7,4,9,11,9,10,11],[0,8,3,4,9,7,9,11,7,9,10,11],[1,10,11,1,11,4,1,4,0,7,4,11],[3,1,4,3,4,8,
1,10,4,7,4,11,10,11,4],[4,11,7,9,11,4,9,2,11,9,1,2],[9,7,4,9,11,7,9,1,11,2,11,1,0,8,3],[11,7,4,11,4,2,2,4,0],[11,7,4,11,4,2,8,3,4,3,2,4],[2,9,10,2,7,9,2,3,7,7,4,9],[9,10,7,9,7,4,10,2,7,8,7,0,2,0,7],[3,7,10,3,10,2,7,4,10,1,10,0,4,0,10],[1,10,2,8,7,4],[4,9,1,4,1,7,7,1,3],[4,9,1,4,1,7,0,8,1,8,7,1],[4,0,3,7,4,3],[4,8,7],[9,10,8,10,11,8],[3,0,9,3,9,11,11,9,10],[0,1,10,0,10,8,8,10,11],[3,1,10,11,3,10],[1,2,11,1,11,9,9,11,8],[3,0,9,3,9,11,1,2,9,2,11,9],[0,2,11,8,0,11],[3,2,11],[2,3,8,2,8,10,10,8,9],[9,10,
2,0,9,2],[2,3,8,2,8,10,0,1,8,1,10,8],[1,10,2],[1,3,8,9,1,8],[0,9,1],[0,3,8],[]],w=[[0,0,0],[1,0,0],[1,1,0],[0,1,0],[0,0,1],[1,0,1],[1,1,1],[0,1,1]],v=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]];return function(k,q){var d=[],c=[],e=0,b=new Float32Array(8),g=new Int32Array(12),m=new Int32Array(3);for(m[2]=0;m[2]<q[2]-1;++m[2],e+=q[0])for(m[1]=0;m[1]<q[1]-1;++m[1],++e)for(m[0]=0;m[0]<q[0]-1;++m[0],++e){for(var p=0,l=0;8>l;++l){var r=w[l];r=k[e+r[0]+q[0]*(r[1]+q[1]*r[2])];
b[l]=r;p|=0<r?1<<l:0}r=n[p];if(0!==r){for(l=0;12>l;++l)if(0!==(r&1<<l)){g[l]=d.length;var y=[0,0,0],x=v[l],A=w[x[0]],H=w[x[1]],a=b[x[0]],f=a-b[x[1]];x=0;1E-6<Math.abs(f)&&(x=a/f);for(a=0;3>a;++a)y[a]=m[a]+A[a]+x*(H[a]-A[a]);d.push(y)}p=E[p];for(l=0;l<p.length;l+=3)c.push([g[p[l]],g[p[l+1]],g[p[l+2]]])}}return{vertices:d,faces:c}}}();
ChemDoodle.animations=function(n,E){E={};n.requestAnimFrame=function(){return n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(w,v){n.setTimeout(w,1E3/60)}}();E.requestInterval=function(w,v){function k(){(new Date).getTime()-q>=v&&(w.call(),q=(new Date).getTime());d.value=n.requestAnimFrame(k)}if(!(n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame&&n.mozCancelRequestAnimationFrame||
n.oRequestAnimationFrame||n.msRequestAnimationFrame))return n.setInterval(w,v);var q=(new Date).getTime(),d={};d.value=n.requestAnimFrame(k);return d};E.clearRequestInterval=function(w){n.cancelAnimationFrame?n.cancelAnimationFrame(w.value):n.webkitCancelAnimationFrame?n.webkitCancelAnimationFrame(w.value):n.webkitCancelRequestAnimationFrame?n.webkitCancelRequestAnimationFrame(w.value):n.mozCancelRequestAnimationFrame?n.mozCancelRequestAnimationFrame(w.value):n.oCancelRequestAnimationFrame?n.oCancelRequestAnimationFrame(w.value):
n.msCancelRequestAnimationFrame?n.msCancelRequestAnimationFrame(w.value):clearInterval(w)};E.requestTimeout=function(w,v){function k(){(new Date).getTime()-q>=v?w.call():d.value=n.requestAnimFrame(k)}if(!(n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame&&n.mozCancelRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame))return n.setTimeout(w,v);var q=(new Date).getTime(),d={};d.value=n.requestAnimFrame(k);return d};E.clearRequestTimeout=function(w){n.cancelAnimationFrame?
n.cancelAnimationFrame(w.value):n.webkitCancelAnimationFrame?n.webkitCancelAnimationFrame(w.value):n.webkitCancelRequestAnimationFrame?n.webkitCancelRequestAnimationFrame(w.value):n.mozCancelRequestAnimationFrame?n.mozCancelRequestAnimationFrame(w.value):n.oCancelRequestAnimationFrame?n.oCancelRequestAnimationFrame(w.value):n.msCancelRequestAnimationFrame?n.msCancelRequestAnimationFrame(w.value):clearTimeout(w)};return E}(window);
ChemDoodle.extensions=function(n,E,w,v){return{vec3AngleFrom:function(k,q){var d=E.length(k),c=E.length(q);k=E.dot(k,q);return w.acos(k/d/c)},contextRoundRect:function(k,q,d,c,e,b){k.beginPath();k.moveTo(q+b,d);k.lineTo(q+c-b,d);k.quadraticCurveTo(q+c,d,q+c,d+b);k.lineTo(q+c,d+e-b);k.quadraticCurveTo(q+c,d+e,q+c-b,d+e);k.lineTo(q+b,d+e);k.quadraticCurveTo(q,d+e,q,d+e-b);k.lineTo(q,d+b);k.quadraticCurveTo(q,d,q+b,d);k.closePath()},contextEllipse:function(k,q,d,c,e){var b=c/2*.5522848,g=e/2*.5522848,
m=q+c,p=d+e;c=q+c/2;e=d+e/2;k.beginPath();k.moveTo(q,e);k.bezierCurveTo(q,e-g,c-b,d,c,d);k.bezierCurveTo(c+b,d,m,e-g,m,e);k.bezierCurveTo(m,e+g,c+b,p,c,p);k.bezierCurveTo(c-b,p,q,e+g,q,e);k.closePath()},getFontString:function(k,q,d,c){var e=[];d&&e.push("bold ");c&&e.push("italic ");e.push(k+"px ");k=0;for(d=q.length;k<d;k++)c=q[k],-1!==c.indexOf(" ")&&(c='"'+c+'"'),e.push((0!==k?",":"")+c);return e.join("")}}}(ChemDoodle.structures,ChemDoodle.lib.vec3,Math);
(function(n,E,w){E.sign||(E.sign=function(v){return(0<v)-(0>v)||+v});"function"!=typeof n.assign&&(n.assign=function(v,k){if(null==v)throw new TypeError("Cannot convert undefined or null to object");for(var q=n(v),d=1;d<arguments.length;d++){var c=arguments[d];if(null!=c)for(var e in c)n.prototype.hasOwnProperty.call(c,e)&&(q[e]=c[e])}return q});String.prototype.startsWith||(String.prototype.startsWith=function(v,k){return this.substr(k||0,v.length)===v})})(Object,Math);
ChemDoodle.math=function(n,E,w,v,k){var q={},d={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",
darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",
gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",
lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",
oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",
skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};q.angleBetweenLargest=function(c){if(0===c.length)return{angle:0,largest:2*v.PI};if(1===c.length)return{angle:c[0]+v.PI,largest:2*v.PI};for(var e=0,b=0,g=0,m=c.length-1;g<m;g++){var p=c[g+1]-c[g];
p>e&&(e=p,b=(c[g+1]+c[g])/2)}g=c[0]+2*v.PI-c[c.length-1];g>e&&(b=c[0]-g/2,e=g,0>b&&(b+=2*v.PI));return{angle:b,largest:e}};q.isBetween=function(c,e,b){if(e>b){var g=e;e=b;b=g}return c>=e&&c<=b};q.getRGB=function(c,e){var b=[0,0,0];d[c.toLowerCase()]&&(c=d[c.toLowerCase()]);return"#"===c.charAt(0)?(4===c.length&&(c="#"+c.charAt(1)+c.charAt(1)+c.charAt(2)+c.charAt(2)+c.charAt(3)+c.charAt(3)),[parseInt(c.substring(1,3),16)/255*e,parseInt(c.substring(3,5),16)/255*e,parseInt(c.substring(5,7),16)/255*e]):
c.startsWith("rgba")?(c=c.replace(/rgba\(|\)/g,"").split(","),4!==c.length?b:[parseInt(c[0])/255*e,parseInt(c[1])/255*e,parseInt(c[2])/255*e,parseInt(c[3])/255*e]):c.startsWith("rgb")?(c=c.replace(/rgb\(|\)/g,"").split(","),3!==c.length?b:[parseInt(c[0])/255*e,parseInt(c[1])/255*e,parseInt(c[2])/255*e]):b};q.hsl2rgb=function(c,e,b){var g=function(l,r,y){0>y?y+=1:1<y&&--y;return y<1/6?l+6*(r-l)*y:.5>y?r:y<2/3?l+(r-l)*(2/3-y)*6:l};if(0===e)b=e=c=b;else{var m=.5>b?b*(1+e):b+e-b*e,p=2*b-m;b=g(p,m,c+1/
3);e=g(p,m,c);c=g(p,m,c-1/3)}return[255*b,255*e,255*c]};q.idx2color=function(c){c=c.toString(16);for(var e=0,b=6-c.length;e<b;e++)c="0"+c;return"#"+c};q.distanceFromPointToLineInclusive=function(c,e,b,g){var m=e.distance(b);b=e.angle(b);b=v.PI/2-b;b=e.angle(c)+b;c=e.distance(c);c=new E.Point(c*v.cos(b),-c*v.sin(b));g=g?g:0;return q.isBetween(-c.y,g,m-g)?v.abs(c.x):-1};q.calculateDistanceInterior=function(c,e,b){if(this.isBetween(e.x,b.x,b.x+b.w)&&this.isBetween(e.y,b.y,b.y+b.h))return c.distance(e);
var g=[];g.push({x1:b.x,y1:b.y,x2:b.x+b.w,y2:b.y});g.push({x1:b.x,y1:b.y+b.h,x2:b.x+b.w,y2:b.y+b.h});g.push({x1:b.x,y1:b.y,x2:b.x,y2:b.y+b.h});g.push({x1:b.x+b.w,y1:b.y,x2:b.x+b.w,y2:b.y+b.h});b=[];for(var m=0;4>m;m++){var p=g[m];(p=this.intersectLines(e.x,e.y,c.x,c.y,p.x1,p.y1,p.x2,p.y2))&&b.push(p)}if(0===b.length)return 0;g=e=0;for(m=b.length;g<m;g++){var l=b[g];p=c.x-l.x;l=c.y-l.y;e=v.max(e,v.sqrt(p*p+l*l))}return e};q.intersectLines=function(c,e,b,g,m,p,l,r){b-=c;g-=e;l-=m;r-=p;var y=g*l-b*r;
if(0===y)return!1;l=(r*(c-m)-l*(e-p))/y;m=(g*(c-m)-b*(e-p))/y;return 0<=m&&1>=m&&0<=l&&1>=l?{x:c+l*b,y:e+l*g}:!1};q.clamp=function(c,e,b){return c<e?e:c>b?b:c};q.rainbowAt=function(c,e,b){1>b.length?b.push("#000000","#FFFFFF"):2>b.length&&b.push("#FFFFFF");var g=e/(b.length-1);e=v.floor(c/g);c=(c-e*g)/g;g=q.getRGB(b[e],1);b=q.getRGB(b[e+1],1);return"rgb("+[255*(g[0]+(b[0]-g[0])*c),255*(g[1]+(b[1]-g[1])*c),255*(g[2]+(b[2]-g[2])*c)].join()+")"};q.angleBounds=function(c,e,b){for(var g=2*v.PI;0>c;)c+=
g;for(;c>g;)c-=g;b&&c>v.PI&&(c=2*v.PI-c);e&&(c=180*c/v.PI);return c};q.isPointInPoly=function(c,e){for(var b=!1,g=-1,m=c.length,p=m-1;++g<m;p=g)(c[g].y<=e.y&&e.y<c[p].y||c[p].y<=e.y&&e.y<c[g].y)&&e.x<(c[p].x-c[g].x)*(e.y-c[g].y)/(c[p].y-c[g].y)+c[g].x&&(b=!b);return b};return q}(ChemDoodle,ChemDoodle.structures,ChemDoodle.lib.jQuery,Math);
(function(n,E,w){n.Bounds=function(){};var v=n.Bounds.prototype;v.minX=v.minY=v.minZ=Infinity;v.maxX=v.maxY=v.maxZ=-Infinity;v.expand=function(k,q,d,c){k instanceof n.Bounds?(this.minX=E.min(this.minX,k.minX),this.minY=E.min(this.minY,k.minY),this.maxX=E.max(this.maxX,k.maxX),this.maxY=E.max(this.maxY,k.maxY),Infinity!==k.maxZ&&(this.minZ=E.min(this.minZ,k.minZ),this.maxZ=E.max(this.maxZ,k.maxZ))):(this.minX=E.min(this.minX,k),this.maxX=E.max(this.maxX,k),this.minY=E.min(this.minY,q),this.maxY=E.max(this.maxY,
q),d!==w&&c!==w&&(this.minX=E.min(this.minX,d),this.maxX=E.max(this.maxX,d),this.minY=E.min(this.minY,c),this.maxY=E.max(this.maxY,c)))};v.expand3D=function(k,q,d,c,e,b){this.minX=E.min(this.minX,k);this.maxX=E.max(this.maxX,k);this.minY=E.min(this.minY,q);this.maxY=E.max(this.maxY,q);this.minZ=E.min(this.minZ,d);this.maxZ=E.max(this.maxZ,d);c!==w&&e!==w&&b!==w&&(this.minX=E.min(this.minX,c),this.maxX=E.max(this.maxX,c),this.minY=E.min(this.minY,e),this.maxY=E.max(this.maxY,e),this.minZ=E.min(this.minZ,
b),this.maxZ=E.max(this.maxZ,b))}})(ChemDoodle.math,Math);
ChemDoodle.featureDetection=function(n,E,w,v,k){var q={supports_canvas:function(){return!!w.createElement("canvas").getContext},supports_canvas_text:function(){return q.supports_canvas()?"function"===typeof w.createElement("canvas").getContext("2d").fillText:!1},supports_webgl:function(){var d=w.createElement("canvas");try{if(d.getContext("webgl")||d.getContext("experimental-webgl"))return!0}catch(c){}return!1},supports_xhr2:function(){return E.support.cors},supports_touch:function(){var d=(/iPhone|iPad|iPod|Android|BlackBerry|BB10/i.test(navigator.userAgent)||
"MacIntel"===navigator.platform&&1<navigator.maxTouchPoints)&&!v.MSStream;return"ontouchstart"in v&&d},supports_gesture:function(){return"ongesturestart"in v}};return q}(ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery,document,window);ChemDoodle.SYMBOLS="H He Li Be B C N O F Ne Na Mg Al Si P S Cl Ar K Ca Sc Ti V Cr Mn Fe Co Ni Cu Zn Ga Ge As Se Br Kr Rb Sr Y Zr Nb Mo Tc Ru Rh Pd Ag Cd In Sn Sb Te I Xe Cs Ba La Ce Pr Nd Pm Sm Eu Gd Tb Dy Ho Er Tm Yb Lu Hf Ta W Re Os Ir Pt Au Hg Tl Pb Bi Po At Rn Fr Ra Ac Th Pa U Np Pu Am Cm Bk Cf Es Fm Md No Lr Rf Db Sg Bh Hs Mt Ds Rg Cn Nh Fl Mc Lv Ts Og".split(" ");
ChemDoodle.ELEMENT=function(n,E){function w(v,k,q,d,c,e,b,g,m){this.symbol=v;this.name=k;this.atomicNumber=q;this.addH=d;this.jmolColor=this.pymolColor=c;this.covalentRadius=e;this.vdWRadius=b;this.valency=g;this.mass=m}n=[];n.H=new w("H","Hydrogen",1,!1,"#FFFFFF",.31,1.1,1,1);n.He=new w("He","Helium",2,!1,"#D9FFFF",.28,1.4,0,4);n.Li=new w("Li","Lithium",3,!1,"#CC80FF",1.28,1.82,1,7);n.Be=new w("Be","Beryllium",4,!1,"#C2FF00",.96,1.53,2,9);n.B=new w("B","Boron",5,!0,"#FFB5B5",.84,1.92,3,11);n.C=new w("C",
"Carbon",6,!0,"#909090",.76,1.7,4,12);n.N=new w("N","Nitrogen",7,!0,"#3050F8",.71,1.55,3,14);n.O=new w("O","Oxygen",8,!0,"#FF0D0D",.66,1.52,2,16);n.F=new w("F","Fluorine",9,!0,"#90E050",.57,1.47,1,19);n.Ne=new w("Ne","Neon",10,!1,"#B3E3F5",.58,1.54,0,20);n.Na=new w("Na","Sodium",11,!1,"#AB5CF2",1.66,2.27,1,23);n.Mg=new w("Mg","Magnesium",12,!1,"#8AFF00",1.41,1.73,0,24);n.Al=new w("Al","Aluminum",13,!1,"#BFA6A6",1.21,1.84,0,27);n.Si=new w("Si","Silicon",14,!0,"#F0C8A0",1.11,2.1,4,28);n.P=new w("P",
"Phosphorus",15,!0,"#FF8000",1.07,1.8,3,31);n.S=new w("S","Sulfur",16,!0,"#FFFF30",1.05,1.8,2,32);n.Cl=new w("Cl","Chlorine",17,!0,"#1FF01F",1.02,1.75,1,35);n.Ar=new w("Ar","Argon",18,!1,"#80D1E3",1.06,1.88,0,40);n.K=new w("K","Potassium",19,!1,"#8F40D4",2.03,2.75,0,39);n.Ca=new w("Ca","Calcium",20,!1,"#3DFF00",1.76,2.31,0,40);n.Sc=new w("Sc","Scandium",21,!1,"#E6E6E6",1.7,0,0,45);n.Ti=new w("Ti","Titanium",22,!1,"#BFC2C7",1.6,0,1,48);n.V=new w("V","Vanadium",23,!1,"#A6A6AB",1.53,0,1,51);n.Cr=new w("Cr",
"Chromium",24,!1,"#8A99C7",1.39,0,2,52);n.Mn=new w("Mn","Manganese",25,!1,"#9C7AC7",1.39,0,3,55);n.Fe=new w("Fe","Iron",26,!1,"#E06633",1.32,0,2,56);n.Co=new w("Co","Cobalt",27,!1,"#F090A0",1.26,0,1,59);n.Ni=new w("Ni","Nickel",28,!1,"#50D050",1.24,1.63,1,58);n.Cu=new w("Cu","Copper",29,!1,"#C88033",1.32,1.4,0,63);n.Zn=new w("Zn","Zinc",30,!1,"#7D80B0",1.22,1.39,0,64);n.Ga=new w("Ga","Gallium",31,!1,"#C28F8F",1.22,1.87,0,69);n.Ge=new w("Ge","Germanium",32,!1,"#668F8F",1.2,2.11,4,74);n.As=new w("As",
"Arsenic",33,!0,"#BD80E3",1.19,1.85,3,75);n.Se=new w("Se","Selenium",34,!0,"#FFA100",1.2,1.9,2,80);n.Br=new w("Br","Bromine",35,!0,"#A62929",1.2,1.85,1,79);n.Kr=new w("Kr","Krypton",36,!1,"#5CB8D1",1.16,2.02,0,84);n.Rb=new w("Rb","Rubidium",37,!1,"#702EB0",2.2,3.03,0,85);n.Sr=new w("Sr","Strontium",38,!1,"#00FF00",1.95,2.49,0,88);n.Y=new w("Y","Yttrium",39,!1,"#94FFFF",1.9,0,0,89);n.Zr=new w("Zr","Zirconium",40,!1,"#94E0E0",1.75,0,0,90);n.Nb=new w("Nb","Niobium",41,!1,"#73C2C9",1.64,0,1,93);n.Mo=
new w("Mo","Molybdenum",42,!1,"#54B5B5",1.54,0,2,98);n.Tc=new w("Tc","Technetium",43,!1,"#3B9E9E",1.47,0,3,0);n.Ru=new w("Ru","Ruthenium",44,!1,"#248F8F",1.46,0,2,102);n.Rh=new w("Rh","Rhodium",45,!1,"#0A7D8C",1.42,0,1,103);n.Pd=new w("Pd","Palladium",46,!1,"#006985",1.39,1.63,0,106);n.Ag=new w("Ag","Silver",47,!1,"#C0C0C0",1.45,1.72,0,107);n.Cd=new w("Cd","Cadmium",48,!1,"#FFD98F",1.44,1.58,0,114);n.In=new w("In","Indium",49,!1,"#A67573",1.42,1.93,0,115);n.Sn=new w("Sn","Tin",50,!1,"#668080",1.39,
2.17,4,120);n.Sb=new w("Sb","Antimony",51,!1,"#9E63B5",1.39,2.06,3,121);n.Te=new w("Te","Tellurium",52,!0,"#D47A00",1.38,2.06,2,130);n.I=new w("I","Iodine",53,!0,"#940094",1.39,1.98,1,127);n.Xe=new w("Xe","Xenon",54,!1,"#429EB0",1.4,2.16,0,132);n.Cs=new w("Cs","Cesium",55,!1,"#57178F",2.44,3.43,0,133);n.Ba=new w("Ba","Barium",56,!1,"#00C900",2.15,2.68,0,138);n.La=new w("La","Lanthanum",57,!1,"#70D4FF",2.07,0,0,139);n.Ce=new w("Ce","Cerium",58,!1,"#FFFFC7",2.04,0,0,140);n.Pr=new w("Pr","Praseodymium",
59,!1,"#D9FFC7",2.03,0,0,141);n.Nd=new w("Nd","Neodymium",60,!1,"#C7FFC7",2.01,0,0,142);n.Pm=new w("Pm","Promethium",61,!1,"#A3FFC7",1.99,0,0,0);n.Sm=new w("Sm","Samarium",62,!1,"#8FFFC7",1.98,0,0,152);n.Eu=new w("Eu","Europium",63,!1,"#61FFC7",1.98,0,0,153);n.Gd=new w("Gd","Gadolinium",64,!1,"#45FFC7",1.96,0,0,158);n.Tb=new w("Tb","Terbium",65,!1,"#30FFC7",1.94,0,0,159);n.Dy=new w("Dy","Dysprosium",66,!1,"#1FFFC7",1.92,0,0,164);n.Ho=new w("Ho","Holmium",67,!1,"#00FF9C",1.92,0,0,165);n.Er=new w("Er",
"Erbium",68,!1,"#00E675",1.89,0,0,166);n.Tm=new w("Tm","Thulium",69,!1,"#00D452",1.9,0,0,169);n.Yb=new w("Yb","Ytterbium",70,!1,"#00BF38",1.87,0,0,174);n.Lu=new w("Lu","Lutetium",71,!1,"#00AB24",1.87,0,0,175);n.Hf=new w("Hf","Hafnium",72,!1,"#4DC2FF",1.75,0,0,180);n.Ta=new w("Ta","Tantalum",73,!1,"#4DA6FF",1.7,0,1,181);n.W=new w("W","Tungsten",74,!1,"#2194D6",1.62,0,2,184);n.Re=new w("Re","Rhenium",75,!1,"#267DAB",1.51,0,3,187);n.Os=new w("Os","Osmium",76,!1,"#266696",1.44,0,2,192);n.Ir=new w("Ir",
"Iridium",77,!1,"#175487",1.41,0,3,193);n.Pt=new w("Pt","Platinum",78,!1,"#D0D0E0",1.36,1.75,0,195);n.Au=new w("Au","Gold",79,!1,"#FFD123",1.36,1.66,1,197);n.Hg=new w("Hg","Mercury",80,!1,"#B8B8D0",1.32,1.55,0,202);n.Tl=new w("Tl","Thallium",81,!1,"#A6544D",1.45,1.96,0,205);n.Pb=new w("Pb","Lead",82,!1,"#575961",1.46,2.02,4,208);n.Bi=new w("Bi","Bismuth",83,!1,"#9E4FB5",1.48,2.07,3,209);n.Po=new w("Po","Polonium",84,!1,"#AB5C00",1.4,1.97,2,0);n.At=new w("At","Astatine",85,!0,"#754F45",1.5,2.02,1,
0);n.Rn=new w("Rn","Radon",86,!1,"#428296",1.5,2.2,0,0);n.Fr=new w("Fr","Francium",87,!1,"#420066",2.6,3.48,0,0);n.Ra=new w("Ra","Radium",88,!1,"#007D00",2.21,2.83,0,0);n.Ac=new w("Ac","Actinium",89,!1,"#70ABFA",2.15,0,0,0);n.Th=new w("Th","Thorium",90,!1,"#00BAFF",2.06,0,0,232);n.Pa=new w("Pa","Protactinium",91,!1,"#00A1FF",2,0,0,231);n.U=new w("U","Uranium",92,!1,"#008FFF",1.96,1.86,0,238);n.Np=new w("Np","Neptunium",93,!1,"#0080FF",1.9,0,0,0);n.Pu=new w("Pu","Plutonium",94,!1,"#006BFF",1.87,0,
0,0);n.Am=new w("Am","Americium",95,!1,"#545CF2",1.8,0,0,0);n.Cm=new w("Cm","Curium",96,!1,"#785CE3",1.69,0,0,0);n.Bk=new w("Bk","Berkelium",97,!1,"#8A4FE3",0,0,0,0);n.Cf=new w("Cf","Californium",98,!1,"#A136D4",0,0,0,0);n.Es=new w("Es","Einsteinium",99,!1,"#B31FD4",0,0,0,0);n.Fm=new w("Fm","Fermium",100,!1,"#B31FBA",0,0,0,0);n.Md=new w("Md","Mendelevium",101,!1,"#B30DA6",0,0,0,0);n.No=new w("No","Nobelium",102,!1,"#BD0D87",0,0,0,0);n.Lr=new w("Lr","Lawrencium",103,!1,"#C70066",0,0,0,0);n.Rf=new w("Rf",
"Rutherfordium",104,!1,"#CC0059",0,0,0,0);n.Db=new w("Db","Dubnium",105,!1,"#D1004F",0,0,0,0);n.Sg=new w("Sg","Seaborgium",106,!1,"#D90045",0,0,0,0);n.Bh=new w("Bh","Bohrium",107,!1,"#E00038",0,0,0,0);n.Hs=new w("Hs","Hassium",108,!1,"#E6002E",0,0,0,0);n.Mt=new w("Mt","Meitnerium",109,!1,"#EB0026",0,0,0,0);n.Ds=new w("Ds","Darmstadtium",110,!1,"#000000",0,0,0,0);n.Rg=new w("Rg","Roentgenium",111,!1,"#000000",0,0,0,0);n.Cn=new w("Cn","Copernicium",112,!1,"#000000",0,0,0,0);n.Nh=new w("Nh","Nihonium",
113,!1,"#000000",0,0,0,0);n.Fl=new w("Fl","Flerovium",114,!1,"#000000",0,0,0,0);n.Mc=new w("Mc","Moscovium",115,!1,"#000000",0,0,0,0);n.Lv=new w("Lv","Livermorium",116,!1,"#000000",0,0,0,0);n.Ts=new w("Ts","Tennessine",117,!1,"#000000",0,0,0,0);n.Og=new w("Og","Oganesson",118,!1,"#000000",0,0,0,0);n.H.pymolColor="#E6E6E6";n.C.pymolColor="#33FF33";n.N.pymolColor="#3333FF";n.O.pymolColor="#FF4D4D";n.F.pymolColor="#B3FFFF";n.S.pymolColor="#E6C640";return n}(ChemDoodle.SYMBOLS);
ChemDoodle.RESIDUE=function(n){function E(w,v,k,q,d,c){this.symbol=w;this.name=v;this.polar=k;this.aminoColor=q;this.shapelyColor=d;this.acidity=c}n=[];n.Ala=new E("Ala","Alanine",!1,"#C8C8C8","#8CFF8C",0);n.Arg=new E("Arg","Arginine",!0,"#145AFF","#00007C",1);n.Asn=new E("Asn","Asparagine",!0,"#00DCDC","#FF7C70",0);n.Asp=new E("Asp","Aspartic Acid",!0,"#E60A0A","#A00042",-1);n.Cys=new E("Cys","Cysteine",!0,"#E6E600","#FFFF70",0);n.Gln=new E("Gln","Glutamine",!0,"#00DCDC","#FF4C4C",0);n.Glu=new E("Glu",
"Glutamic Acid",!0,"#E60A0A","#660000",-1);n.Gly=new E("Gly","Glycine",!1,"#EBEBEB","#FFFFFF",0);n.His=new E("His","Histidine",!0,"#8282D2","#7070FF",1);n.Ile=new E("Ile","Isoleucine",!1,"#0F820F","#004C00",0);n.Leu=new E("Leu","Leucine",!1,"#0F820F","#455E45",0);n.Lys=new E("Lys","Lysine",!0,"#145AFF","#4747B8",1);n.Met=new E("Met","Methionine",!1,"#E6E600","#B8A042",0);n.Phe=new E("Phe","Phenylalanine",!1,"#3232AA","#534C52",0);n.Pro=new E("Pro","Proline",!1,"#DC9682","#525252",0);n.Ser=new E("Ser",
"Serine",!0,"#FA9600","#FF7042",0);n.Thr=new E("Thr","Threonine",!0,"#FA9600","#B84C00",0);n.Trp=new E("Trp","Tryptophan",!0,"#B45AB4","#4F4600",0);n.Tyr=new E("Tyr","Tyrosine",!0,"#3232AA","#8C704C",0);n.Val=new E("Val","Valine",!1,"#0F820F","#FF8CFF",0);n.Asx=new E("Asx","Asparagine/Aspartic Acid",!0,"#FF69B4","#FF00FF",0);n.Glx=new E("Glx","Glutamine/Glutamic Acid",!0,"#FF69B4","#FF00FF",0);n["*"]=new E("*","Other",!1,"#BEA06E","#FF00FF",0);n.A=new E("A","Adenine",!1,"#BEA06E","#A0A0FF",0);n.G=
new E("G","Guanine",!1,"#BEA06E","#FF7070",0);n.I=new E("I","",!1,"#BEA06E","#80FFFF",0);n.C=new E("C","Cytosine",!1,"#BEA06E","#FF8C4B",0);n.T=new E("T","Thymine",!1,"#BEA06E","#A0FFA0",0);n.U=new E("U","Uracil",!1,"#BEA06E","#FF8080",0);return n}();
(function(n,E){n.Queue=function(){this.queue=[]};n=n.Queue.prototype;n.queueSpace=0;n.getSize=function(){return this.queue.length-this.queueSpace};n.isEmpty=function(){return 0===this.queue.length};n.enqueue=function(w){this.queue.push(w)};n.dequeue=function(){if(this.queue.length){var w=this.queue[this.queueSpace];2*++this.queueSpace>=this.queue.length&&(this.queue=this.queue.slice(this.queueSpace),this.queueSpace=0)}return w};n.getOldestElement=function(){var w;this.queue.length&&(w=this.queue[this.queueSpace]);
return w}})(ChemDoodle.structures);
(function(n,E,w){n.Point=function(v,k){this.x=v?v:0;this.y=k?k:0};n=n.Point.prototype;n.sub=function(v){this.x-=v.x;this.y-=v.y};n.add=function(v){this.x+=v.x;this.y+=v.y};n.distance=function(v){var k=v.x-this.x;v=v.y-this.y;return E.sqrt(k*k+v*v)};n.angleForStupidCanvasArcs=function(v){var k=v.x-this.x;v=v.y-this.y;for(k=0===k?0===v?0:0<v?E.PI/2:3*E.PI/2:0===v?0<k?0:E.PI:0>k?E.atan(v/k)+E.PI:0>v?E.atan(v/k)+2*E.PI:E.atan(v/k);0>k;)k+=2*E.PI;return k%=2*E.PI};n.angle=function(v){var k=v.x-this.x;
v=this.y-v.y;for(k=0===k?0===v?0:0<v?E.PI/2:3*E.PI/2:0===v?0<k?0:E.PI:0>k?E.atan(v/k)+E.PI:0>v?E.atan(v/k)+2*E.PI:E.atan(v/k);0>k;)k+=2*E.PI;return k%=2*E.PI}})(ChemDoodle.structures,Math);
(function(n,E,w,v){var k=/[ ,]+/,q=/\-+/,d=["Helvetica","Arial","Dialog"];E.Query=function(c){this.type=c;this.elements={v:[],not:!1};this.saturation=this.hydrogens=this.connectivityNoH=this.connectivity=this.chirality=this.charge=v;this.orders={v:[],not:!1};this.cache=this.ringCount=this.aromatic=this.stereo=v};E.Query.TYPE_ATOM=0;E.Query.TYPE_BOND=1;w=E.Query.prototype;w.parseRange=function(c){var e=[];c=c.split(k);for(var b=0,g=c.length;b<g;b++){var m=c[b],p=!1,l=!1;"-"===m.charAt(0)&&(p=!0,m=
m.substring(1));-1!=m.indexOf("--")&&(l=!0);-1!=m.indexOf("-")?(m=m.split(q),p={x:parseInt(m[0])*(p?-1:1),y:parseInt(m[1])*(l?-1:1)},p.y<p.x&&(l=p.y,p.y=p.x,p.x=l),e.push(p)):e.push({x:parseInt(m)*(p?-1:1)})}return e};w.draw=function(c,e,b){this.cache||(this.cache=this.toString());var g=this.cache,m=v,p=g.indexOf("(");-1!=p&&(g=this.cache.substring(0,p),m=this.cache.substring(p,this.cache.length));c.textAlign="center";c.textBaseline="middle";c.font=n.getFontString(12,d,!0,!1);p=c.measureText(g).width;
c.fillStyle=e.backgroundColor;c.fillRect(b.x-p/2,b.y-6,p,12);c.fillStyle="black";c.fillText(g,b.x,b.y);m&&(c.font=n.getFontString(10,d,!1,!0),p=c.measureText(m).width,c.fillStyle=e.backgroundColor,c.fillRect(b.x-p/2,b.y+6,p,11),c.fillStyle="black",c.fillText(m,b.x,b.y+11))};w.outputRange=function(c){for(var e=!1,b=[],g=0,m=c.length;g<m;g++){e&&b.push(",");e=!0;var p=c[g];p.y?(b.push(p.x),b.push("-"),b.push(p.y)):b.push(p.x)}return b.join("")};w.toString=function(){var c=[],e=[];this.type===E.Query.TYPE_ATOM?
(this.elements&&0!==this.elements.v.length?(this.elements.not&&c.push("!"),c.push("["),c.push(this.elements.v.join(",")),c.push("]")):c.push("[a]"),this.chirality&&e.push((this.chirality.not?"!":"")+"@="+this.chirality.v),this.aromatic&&e.push((this.aromatic.not?"!":"")+"A"),this.charge&&e.push((this.charge.not?"!":"")+"C="+this.outputRange(this.charge.v)),this.hydrogens&&e.push((this.hydrogens.not?"!":"")+"H="+this.outputRange(this.hydrogens.v)),this.ringCount&&e.push((this.ringCount.not?"!":"")+
"R="+this.outputRange(this.ringCount.v)),this.saturation&&e.push((this.saturation.not?"!":"")+"S"),this.connectivity&&e.push((this.connectivity.not?"!":"")+"X="+this.outputRange(this.connectivity.v)),this.connectivityNoH&&e.push((this.connectivityNoH.not?"!":"")+"x="+this.outputRange(this.connectivityNoH.v))):this.type===E.Query.TYPE_BOND&&(this.orders&&0!==this.orders.v.length?(this.orders.not&&c.push("!"),c.push("["),c.push(this.orders.v.join(",")),c.push("]")):c.push("[a]"),this.stereo&&e.push((this.stereo.not?
"!":"")+"@="+this.stereo.v),this.aromatic&&e.push((this.aromatic.not?"!":"")+"A"),this.ringCount&&e.push((this.ringCount.not?"!":"")+"R="+this.outputRange(this.ringCount.v)));0<e.length&&(c.push("("),c.push(e.join(",")),c.push(")"));return c.join("")}})(ChemDoodle.extensions,ChemDoodle.structures,Math);
(function(n,E,w,v,k,q,d){var c=/\s+/g;v.Atom=function(b,g,m,p){this.label=b?b.trim():"C";this.x=g?g:0;this.y=m?m:0;this.z=p?p:0};var e=v.Atom.prototype=new v.Point(0,0);e.charge=0;e.numLonePair=0;e.numRadical=0;e.mass=-1;e.implicitH=-1;e.coordinationNumber=0;e.bondNumber=0;e.angleOfLeastInterference=0;e.isHidden=!1;e.altLabel=d;e.isLone=!1;e.isHover=!1;e.isSelected=!1;e.add3D=function(b){this.x+=b.x;this.y+=b.y;this.z+=b.z};e.sub3D=function(b){this.x-=b.x;this.y-=b.y;this.z-=b.z};e.distance3D=function(b){var g=
b.x-this.x,m=b.y-this.y;b=b.z-this.z;return k.sqrt(g*g+m*m+b*b)};e.draw=function(b,g){if(!this.dontDraw){if(this.isLassoed){var m=b.createRadialGradient(this.x-1,this.y-1,0,this.x,this.y,7);m.addColorStop(0,"rgba(212, 99, 0, 0)");m.addColorStop(.7,"rgba(212, 99, 0, 0.8)");b.fillStyle=m;b.beginPath();b.arc(this.x,this.y,5,0,2*k.PI,!1);b.fill()}if(!this.query){this.textBounds=[];this.styles&&(g=this.styles);var p=E.getFontString(g.atoms_font_size_2D,g.atoms_font_families_2D,g.atoms_font_bold_2D,g.atoms_font_italic_2D);
b.font=p;b.fillStyle=this.getElementColor(g.atoms_useJMOLColors,g.atoms_usePYMOLColors,g.atoms_color,2);"H"===this.label&&g.atoms_HBlack_2D&&(b.fillStyle="black");this.error&&(b.fillStyle=g.colorError);m=this.isLabelVisible(g);if(this.isLone&&!m||g.atoms_circles_2D)this.isLone&&(b.fillStyle="#909090"),b.beginPath(),b.arc(this.x,this.y,g.atoms_circleDiameter_2D/2,0,2*k.PI,!1),b.fill(),0<g.atoms_circleBorderWidth_2D&&(b.lineWidth=g.atoms_circleBorderWidth_2D,b.strokeStyle="black",b.stroke());else if(m)if(b.textAlign=
"center",b.textBaseline="middle",this.altLabel!==d)b.fillText(this.altLabel,this.x,this.y),m=b.measureText(this.altLabel).width,this.textBounds.push({x:this.x-m/2,y:this.y-g.atoms_font_size_2D/2+1,w:m,h:g.atoms_font_size_2D-2});else if(n[this.label]){b.fillText(this.label,this.x,this.y);var l=b.measureText(this.label).width;this.textBounds.push({x:this.x-l/2,y:this.y-g.atoms_font_size_2D/2+1,w:l,h:g.atoms_font_size_2D-2});var r=0;-1!==this.mass&&(m=b.font,b.font=E.getFontString(.7*g.atoms_font_size_2D,
g.atoms_font_families_2D,g.atoms_font_bold_2D,g.atoms_font_italic_2D),r=b.measureText(this.mass).width,b.fillText(this.mass,this.x-r-.5,this.y-g.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x-l/2-r-.5,y:this.y-1.7*g.atoms_font_size_2D/2+1,w:r,h:g.atoms_font_size_2D/2-1}),b.font=m);m=l/2;var y=this.getImplicitHydrogenCount();if(g.atoms_implicitHydrogens_2D&&0<y){var x=0;var A=b.measureText("H").width,H=!0;if(1<y){var a=l/2+A/2,f=0,t=E.getFontString(.8*g.atoms_font_size_2D,g.atoms_font_families_2D,
g.atoms_font_bold_2D,g.atoms_font_italic_2D);b.font=t;var C=b.measureText(y).width;1===this.bondNumber?this.angleOfLeastInterference>k.PI/2&&this.angleOfLeastInterference<3*k.PI/2&&(a=-l/2-C-A/2-r/2,H=!1,x=k.PI):this.angleOfLeastInterference<=k.PI/4||(this.angleOfLeastInterference<3*k.PI/4?(a=0,f=.9*-g.atoms_font_size_2D,0!==this.charge&&(f-=.3*g.atoms_font_size_2D),H=!1,x=k.PI/2):this.angleOfLeastInterference<=5*k.PI/4?(a=-l/2-C-A/2-r/2,H=!1,x=k.PI):this.angleOfLeastInterference<7*k.PI/4&&(a=0,f=
.9*g.atoms_font_size_2D,H=!1,x=3*k.PI/2));b.font=p;b.fillText("H",this.x+a,this.y+f);b.font=t;b.fillText(y,this.x+a+A/2+C/2,this.y+f+.3*g.atoms_font_size_2D);this.textBounds.push({x:this.x+a-A/2,y:this.y+f-g.atoms_font_size_2D/2+1,w:A,h:g.atoms_font_size_2D-2});this.textBounds.push({x:this.x+a+A/2,y:this.y+f+.3*g.atoms_font_size_2D-g.atoms_font_size_2D/2+1,w:C,h:.8*g.atoms_font_size_2D-2})}else p=l/2+A/2,y=0,1===this.bondNumber?this.angleOfLeastInterference>k.PI/2&&this.angleOfLeastInterference<3*
k.PI/2&&(p=-l/2-A/2-r/2,H=!1,x=k.PI):this.angleOfLeastInterference<=k.PI/4||(this.angleOfLeastInterference<3*k.PI/4?(p=0,y=.9*-g.atoms_font_size_2D,H=!1,x=k.PI/2):this.angleOfLeastInterference<=5*k.PI/4?(p=-l/2-A/2-r/2,H=!1,x=k.PI):this.angleOfLeastInterference<7*k.PI/4&&(p=0,y=.9*g.atoms_font_size_2D,H=!1,x=3*k.PI/2)),b.fillText("H",this.x+p,this.y+y),this.textBounds.push({x:this.x+p-A/2,y:this.y+y-g.atoms_font_size_2D/2+1,w:A,h:g.atoms_font_size_2D-2});H&&(m+=A)}0!==this.charge&&(l=this.charge.toFixed(0),
l="1"===l?"+":"-1"===l?"\u2013":l.startsWith("-")?l.substring(1)+"\u2013":l+"+",r=b.measureText(l).width,m+=r/2,b.textAlign="center",b.textBaseline="middle",b.font=E.getFontString(k.floor(.8*g.atoms_font_size_2D),g.atoms_font_families_2D,g.atoms_font_bold_2D,g.atoms_font_italic_2D),b.fillText(l,this.x+m-1,this.y-g.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x+m-r/2-1,y:this.y-1.8*g.atoms_font_size_2D/2+5,w:r,h:g.atoms_font_size_2D/2-1}))}else v.CondensedLabel?this.label.match(c)?(b.textAlign=
"left",this.error&&(b.fillStyle=g.colorError),b.fillText(this.label,this.x,this.y),m=b.measureText(this.label).width,this.textBounds.push({x:this.x+1,y:this.y-g.atoms_font_size_2D/2+1,w:m,h:g.atoms_font_size_2D-2})):(this.condensed&&this.condensed.text===this.label||(this.condensed=new v.CondensedLabel(this,this.label)),this.condensed.draw(b,g)):(b.fillText(this.label,this.x,this.y),m=b.measureText(this.label).width,this.textBounds.push({x:this.x-m/2,y:this.y-g.atoms_font_size_2D/2+1,w:m,h:g.atoms_font_size_2D-
2}));if(0<this.numLonePair||0<this.numRadical){b.fillStyle="black";p=this.angles.slice(0);m=this.angleOfLeastInterference;l=this.largestAngle;x!==d&&(p.push(x),p.sort(function(F,I){return F-I}),l=w.angleBetweenLargest(p),m=l.angle%(2*k.PI),l=l.largest);r=[];for(A=0;A<this.numLonePair;A++)r.push({t:2});for(A=0;A<this.numRadical;A++)r.push({t:1});if(x===d&&k.abs(l-2*k.PI/p.length)<k.PI/60)for(p=k.ceil(r.length/p.length),A=0,H=r.length;A<H;A+=p,m+=l)this.drawElectrons(b,g,r.slice(A,k.min(r.length,A+
p)),m,l,x);else this.drawElectrons(b,g,r,m,l,x)}}}};e.drawElectrons=function(b,g,m,p,l,r){r=l/(m.length+(0===this.bonds.length&&r===d?0:1));p=p-l/2+r;for(l=0;l<m.length;l++){var y=m[l],x=p+l*r,A=this.x+Math.cos(x)*g.atoms_lonePairDistance_2D,H=this.y-Math.sin(x)*g.atoms_lonePairDistance_2D;2===y.t?(x+=Math.PI/2,y=Math.cos(x)*g.atoms_lonePairSpread_2D/2,x=-Math.sin(x)*g.atoms_lonePairSpread_2D/2,b.beginPath(),b.arc(A+y,H+x,g.atoms_lonePairDiameter_2D,0,2*k.PI,!1),b.fill(),b.beginPath(),b.arc(A-y,H-
x,g.atoms_lonePairDiameter_2D,0,2*k.PI,!1),b.fill()):1===y.t&&(b.beginPath(),b.arc(A,H,g.atoms_lonePairDiameter_2D,0,2*k.PI,!1),b.fill())}};e.drawDecorations=function(b,g){if(this.isHover||this.isSelected)b.strokeStyle=this.isHover?g.colorHover:g.colorSelect,b.lineWidth=1.2,b.beginPath(),b.arc(this.x,this.y,this.isHover?7:15,0,2*k.PI,!1),b.stroke();this.isOverlap&&(b.strokeStyle=g.colorError,b.lineWidth=1.2,b.beginPath(),b.arc(this.x,this.y,7,0,2*k.PI,!1),b.stroke())};e.render=function(b,g,m){this.styles&&
(g=this.styles);var p=q.translate(q.identity(),[this.x,this.y,this.z]),l=g.atoms_useVDWDiameters_3D?n[this.label].vdWRadius*g.atoms_vdwMultiplier_3D:g.atoms_sphereDiameter_3D/2;0===l&&(l=1);q.scale(p,[l,l,l]);m||(m=g.atoms_color,g.atoms_useJMOLColors?m=n[this.label].jmolColor:g.atoms_usePYMOLColors&&(m=n[this.label].pymolColor),b.material.setDiffuseColor(b,m));b.shader.setMatrixUniforms(b,p);b.drawElements(b.TRIANGLES,(this.renderAsStar?b.starBuffer:b.sphereBuffer).vertexIndexBuffer.numItems,b.UNSIGNED_SHORT,
0)};e.renderHighlight=function(b,g){if(this.isSelected||this.isHover){this.styles&&(g=this.styles);var m=q.translate(q.identity(),[this.x,this.y,this.z]),p=g.atoms_useVDWDiameters_3D?n[this.label].vdWRadius*g.atoms_vdwMultiplier_3D:g.atoms_sphereDiameter_3D/2;0===p&&(p=1);p*=1.3;q.scale(m,[p,p,p]);b.shader.setMatrixUniforms(b,m);b.material.setDiffuseColor(b,this.isHover?g.colorHover:g.colorSelect);b.drawElements(b.TRIANGLES,(this.renderAsStar?b.starBuffer:b.sphereBuffer).vertexIndexBuffer.numItems,
b.UNSIGNED_SHORT,0)}};e.isLabelVisible=function(b){return b.atoms_displayAllCarbonLabels_2D||"C"!==this.label||this.altLabel||!n[this.label]||-1!==this.mass||-1!==this.implicitH||0!==this.charge||b.atoms_showAttributedCarbons_2D&&(0!==this.numRadical||0!==this.numLonePair)||this.isHidden&&b.atoms_showHiddenCarbons_2D||b.atoms_displayTerminalCarbonLabels_2D&&1===this.bondNumber?!0:!1};e.getImplicitHydrogenCount=function(){if(!n[this.label]||!n[this.label].addH)return 0;if(-1!==this.implicitH)return this.implicitH;
if("H"===this.label)return 0;var b=n[this.label].valency,g=b-this.coordinationNumber;0<this.numRadical&&(g=k.max(0,g-this.numRadical));0<this.charge?(b=4-b,g=this.charge<=b?g+this.charge:4-this.coordinationNumber-this.charge+b):g+=this.charge;return 0>g?0:k.floor(g)};e.getBounds=function(){var b=new w.Bounds;b.expand(this.x,this.y);if(this.textBounds)for(var g=0,m=this.textBounds.length;g<m;g++){var p=this.textBounds[g];b.expand(p.x,p.y,p.x+p.w,p.y+p.h)}return b};e.getBounds3D=function(){var b=new w.Bounds;
b.expand3D(this.x,this.y,this.z);return b};e.getElementColor=function(b,g,m){if(!n[this.label])return"#000";b?m=n[this.label].jmolColor:g&&(m=n[this.label].pymolColor);return m}})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,Math,ChemDoodle.lib.mat4);
(function(n,E,w,v,k,q,d,c){w.Bond=function(e,b,g){this.a1=e;this.a2=b;this.bondOrder=g!==c?g:1};w.Bond.STEREO_NONE="none";w.Bond.STEREO_PROTRUDING="protruding";w.Bond.STEREO_RECESSED="recessed";w.Bond.STEREO_AMBIGUOUS="ambiguous";n=w.Bond.prototype;n.stereo=w.Bond.STEREO_NONE;n.isHover=!1;n.ring=c;n.getCenter=function(){return new w.Point((this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2)};n.getLength=function(){return this.a1.distance(this.a2)};n.getLength3D=function(){return this.a1.distance3D(this.a2)};
n.contains=function(e){return e===this.a1||e===this.a2};n.getNeighbor=function(e){return e===this.a1?this.a2:e===this.a2?this.a1:c};n.draw=function(e,b){if(this.a1.x!==this.a2.x||this.a1.y!==this.a2.y){this.styles&&(b=this.styles);var g=this.a1.x,m=this.a2.x,p=this.a1.y,l=this.a2.y,r=this.a1.distance(this.a2),y=m-g,x=l-p;if(this.a1.isLassoed&&this.a2.isLassoed){var A=e.createLinearGradient(g,p,m,l);A.addColorStop(0,"rgba(212, 99, 0, 0)");A.addColorStop(.5,"rgba(212, 99, 0, 0.8)");A.addColorStop(1,
"rgba(212, 99, 0, 0)");var H=this.a1.angle(this.a2)+k.PI/2,a=k.cos(H),f=k.sin(H),t=g-2.5*a,C=p+2.5*f,F=g+2.5*a,I=p-2.5*f,L=m+2.5*a,O=l-2.5*f,S=m-2.5*a,W=l+2.5*f;e.fillStyle=A;e.beginPath();e.moveTo(t,C);e.lineTo(F,I);e.lineTo(L,O);e.lineTo(S,W);e.closePath();e.fill()}if(b.atoms_display&&!b.atoms_circles_2D&&this.a1.isLabelVisible(b)&&this.a1.textBounds){for(var V=0,Y=0,ba=this.a1.textBounds.length;Y<ba;Y++)V=Math.max(V,v.calculateDistanceInterior(this.a1,this.a2,this.a1.textBounds[Y]));V+=b.bonds_atomLabelBuffer_2D;
var X=V/r;g+=y*X;p+=x*X}if(b.atoms_display&&!b.atoms_circles_2D&&this.a2.isLabelVisible(b)&&this.a2.textBounds){for(var ca=0,ia=0,Z=this.a2.textBounds.length;ia<Z;ia++)ca=Math.max(ca,v.calculateDistanceInterior(this.a2,this.a1,this.a2.textBounds[ia]));ca+=b.bonds_atomLabelBuffer_2D;var oa=ca/r;m-=y*oa;l-=x*oa}if(b.bonds_clearOverlaps_2D){var ka=g+.15*y,na=p+.15*x,pa=m-.15*y,ta=l-.15*x;e.strokeStyle=b.backgroundColor;e.lineWidth=b.bonds_width_2D+2*b.bonds_overlapClearWidth_2D;e.lineCap="round";e.beginPath();
e.moveTo(ka,na);e.lineTo(pa,ta);e.closePath();e.stroke()}e.strokeStyle=this.error?b.colorError:b.bonds_color;e.fillStyle=this.error?b.colorError:b.bonds_color;e.lineWidth=b.bonds_width_2D;e.lineCap=b.bonds_ends_2D;if(b.bonds_splitColor){var Ea=e.createLinearGradient(g,p,m,l),Ua=this.a1.styles?this.a1.styles:b,Qa=this.a2.styles?this.a2.styles:b,Va=this.a1.getElementColor(Ua.atoms_useJMOLColors,Ua.atoms_usePYMOLColors,Ua.atoms_color,2),Ka=this.a2.getElementColor(Qa.atoms_useJMOLColors,Qa.atoms_usePYMOLColors,
Qa.atoms_color,2);Ea.addColorStop(0,Va);b.bonds_colorGradient||(Ea.addColorStop(.5,Va),Ea.addColorStop(.51,Ka));Ea.addColorStop(1,Ka);e.strokeStyle=Ea;e.fillStyle=Ea}if(b.bonds_lewisStyle_2D&&0===this.bondOrder%1)this.drawLewisStyle(e,b,g,p,m,l);else switch(this.query?1:this.bondOrder){case 0:var mb=m-g,Wa=l-p,ma=k.sqrt(mb*mb+Wa*Wa),eb=k.floor(ma/b.bonds_dotSize_2D),Jb=(ma-(eb-1)*b.bonds_dotSize_2D)/2;1===eb%2?Jb+=b.bonds_dotSize_2D/4:(Jb-=b.bonds_dotSize_2D/4,eb+=2);eb/=2;var fb=this.a1.angle(this.a2),
Tb=g+Jb*Math.cos(fb),tb=p-Jb*Math.sin(fb);e.beginPath();for(var cc=0;cc<eb;cc++)e.arc(Tb,tb,b.bonds_dotSize_2D/2,0,2*k.PI,!1),Tb+=2*b.bonds_dotSize_2D*Math.cos(fb),tb-=2*b.bonds_dotSize_2D*Math.sin(fb);e.fill();break;case .5:e.beginPath();e.moveTo(g,p);e.lineTo(m,l);e.setLineDash([b.bonds_hashSpacing_2D,b.bonds_hashSpacing_2D]);e.stroke();e.setLineDash([]);break;case 1:if(this.query||this.stereo!==w.Bond.STEREO_PROTRUDING&&this.stereo!==w.Bond.STEREO_RECESSED)if(this.query||this.stereo!==w.Bond.STEREO_AMBIGUOUS)e.beginPath(),
e.moveTo(g,p),e.lineTo(m,l),e.stroke(),this.query&&this.query.draw(e,b,this.getCenter());else{var Cb=m-g,Ba=l-p;e.beginPath();e.moveTo(g,p);for(var B=k.floor(k.sqrt(Cb*Cb+Ba*Ba)/b.bonds_wavyLength_2D),Mb=g,Nb=p,vc=this.a1.angle(this.a2)+k.PI/2,wc=k.cos(vc),vb=k.sin(vc),kb=Cb/B,Fb=Ba/B,pc,Zb,Ib=0;Ib<B;Ib++){Mb+=kb;Nb+=Fb;var $b=0===Ib%2?1:-1;pc=b.bonds_wavyLength_2D*wc*$b+Mb-.5*kb;Zb=b.bonds_wavyLength_2D*-vb*$b+Nb-.5*Fb;e.quadraticCurveTo(pc,Zb,Mb,Nb)}e.stroke()}else{var Gb=b.bonds_width_2D/2,Hb=
b.bonds_wedgeThickness_2D/2,zc=this.a1.angle(this.a2)+k.PI/2,Ga=k.cos(zc),wb=k.sin(zc),qb=g-Ga*Gb,Qb=p+wb*Gb,sa=g+Ga*Gb,Ma=p-wb*Gb,Fc=m+Ga*Hb,bc=l-wb*Hb,ec=m-Ga*Hb,yb=l+wb*Hb;e.beginPath();e.moveTo(qb,Qb);e.lineTo(sa,Ma);e.lineTo(Fc,bc);e.lineTo(ec,yb);e.closePath();this.stereo===w.Bond.STEREO_PROTRUDING?e.fill():(e.save(),e.clip(),e.lineWidth=2*Hb,e.lineCap="butt",e.beginPath(),e.moveTo(g,p),e.lineTo(m+5*(m-g),l+5*(l-p)),e.setLineDash([b.bonds_hashWidth_2D,b.bonds_hashSpacing_2D]),e.stroke(),e.setLineDash([]),
e.restore())}break;case 1.5:case 2:var lb=this.a1.angle(this.a2),Ta=lb+k.PI/2,Ya=k.cos(Ta),Za=k.sin(Ta),kc=this.a1.distance(this.a2),xa=b.bonds_useAbsoluteSaturationWidths_2D?b.bonds_saturationWidthAbs_2D/2:kc*b.bonds_saturationWidth_2D/2;if(this.stereo===w.Bond.STEREO_AMBIGUOUS){var jc=g-Ya*xa,qc=p+Za*xa,Ic=g+Ya*xa,fc=p-Za*xa,Jc=m+Ya*xa,Ac=l-Za*xa,Vb=m-Ya*xa,Ub=l+Za*xa;e.beginPath();e.moveTo(jc,qc);e.lineTo(Jc,Ac);e.moveTo(Ic,fc);e.lineTo(Vb,Ub);e.stroke()}else if(!b.bonds_symmetrical_2D&&(this.ring||
"C"===this.a1.label&&"C"===this.a2.label)){e.beginPath();e.moveTo(g,p);e.lineTo(m,l);e.stroke();var ob=0;xa*=2;var zb=b.bonds_saturationAngle_2D;zb<k.PI/2&&(ob=-(xa/k.tan(zb)));if(k.abs(ob)<kc/2){var lc=g-k.cos(lb)*ob,sb=m+k.cos(lb)*ob,Kb=p+k.sin(lb)*ob,Ab=l-k.sin(lb)*ob,rc=lc-Ya*xa,rb=Kb+Za*xa,sc=lc+Ya*xa,Bc=Kb-Za*xa,tc=sb-Ya*xa,Lb=Ab+Za*xa,uc=sb+Ya*xa,Bb=Ab-Za*xa,Rb=!this.ring||this.ring.center.angle(this.a1)>this.ring.center.angle(this.a2)&&!(this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)>
k.PI)||this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)<-k.PI;e.beginPath();Rb?(e.moveTo(rc,rb),e.lineTo(tc,Lb)):(e.moveTo(sc,Bc),e.lineTo(uc,Bb));2!==this.bondOrder&&e.setLineDash([b.bonds_hashSpacing_2D,b.bonds_hashSpacing_2D]);e.stroke();e.setLineDash([])}}else{var Kc=g-Ya*xa,Cc=p+Za*xa,Sb=g+Ya*xa,Dc=p-Za*xa,gc=m+Ya*xa,Ec=l-Za*xa,ac=m-Ya*xa,hc=l+Za*xa;e.beginPath();e.moveTo(Kc,Cc);e.lineTo(ac,hc);e.stroke();e.beginPath();e.moveTo(Sb,Dc);e.lineTo(gc,Ec);2!==this.bondOrder&&e.setLineDash([b.bonds_hashWidth_2D,
b.bonds_hashSpacing_2D]);e.stroke();e.setLineDash([])}break;case 3:var nb=b.bonds_useAbsoluteSaturationWidths_2D?b.bonds_saturationWidthAbs_2D:this.a1.distance(this.a2)*b.bonds_saturationWidth_2D,Ja=this.a1.angle(this.a2)+k.PI/2,xb=k.cos(Ja),ic=k.sin(Ja),Lc=g-xb*nb,Xc=p+ic*nb,Sc=g+xb*nb,Yc=p-ic*nb,Zc=m+xb*nb,$c=l-ic*nb,Tc=m-xb*nb,Gc=l+ic*nb;e.beginPath();e.moveTo(Lc,Xc);e.lineTo(Tc,Gc);e.moveTo(Sc,Yc);e.lineTo(Zc,$c);e.moveTo(g,p);e.lineTo(m,l);e.stroke()}}};n.drawDecorations=function(e,b){if(this.isHover||
this.isSelected){var g=2*k.PI,m=(this.a1.angleForStupidCanvasArcs(this.a2)+k.PI/2)%g;e.strokeStyle=this.isHover?b.colorHover:b.colorSelect;e.lineWidth=1.2;e.beginPath();b=(m+k.PI)%g;b%=2*k.PI;e.arc(this.a1.x,this.a1.y,7,m,b,!1);e.stroke();e.beginPath();m+=k.PI;b=(m+k.PI)%g;e.arc(this.a2.x,this.a2.y,7,m,b,!1);e.stroke()}};n.drawLewisStyle=function(e,b,g,m,p,l){var r=this.a1.angle(this.a2),y=r+k.PI/2;p-=g;l-=m;p=k.sqrt(p*p+l*l)/(this.bondOrder+1);l=p*k.cos(r);r=-p*k.sin(r);g+=l;m+=r;for(p=0;p<this.bondOrder;p++){var x=
b.atoms_lonePairSpread_2D/2,A=g-k.cos(y)*x,H=m+k.sin(y)*x,a=g+k.cos(y)*x;x=m-k.sin(y)*x;e.beginPath();e.arc(A-b.atoms_lonePairDiameter_2D/2,H-b.atoms_lonePairDiameter_2D/2,b.atoms_lonePairDiameter_2D,0,2*k.PI,!1);e.fill();e.beginPath();e.arc(a-b.atoms_lonePairDiameter_2D/2,x-b.atoms_lonePairDiameter_2D/2,b.atoms_lonePairDiameter_2D,0,2*k.PI,!1);e.fill();g+=l;m+=r}};n.render=function(e,b,g){this.styles&&(b=this.styles);var m=this.a1.distance3D(this.a2);if(0!==m){var p=b.bonds_cylinderDiameter_3D/2,
l=b.bonds_color,r=q.translate(q.identity(),[this.a1.x,this.a1.y,this.a1.z]),y,x=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],A=[0,1,0],H=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(A=[0,0,1],this.a2.y<this.a1.y&&(H=k.PI)):(H=E.vec3AngleFrom(A,x),A=d.cross(A,x,[]));if(b.bonds_splitColor){l=this.a1.styles?this.a1.styles:b;var a=this.a2.styles?this.a2.styles:b;l=this.a1.getElementColor(l.atoms_useJMOLColors,l.atoms_usePYMOLColors,l.atoms_color);a=this.a2.getElementColor(a.atoms_useJMOLColors,
a.atoms_usePYMOLColors,a.atoms_color);l!=a&&(y=q.translate(q.identity(),[this.a2.x,this.a2.y,this.a2.z]))}var f=[0];if(g){if(b.bonds_showBondOrders_3D&&1<this.bondOrder){f=[b.bonds_cylinderDiameter_3D];var t=[0,0,1];p=q.inverse(e.rotationMatrix,[]);q.multiplyVec3(p,t);t=d.cross(x,t,[]);d.normalize(t)}x=1;var C=b.bonds_pillSpacing_3D;p=b.bonds_pillHeight_3D;0==this.bondOrder&&(b.bonds_renderAsLines_3D?p=C:(p=b.bonds_pillDiameter_3D,p<b.bonds_cylinderDiameter_3D&&(p/=2),x=p/2,m/=x,C/=x/2));g=p+C;var F=
k.floor(m/g);m=(C+b.bonds_pillDiameter_3D+(m-g*F))/2;C=F;y&&(C=k.floor(F/2));for(var I=0,L=f.length;I<L;I++){var O=q.set(r,[]);0!==f[I]&&q.translate(O,d.scale(t,f[I],[]));0!==H&&q.rotate(O,H,A);1!=x&&q.scale(O,[x,x,x]);l&&e.material.setDiffuseColor(e,l);q.translate(O,[0,m,0]);for(var S=0;S<C;S++)b.bonds_renderAsLines_3D?0==this.bondOrder?(e.shader.setMatrixUniforms(e,O),e.drawArrays(e.POINTS,0,1)):(q.scale(O,[1,p,1]),e.shader.setMatrixUniforms(e,O),e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems),
q.scale(O,[1,1/p,1])):(e.shader.setMatrixUniforms(e,O),0==this.bondOrder?e.drawElements(e.TRIANGLES,e.sphereBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0):e.drawElements(e.TRIANGLES,e.pillBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)),q.translate(O,[0,g,0]);if(y){if(b.bonds_renderAsLines_3D){S=p;S/=2;var W=0}else S=2/3,W=(1-S)/2;0!=F%2&&(q.scale(O,[1,S,1]),e.shader.setMatrixUniforms(e,O),b.bonds_renderAsLines_3D?0==this.bondOrder?e.drawArrays(e.POINTS,0,1):e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems):
0==this.bondOrder?e.drawElements(e.TRIANGLES,e.sphereBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0):e.drawElements(e.TRIANGLES,e.pillBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0),q.translate(O,[0,g*(1+W),0]),q.scale(O,[1,1/S,1]));q.set(y,O);0!==f[I]&&q.translate(O,d.scale(t,f[I],[]));q.rotate(O,H+k.PI,A);1!=x&&q.scale(O,[x,x,x]);a&&e.material.setDiffuseColor(e,a);q.translate(O,[0,m,0]);for(var V=0;V<C;V++)b.bonds_renderAsLines_3D?0==this.bondOrder?(e.shader.setMatrixUniforms(e,O),e.drawArrays(e.POINTS,
0,1)):(q.scale(O,[1,p,1]),e.shader.setMatrixUniforms(e,O),e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems),q.scale(O,[1,1/p,1])):(e.shader.setMatrixUniforms(e,O),0==this.bondOrder?e.drawElements(e.TRIANGLES,e.sphereBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0):e.drawElements(e.TRIANGLES,e.pillBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)),q.translate(O,[0,g,0]);0!=F%2&&(q.scale(O,[1,S,1]),e.shader.setMatrixUniforms(e,O),b.bonds_renderAsLines_3D?0==this.bondOrder?
e.drawArrays(e.POINTS,0,1):e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems):0==this.bondOrder?e.drawElements(e.TRIANGLES,e.sphereBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0):e.drawElements(e.TRIANGLES,e.pillBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0),q.translate(O,[0,g*(1+W),0]),q.scale(O,[1,1/S,1]))}}}else{if(b.bonds_showBondOrders_3D){switch(this.bondOrder){case 1.5:f=[-b.bonds_cylinderDiameter_3D];break;case 2:f=[-b.bonds_cylinderDiameter_3D,b.bonds_cylinderDiameter_3D];
break;case 3:f=[-1.2*b.bonds_cylinderDiameter_3D,0,1.2*b.bonds_cylinderDiameter_3D]}1<this.bondOrder&&(t=[0,0,1],g=q.inverse(e.rotationMatrix,[]),q.multiplyVec3(g,t),t=d.cross(x,t,[]),d.normalize(t))}else switch(this.bondOrder){case 0:p*=.25;break;case .5:case 1.5:p*=.5}y&&(m/=2);m=[p,m,p];x=0;for(p=f.length;x<p;x++)g=q.set(r,[]),0!==f[x]&&q.translate(g,d.scale(t,f[x],[])),0!==H&&q.rotate(g,H,A),q.scale(g,m),l&&e.material.setDiffuseColor(e,l),e.shader.setMatrixUniforms(e,g),b.bonds_renderAsLines_3D?
e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems):e.drawArrays(e.TRIANGLE_STRIP,0,e.cylinderBuffer.vertexPositionBuffer.numItems),y&&(q.set(y,g),0!==f[x]&&q.translate(g,d.scale(t,f[x],[])),q.rotate(g,H+k.PI,A),q.scale(g,m),a&&e.material.setDiffuseColor(e,a),e.shader.setMatrixUniforms(e,g),b.bonds_renderAsLines_3D?e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems):e.drawArrays(e.TRIANGLE_STRIP,0,e.cylinderBuffer.vertexPositionBuffer.numItems))}}};n.renderHighlight=
function(e,b){if(this.isSelected||this.isHover){this.styles&&(b=this.styles);this.styles&&(b=this.styles);var g=this.a1.distance3D(this.a2);if(0!==g){var m=b.bonds_cylinderDiameter_3D/1.2,p=q.translate(q.identity(),[this.a1.x,this.a1.y,this.a1.z]),l=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],r=[0,1,0],y=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(l=[0,0,1],this.a2.y<this.a1.y&&(y=k.PI)):(y=E.vec3AngleFrom(r,l),l=d.cross(r,l,[]));g=[m,g,m];0!==y&&q.rotate(p,y,l);q.scale(p,g);
e.shader.setMatrixUniforms(e,p);e.material.setDiffuseColor(e,this.isHover?b.colorHover:b.colorSelect);e.drawArrays(e.TRIANGLE_STRIP,0,e.cylinderBuffer.vertexPositionBuffer.numItems)}}};n.renderPicker=function(e,b){this.styles&&(b=this.styles);var g=this.a1.distance3D(this.a2);if(0!==g){var m=b.bonds_cylinderDiameter_3D/2,p=q.translate(q.identity(),[this.a1.x,this.a1.y,this.a1.z]),l=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],r=[0,1,0],y=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?
(r=[0,0,1],this.a2.y<this.a1.y&&(y=k.PI)):(y=E.vec3AngleFrom(r,l),r=d.cross(r,l,[]));var x=[0];if(b.bonds_showBondOrders_3D)if(b.bonds_renderAsLines_3D){switch(this.bondOrder){case 1.5:case 2:x=[-b.bonds_cylinderDiameter_3D,b.bonds_cylinderDiameter_3D];break;case 3:x=[-1.2*b.bonds_cylinderDiameter_3D,0,1.2*b.bonds_cylinderDiameter_3D]}if(1<this.bondOrder){var A=[0,0,1];var H=q.inverse(e.rotationMatrix,[]);q.multiplyVec3(H,A);A=d.cross(l,A,[]);d.normalize(A)}}else switch(this.bondOrder){case 1.5:case 2:m*=
3;break;case 3:m*=3.4}else switch(this.bondOrder){case 0:m*=.25;break;case .5:case 1.5:m*=.5}g=[m,g,m];m=0;for(l=x.length;m<l;m++)H=q.set(p,[]),0!==x[m]&&q.translate(H,d.scale(A,x[m],[])),0!==y&&q.rotate(H,y,r),q.scale(H,g),e.shader.setMatrixUniforms(e,H),b.bonds_renderAsLines_3D?e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems):e.drawArrays(e.TRIANGLE_STRIP,0,e.cylinderBuffer.vertexPositionBuffer.numItems)}}})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,
Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3);
(function(n,E,w){n.Ring=function(){this.atoms=[];this.bonds=[]};var v=n.Ring.prototype;v.center=w;v.setupBonds=function(){for(var k=0,q=this.bonds.length;k<q;k++)this.bonds[k].ring=this;this.center=this.getCenter()};v.getCenter=function(){for(var k=Infinity,q=Infinity,d=-Infinity,c=-Infinity,e=0,b=this.atoms.length;e<b;e++)k=E.min(this.atoms[e].x,k),q=E.min(this.atoms[e].y,q),d=E.max(this.atoms[e].x,d),c=E.max(this.atoms[e].y,c);return new n.Point((d+k)/2,(c+q)/2)}})(ChemDoodle.structures,Math);
(function(n,E,w,v,k,q){w.Molecule=function(){this.atoms=[];this.bonds=[];this.rings=[]};var d=w.Molecule.prototype;d.findRings=!0;d.draw=function(c,e){this.styles&&(e=this.styles);if(e.atoms_display&&!e.atoms_circles_2D)for(var b=0,g=this.atoms.length;b<g;b++)this.atoms[b].draw(c,e);if(e.bonds_display)for(b=0,g=this.bonds.length;b<g;b++)this.bonds[b].draw(c,e);if(e.atoms_display)for(b=0,g=this.atoms.length;b<g;b++){var m=this.atoms[b];e.atoms_circles_2D&&m.draw(c,e);m.query&&m.query.draw(c,e,m)}};
d.render=function(c,e){this.styles&&(e=this.styles);var b=0<this.atoms.length&&this.atoms[0].hetatm!==q;if(b){if(e.macro_displayBonds){0<this.bonds.length&&(e.bonds_renderAsLines_3D&&!this.residueSpecs||this.residueSpecs&&this.residueSpecs.bonds_renderAsLines_3D?(c.lineWidth(this.residueSpecs?this.residueSpecs.bonds_width_2D:e.bonds_width_2D),c.lineBuffer.bindBuffers(c)):c.cylinderBuffer.bindBuffers(c),c.material.setTempColors(c,e.bonds_materialAmbientColor_3D,q,e.bonds_materialSpecularColor_3D,e.bonds_materialShininess_3D));
for(var g=0,m=this.bonds.length;g<m;g++){var p=this.bonds[g];!p.a1.hetatm&&(-1===e.macro_atomToLigandDistance||p.a1.closestDistance!==q&&e.macro_atomToLigandDistance>=p.a1.closestDistance&&e.macro_atomToLigandDistance>=p.a2.closestDistance)&&p.render(c,this.residueSpecs?this.residueSpecs:e)}}if(e.macro_displayAtoms)for(0<this.atoms.length&&(c.sphereBuffer.bindBuffers(c),c.material.setTempColors(c,e.atoms_materialAmbientColor_3D,q,e.atoms_materialSpecularColor_3D,e.atoms_materialShininess_3D)),g=0,
m=this.atoms.length;g<m;g++)p=this.atoms[g],!p.hetatm&&(-1===e.macro_atomToLigandDistance||p.closestDistance!==q&&e.macro_atomToLigandDistance>=p.closestDistance)&&p.render(c,this.residueSpecs?this.residueSpecs:e)}if(e.bonds_display){m=[];g=[];0<this.bonds.length&&(e.bonds_renderAsLines_3D?(c.lineWidth(e.bonds_width_2D),c.lineBuffer.bindBuffers(c)):c.cylinderBuffer.bindBuffers(c),c.material.setTempColors(c,e.bonds_materialAmbientColor_3D,q,e.bonds_materialSpecularColor_3D,e.bonds_materialShininess_3D));
p=0;for(var l=this.bonds.length;p<l;p++){var r=this.bonds[p];if(!b||r.a1.hetatm)e.bonds_showBondOrders_3D?0==r.bondOrder?g.push(r):.5==r.bondOrder?m.push(r):(1.5==r.bondOrder&&m.push(r),r.render(c,e)):r.render(c,e)}if(0<m.length)for(e.bonds_renderAsLines_3D||c.pillBuffer.bindBuffers(c),p=0,l=m.length;p<l;p++)m[p].render(c,e,!0);if(0<g.length)for(e.bonds_renderAsLines_3D||c.sphereBuffer.bindBuffers(c),m=0,p=g.length;m<p;m++)g[m].render(c,e,!0)}if(e.atoms_display){g=0;for(m=this.atoms.length;g<m;g++)p=
this.atoms[g],p.bondNumber=0,p.renderAsStar=!1;g=0;for(m=this.bonds.length;g<m;g++)p=this.bonds[g],p.a1.bondNumber++,p.a2.bondNumber++;0<this.atoms.length&&(c.sphereBuffer.bindBuffers(c),c.material.setTempColors(c,e.atoms_materialAmbientColor_3D,q,e.atoms_materialSpecularColor_3D,e.atoms_materialShininess_3D));g=[];m=0;for(p=this.atoms.length;m<p;m++)if(l=this.atoms[m],!b||l.hetatm&&(e.macro_showWater||!l.isWater))e.atoms_nonBondedAsStars_3D&&0===l.bondNumber?(l.renderAsStar=!0,g.push(l)):l.render(c,
e);if(0<g.length)for(c.starBuffer.bindBuffers(c),b=0,m=g.length;b<m;b++)g[b].render(c,e)}if(this.chains){c.shader.setMatrixUniforms(c);if(e.proteins_displayRibbon)for(c.material.setTempColors(c,e.proteins_materialAmbientColor_3D,q,e.proteins_materialSpecularColor_3D,e.proteins_materialShininess_3D),b=e.proteins_ribbonCartoonize?this.cartoons:this.ribbons,g=0,m=b.length;g<m;g++)if(p=b[g],"none"!==e.proteins_residueColor){p.front.bindBuffers(c);l="rainbow"===e.proteins_residueColor;r=0;for(var y=p.front.segments.length;r<
y;r++)l&&c.material.setDiffuseColor(c,E.rainbowAt(r,y,e.macro_rainbowColors)),p.front.segments[r].render(c,e);p.back.bindBuffers(c);r=0;for(y=p.back.segments.length;r<y;r++)l&&c.material.setDiffuseColor(c,E.rainbowAt(r,y,e.macro_rainbowColors)),p.back.segments[r].render(c,e)}else p.front.render(c,e),p.back.render(c,e);if(e.proteins_displayPipePlank)for(b=0,g=this.pipePlanks.length;b<g;b++)this.pipePlanks[b].render(c,e);if(e.proteins_displayBackbone){if(!this.alphaCarbonTrace)for(this.alphaCarbonTrace=
{nodes:[],edges:[]},b=0,g=this.chains.length;b<g;b++)if(m=this.chains[b],!(2<m.length&&v[m[2].name]&&"#BEA06E"===v[m[2].name].aminoColor)&&0<m.length)for(p=0,l=m.length-2;p<l;p++)r=m[p].cp1,r.chainColor=m.chainColor,this.alphaCarbonTrace.nodes.push(r),r=new w.Bond(m[p].cp1,m[p+1].cp1),r.residueName=m[p].name,r.chainColor=m.chainColor,this.alphaCarbonTrace.edges.push(r),p===m.length-3&&(r=m[p+1].cp1,r.chainColor=m.chainColor,this.alphaCarbonTrace.nodes.push(r));if(0<this.alphaCarbonTrace.nodes.length){b=
new w.Styles;b.atoms_display=!0;b.bonds_display=!0;b.atoms_sphereDiameter_3D=e.proteins_backboneThickness;b.bonds_cylinderDiameter_3D=e.proteins_backboneThickness;b.bonds_splitColor=!1;b.atoms_color=e.proteins_backboneColor;b.bonds_color=e.proteins_backboneColor;b.atoms_useVDWDiameters_3D=!1;c.material.setTempColors(c,e.proteins_materialAmbientColor_3D,q,e.proteins_materialSpecularColor_3D,e.proteins_materialShininess_3D);c.material.setDiffuseColor(c,e.proteins_backboneColor);g=0;for(m=this.alphaCarbonTrace.nodes.length;g<
m;g++)p=this.alphaCarbonTrace.nodes[g],e.macro_colorByChain&&(b.atoms_color=p.chainColor),c.sphereBuffer.bindBuffers(c),p.render(c,b);g=0;for(m=this.alphaCarbonTrace.edges.length;g<m;g++)p=this.alphaCarbonTrace.edges[g],l=void 0,r=v[p.residueName]?v[p.residueName]:v["*"],e.macro_colorByChain?l=p.chainColor:"shapely"===e.proteins_residueColor?l=r.shapelyColor:"amino"===e.proteins_residueColor?l=r.aminoColor:"polarity"===e.proteins_residueColor?l=r.polar?"#C10000":"#FFFFFF":"acidity"===e.proteins_residueColor?
l=1===r.acidity?"#0000FF":-1===r.acidity?"#FF0000":r.polar?"#FFFFFF":"#773300":"rainbow"===e.proteins_residueColor&&(l=E.rainbowAt(g,m,e.macro_rainbowColors)),l&&(b.bonds_color=l),c.cylinderBuffer.bindBuffers(c),p.render(c,b)}}if(e.nucleics_display)for(c.material.setTempColors(c,e.nucleics_materialAmbientColor_3D,q,e.nucleics_materialSpecularColor_3D,e.nucleics_materialShininess_3D),b=0,g=this.tubes.length;b<g;b++)c.shader.setMatrixUniforms(c),this.tubes[b].render(c,e)}if(e.atoms_display){b=!1;g=
0;for(m=this.atoms.length;g<m;g++)if(p=this.atoms[g],p.isHover||p.isSelected){b=!0;break}if(!b)for(g=0,m=this.bonds.length;g<m;g++)if(p=this.bonds[g],p.isHover||p.isSelected){b=!0;break}if(b){c.sphereBuffer.bindBuffers(c);c.blendFunc(c.SRC_ALPHA,c.ONE);c.material.setTempColors(c,e.atoms_materialAmbientColor_3D,q,"#000000",0);c.enable(c.BLEND);c.depthMask(!1);c.material.setAlpha(c,.4);c.sphereBuffer.bindBuffers(c);b=0;for(g=this.atoms.length;b<g;b++)m=this.atoms[b],(m.isHover||m.isSelected)&&m.renderHighlight(c,
e);c.cylinderBuffer.bindBuffers(c);b=0;for(g=this.bonds.length;b<g;b++)m=this.bonds[b],(m.isHover||m.isSelected)&&m.renderHighlight(c,e);c.depthMask(!0);c.disable(c.BLEND);c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA)}}};d.renderPickFrame=function(c,e,b,g,m){this.styles&&(e=this.styles);var p=0<this.atoms.length&&this.atoms[0].hetatm!==q;if(m&&e.bonds_display){0<this.bonds.length&&(e.bonds_renderAsLines_3D?(c.lineWidth(e.bonds_width_2D),c.lineBuffer.bindBuffers(c)):
c.cylinderBuffer.bindBuffers(c));m=0;for(var l=this.bonds.length;m<l;m++){var r=this.bonds[m];if(!p||r.a1.hetatm)c.material.setDiffuseColor(c,E.idx2color(b.length)),r.renderPicker(c,e),b.push(r)}}if(g&&e.atoms_display){g=0;for(m=this.atoms.length;g<m;g++)l=this.atoms[g],l.bondNumber=0,l.renderAsStar=!1;g=0;for(m=this.bonds.length;g<m;g++)l=this.bonds[g],l.a1.bondNumber++,l.a2.bondNumber++;0<this.atoms.length&&c.sphereBuffer.bindBuffers(c);g=[];m=0;for(l=this.atoms.length;m<l;m++)if(r=this.atoms[m],
!p||r.hetatm&&(e.macro_showWater||!r.isWater))e.atoms_nonBondedAsStars_3D&&0===r.bondNumber?(r.renderAsStar=!0,g.push(r)):(c.material.setDiffuseColor(c,E.idx2color(b.length)),r.render(c,e,!0),b.push(r));if(0<g.length)for(c.starBuffer.bindBuffers(c),p=0,m=g.length;p<m;p++)l=g[p],c.material.setDiffuseColor(c,E.idx2color(b.length)),l.render(c,e,!0),b.push(l)}};d.getCenter3D=function(){if(1===this.atoms.length)return new w.Atom("C",this.atoms[0].x,this.atoms[0].y,this.atoms[0].z);var c=Infinity,e=Infinity,
b=Infinity,g=-Infinity,m=-Infinity,p=-Infinity;if(this.chains)for(var l=0,r=this.chains.length;l<r;l++)for(var y=this.chains[l],x=0,A=y.length;x<A;x++){var H=y[x];c=k.min(H.cp1.x,H.cp2.x,c);e=k.min(H.cp1.y,H.cp2.y,e);b=k.min(H.cp1.z,H.cp2.z,b);g=k.max(H.cp1.x,H.cp2.x,g);m=k.max(H.cp1.y,H.cp2.y,m);p=k.max(H.cp1.z,H.cp2.z,p)}l=0;for(r=this.atoms.length;l<r;l++)c=k.min(this.atoms[l].x,c),e=k.min(this.atoms[l].y,e),b=k.min(this.atoms[l].z,b),g=k.max(this.atoms[l].x,g),m=k.max(this.atoms[l].y,m),p=k.max(this.atoms[l].z,
p);return new w.Atom("C",(g+c)/2,(m+e)/2,(p+b)/2)};d.getCenter=function(){if(1===this.atoms.length)return new w.Point(this.atoms[0].x,this.atoms[0].y);for(var c=Infinity,e=Infinity,b=-Infinity,g=-Infinity,m=0,p=this.atoms.length;m<p;m++)c=k.min(this.atoms[m].x,c),e=k.min(this.atoms[m].y,e),b=k.max(this.atoms[m].x,b),g=k.max(this.atoms[m].y,g);return new w.Point((b+c)/2,(g+e)/2)};d.getDimension=function(){if(1===this.atoms.length)return new w.Point(0,0);var c=Infinity,e=Infinity,b=-Infinity,g=-Infinity;
if(this.chains){for(var m=0,p=this.chains.length;m<p;m++)for(var l=this.chains[m],r=0,y=l.length;r<y;r++){var x=l[r];c=k.min(x.cp1.x,x.cp2.x,c);e=k.min(x.cp1.y,x.cp2.y,e);b=k.max(x.cp1.x,x.cp2.x,b);g=k.max(x.cp1.y,x.cp2.y,g)}c-=30;e-=30;b+=30;g+=30}m=0;for(p=this.atoms.length;m<p;m++)c=k.min(this.atoms[m].x,c),e=k.min(this.atoms[m].y,e),b=k.max(this.atoms[m].x,b),g=k.max(this.atoms[m].y,g);return new w.Point(b-c,g-e)};d.check=function(c){if(c&&this.doChecks){if(this.findRings)if(this.bonds.length-
this.atoms.length!==this.fjNumCache){this.rings=(new n.informatics.SSSRFinder(this)).rings;for(var e=0,b=this.bonds.length;e<b;e++)this.bonds[e].ring=q;e=0;for(b=this.rings.length;e<b;e++)this.rings[e].setupBonds()}else for(e=0,b=this.rings.length;e<b;e++){var g=this.rings[e];g.center=g.getCenter()}e=0;for(b=this.atoms.length;e<b;e++)if(this.atoms[e].isLone=!1,"C"===this.atoms[e].label){for(var m=g=0,p=this.bonds.length;m<p;m++)this.bonds[m].a1!==this.atoms[e]&&this.bonds[m].a2!==this.atoms[e]||g++;
0===g&&(this.atoms[e].isLone=!0)}e=!1;b=0;for(g=this.atoms.length;b<g;b++)0!==this.atoms[b].z&&(e=!0);e&&(this.sortAtomsByZ(),this.sortBondsByZ());this.setupMetaData();this.atomNumCache=this.atoms.length;this.bondNumCache=this.bonds.length;this.fjNumCache=this.bonds.length-this.atoms.length}this.doChecks=!c};d.getAngles=function(c){for(var e=[],b=0,g=this.bonds.length;b<g;b++)this.bonds[b].contains(c)&&e.push(c.angle(this.bonds[b].getNeighbor(c)));e.sort(function(m,p){return m-p});return e};d.getCoordinationNumber=
function(c){for(var e=0,b=0,g=c.length;b<g;b++)e+=c[b].bondOrder;return e};d.getBonds=function(c){for(var e=[],b=0,g=this.bonds.length;b<g;b++)this.bonds[b].contains(c)&&e.push(this.bonds[b]);return e};d.sortAtomsByZ=function(){for(var c=1,e=this.atoms.length;c<e;c++)for(var b=c;0<b&&this.atoms[b].z<this.atoms[b-1].z;){var g=this.atoms[b];this.atoms[b]=this.atoms[b-1];this.atoms[b-1]=g;b--}};d.sortBondsByZ=function(){for(var c=1,e=this.bonds.length;c<e;c++)for(var b=c;0<b&&this.bonds[b].a1.z+this.bonds[b].a2.z<
this.bonds[b-1].a1.z+this.bonds[b-1].a2.z;){var g=this.bonds[b];this.bonds[b]=this.bonds[b-1];this.bonds[b-1]=g;b--}};d.setupMetaData=function(){for(var c=this.getCenter(),e=0,b=this.atoms.length;e<b;e++){var g=this.atoms[e];g.bonds=this.getBonds(g);g.angles=this.getAngles(g);g.isHidden=2===g.bonds.length&&k.abs(k.abs(g.angles[1]-g.angles[0])-k.PI)<k.PI/30&&g.bonds[0].bondOrder===g.bonds[1].bondOrder;var m=E.angleBetweenLargest(g.angles);g.angleOfLeastInterference=m.angle%(2*k.PI);g.largestAngle=
m.largest;g.coordinationNumber=this.getCoordinationNumber(g.bonds);g.bondNumber=g.bonds.length;g.molCenter=c}e=0;for(b=this.bonds.length;e<b;e++)this.bonds[e].molCenter=c};d.scaleToAverageBondLength=function(c){var e=this.getAverageBondLength();if(0!==e){c/=e;e=0;for(var b=this.atoms.length;e<b;e++)this.atoms[e].x*=c,this.atoms[e].y*=c}};d.getAverageBondLength=function(){if(0===this.bonds.length)return 0;for(var c=0,e=0,b=this.bonds.length;e<b;e++)c+=this.bonds[e].getLength();return c/=this.bonds.length};
d.getBounds=function(){for(var c=new E.Bounds,e=0,b=this.atoms.length;e<b;e++)c.expand(this.atoms[e].getBounds());if(this.chains){e=0;for(b=this.chains.length;e<b;e++)for(var g=this.chains[e],m=0,p=g.length;m<p;m++){var l=g[m];c.expand(l.cp1.x,l.cp1.y);c.expand(l.cp2.x,l.cp2.y)}c.minX-=30;c.minY-=30;c.maxX+=30;c.maxY+=30}return c};d.getBounds3D=function(){for(var c=new E.Bounds,e=0,b=this.atoms.length;e<b;e++)c.expand(this.atoms[e].getBounds3D());if(this.chains)for(e=0,b=this.chains.length;e<b;e++)for(var g=
this.chains[e],m=0,p=g.length;m<p;m++){var l=g[m];c.expand3D(l.cp1.x,l.cp1.y,l.cp1.z);c.expand3D(l.cp2.x,l.cp2.y,l.cp2.z)}return c};d.getAtomGroup=function(c){for(var e=!1,b=0,g=this.atoms.length;b<g;b++)this.atoms[b].visited=!1;b=0;for(g=this.bonds.length;b<g;b++){var m=this.bonds[b];!e&&m.contains(c)&&m.ring!==q&&(e=!0)}if(!e)return q;b=[c];c.visited=!0;g=new w.Queue;for(g.enqueue(c);!g.isEmpty();){c=g.dequeue();m=0;for(var p=this.bonds.length;m<p;m++){var l=this.bonds[m];l.contains(c)&&e===(l.ring!==
q)&&(l=l.getNeighbor(c),l.visited||(l.visited=!0,b.push(l),g.enqueue(l)))}}return b};d.getBondGroup=function(c){for(var e=c.ring!==q,b=!1,g=0,m=this.bonds.length;g<m;g++){var p=this.bonds[g];p===c&&(b=!0);p.visited=!1}if(!b)return q;b=[c];c.visited=!0;g=new w.Queue;for(g.enqueue(c);!g.isEmpty();)for(c=g.dequeue(),m=0,p=this.bonds.length;m<p;m++){var l=this.bonds[m];l.visited||l.a1!==c.a1&&l.a2!==c.a1&&l.a1!==c.a2&&l.a2!==c.a2||l.ring!==q!==e||(l.visited=!0,b.push(l),g.enqueue(l))}return b}})(ChemDoodle,
ChemDoodle.math,ChemDoodle.structures,ChemDoodle.RESIDUE,Math);
(function(n,E,w,v,k){var q,d=-1;n.Residue=function(c){this.resSeq=c};k=n.Residue.prototype;k.setup=function(c,e){this.horizontalResolution=e;var b=[c.x-this.cp1.x,c.y-this.cp1.y,c.z-this.cp1.z],g=v.cross(b,[this.cp2.x-this.cp1.x,this.cp2.y-this.cp1.y,this.cp2.z-this.cp1.z],[]);this.D=v.cross(g,b,[]);v.normalize(g);v.normalize(this.D);this.guidePointsSmall=[];this.guidePointsLarge=[];c=[(c.x+this.cp1.x)/2,(c.y+this.cp1.y)/2,(c.z+this.cp1.z)/2];this.helix&&(v.scale(g,1.5),v.add(c,g));this.guidePointsSmall[0]=
new n.Atom("",c[0]-this.D[0]/2,c[1]-this.D[1]/2,c[2]-this.D[2]/2);for(g=1;g<e;g++)this.guidePointsSmall[g]=new n.Atom("",this.guidePointsSmall[0].x+this.D[0]*g/e,this.guidePointsSmall[0].y+this.D[1]*g/e,this.guidePointsSmall[0].z+this.D[2]*g/e);v.scale(this.D,4);this.guidePointsLarge[0]=new n.Atom("",c[0]-this.D[0]/2,c[1]-this.D[1]/2,c[2]-this.D[2]/2);for(g=1;g<e;g++)this.guidePointsLarge[g]=new n.Atom("",this.guidePointsLarge[0].x+this.D[0]*g/e,this.guidePointsLarge[0].y+this.D[1]*g/e,this.guidePointsLarge[0].z+
this.D[2]*g/e)};k.getGuidePointSet=function(c){if(0===c)return this.helix||this.sheet?this.guidePointsLarge:this.guidePointsSmall;if(1===c)return this.guidePointsSmall;if(2===c)return this.guidePointsLarge};k.computeLineSegments=function(c,e,b,g,m){this.setVerticalResolution(m);this.split=b.helix!==this.helix||b.sheet!==this.sheet;this.lineSegments=this.innerCompute(0,c,e,b,!1,m);g&&(this.lineSegmentsCartoon=this.innerCompute(this.helix||this.sheet?2:1,c,e,b,!0,m))};k.innerCompute=function(c,e,b,
g,m,p){var l=[],r=this.getGuidePointSet(c);e=e.getGuidePointSet(c);b=b.getGuidePointSet(c);c=g.getGuidePointSet(c);g=0;for(var y=r.length;g<y;g++){for(var x=w.multiply([e[g].x,e[g].y,e[g].z,1,b[g].x,b[g].y,b[g].z,1,r[g].x,r[g].y,r[g].z,1,c[g].x,c[g].y,c[g].z,1],q,[]),A=[],H=0;H<p;H++){for(var a=3;0<a;a--)for(var f=0;4>f;f++)x[4*a+f]+=x[4*(a-1)+f];A[H]=new n.Atom("",x[12]/x[15],x[13]/x[15],x[14]/x[15])}l[g]=A}if(m&&this.arrow)for(m=0;m<p;m++)for(r=1.5-1.3*m/p,e=E.floor(this.horizontalResolution/2),
b=l[e],c=0,g=l.length;c<g;c++)c!==e&&(y=b[m],x=l[c][m],A=[x.x-y.x,x.y-y.y,x.z-y.z],v.scale(A,r),x.x=y.x+A[0],x.y=y.y+A[1],x.z=y.z+A[2]);return l};k.setVerticalResolution=function(c){if(c!==d){var e=c*c,b=c*c*c;q=w.multiply([-1/6,.5,-.5,1/6,.5,-1,.5,0,-.5,0,.5,0,1/6,2/3,1/6,0],[6/b,0,0,0,6/b,2/e,0,0,1/b,1/e,1/c,0,0,0,0,1],[]);d=c}}})(ChemDoodle.structures,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3);
(function(n,E,w,v,k,q){E.Spectrum=function(){this.data=[];this.metadata=[];this.dataDisplay=[];this.memory={offsetTop:0,offsetLeft:0,offsetBottom:0,flipXAxis:!1,scale:1,width:0,height:0}};v=E.Spectrum.prototype;v.title=q;v.xUnit=q;v.yUnit=q;v.continuous=!0;v.integrationSensitivity=.01;v.draw=function(d,c,e,b){this.styles&&(c=this.styles);var g=5,m=0,p=0;d.fillStyle=c.text_color;d.textAlign="center";d.textBaseline="alphabetic";d.font=n.getFontString(c.text_font_size,c.text_font_families);this.xUnit&&
(p+=c.text_font_size,d.fillText(this.xUnit,e/2,b-2));this.yUnit&&c.plots_showYAxis&&(m+=c.text_font_size,d.save(),d.translate(c.text_font_size,b/2),d.rotate(-k.PI/2),d.fillText(this.yUnit,0,0),d.restore());this.title&&(g+=c.text_font_size,d.fillText(this.title,e/2,c.text_font_size));d.lineCap="square";p+=5+c.text_font_size;c.plots_showYAxis&&(m+=5+d.measureText("1000").width);c.plots_showGrid&&(d.strokeStyle=c.plots_gridColor,d.lineWidth=c.plots_gridLineWidth,d.strokeRect(m,g,e-m,b-p-g));d.textAlign=
"center";d.textBaseline="top";for(var l=this.maxX-this.minX,r=l/100,y=.001;y<r||25<l/y;)y*=10;l=0;r=c.plots_flipXAxis?e:0;for(var x=k.round(this.minX/y)*y;x<=this.maxX;x+=y/2){var A=this.getTransformedX(x,c,e,m);if(A>m)if(d.strokeStyle="black",d.lineWidth=1,0===l%2){d.beginPath();d.moveTo(A,b-p);d.lineTo(A,b-p+2);d.stroke();for(var H=x.toFixed(5);"0"===H.charAt(H.length-1);)H=H.substring(0,H.length-1);"."===H.charAt(H.length-1)&&(H=H.substring(0,H.length-1));var a=d.measureText(H).width;c.plots_flipXAxis&&
(a*=-1);var f=A-a/2;if(c.plots_flipXAxis?f<r:f>r)d.fillText(H,A,b-p+2),r=A+a/2;c.plots_showGrid&&(d.strokeStyle=c.plots_gridColor,d.lineWidth=c.plots_gridLineWidth,d.beginPath(),d.moveTo(A,b-p),d.lineTo(A,g),d.stroke())}else d.beginPath(),d.moveTo(A,b-p),d.lineTo(A,b-p+2),d.stroke();l++}if(c.plots_showYAxis||c.plots_showGrid)for(y=1/c.scale,d.textAlign="right",d.textBaseline="middle",l=0;10>=l;l++)if(x=y/10*l,r=g+(b-p-g)*(1-x*c.scale),c.plots_showGrid&&(d.strokeStyle=c.plots_gridColor,d.lineWidth=
c.plots_gridLineWidth,d.beginPath(),d.moveTo(m,r),d.lineTo(e,r),d.stroke()),c.plots_showYAxis){d.strokeStyle="black";d.lineWidth=1;d.beginPath();d.moveTo(m,r);d.lineTo(m-3,r);d.stroke();A=100*x;x=k.max(0,3-k.floor(A).toString().length);A=A.toFixed(x);if(0<x)for(;"0"===A.charAt(A.length-1);)A=A.substring(0,A.length-1);"."===A.charAt(A.length-1)&&(A=A.substring(0,A.length-1));d.fillText(A,m-3,r)}d.strokeStyle="black";d.lineWidth=1;d.beginPath();d.moveTo(e,b-p);d.lineTo(m,b-p);c.plots_showYAxis&&d.lineTo(m,
g);d.stroke();if(0<this.dataDisplay.length)for(d.textAlign="left",d.textBaseline="top",l=y=0,r=this.dataDisplay.length;l<r;l++)if(this.dataDisplay[l].value)d.fillText([this.dataDisplay[l].display,": ",this.dataDisplay[l].value].join(""),m+10,g+10+y*(c.text_font_size+5)),y++;else if(this.dataDisplay[l].tag)for(x=0,A=this.metadata.length;x<A;x++)if(this.metadata[x].startsWith(this.dataDisplay[l].tag)){A=this.metadata[x];this.dataDisplay[l].display&&(A=this.metadata[x].indexOf("="),A=[this.dataDisplay[l].display,
": ",-1<A?this.metadata[x].substring(A+2):this.metadata[x]].join(""));d.fillText(A,m+10,g+10+y*(c.text_font_size+5));y++;break}this.drawPlot(d,c,e,b,g,m,p);this.memory.offsetTop=g;this.memory.offsetLeft=m;this.memory.offsetBottom=p;this.memory.flipXAxis=c.plots_flipXAxis;this.memory.scale=c.scale;this.memory.width=e;this.memory.height=b};v.drawPlot=function(d,c,e,b,g,m,p){this.styles&&(c=this.styles);d.strokeStyle=c.plots_color;d.lineWidth=c.plots_width;var l=[];d.save();d.rect(m,g,e-m,b-p-g);d.clip();
d.beginPath();if(this.continuous)for(var r=!1,y=0,x=!1,A=0,H=this.data.length;A<H;A++){var a=this.getTransformedX(this.data[A].x,c,e,m),f=void 0;A<H&&!r&&this.data[A+1]&&(f=this.getTransformedX(this.data[A+1].x,c,e,m));if(a>=m&&a<e||f!==q&&f>=m&&f<e){if(f=this.getTransformedY(this.data[A].y,c,b,p,g),c.plots_showIntegration&&k.abs(this.data[A].y)>this.integrationSensitivity&&l.push(new E.Point(this.data[A].x,this.data[A].y)),r||(d.moveTo(a,f),r=!0),d.lineTo(a,f),y++,0===y%1E3&&(d.stroke(),d.beginPath(),
d.moveTo(a,f)),x)break}else r&&(x=!0)}else for(r=0,y=this.data.length;r<y;r++)x=this.getTransformedX(this.data[r].x,c,e,m),x>=m&&x<e&&(d.moveTo(x,b-p),d.lineTo(x,this.getTransformedY(this.data[r].y,c,b,p,g)));d.stroke();if(c.plots_showIntegration&&1<l.length){d.strokeStyle=c.plots_integrationColor;d.lineWidth=c.plots_integrationLineWidth;d.beginPath();r=l[1].x>l[0].x;if(this.flipXAxis&&!r||!this.flipXAxis&&r){for(r=l.length-2;0<=r;r--)l[r].y+=l[r+1].y;r=l[0].y}else{r=1;for(y=l.length;r<y;r++)l[r].y+=
l[r-1].y;r=l[l.length-1].y}y=0;for(x=l.length;y<x;y++)A=this.getTransformedX(l[y].x,c,e,m),H=this.getTransformedY(l[y].y/c.scale/r,c,b,p,g),0===y?d.moveTo(A,H):d.lineTo(A,H);d.stroke()}d.restore()};v.getTransformedY=function(d,c,e,b,g){return g+(e-b-g)*(1-d*c.scale)};v.getInverseTransformedY=function(d){return(1-(d-this.memory.offsetTop)/(this.memory.height-this.memory.offsetBottom-this.memory.offsetTop))/this.memory.scale*100};v.getTransformedX=function(d,c,e,b){d=b+(d-this.minX)/(this.maxX-this.minX)*
(e-b);c.plots_flipXAxis&&(d=e+b-d);return d};v.getInverseTransformedX=function(d){this.memory.flipXAxis&&(d=this.memory.width+this.memory.offsetLeft-d);return(d-this.memory.offsetLeft)*(this.maxX-this.minX)/(this.memory.width-this.memory.offsetLeft)+this.minX};v.setup=function(){for(var d=Number.MAX_VALUE,c=Number.MIN_VALUE,e=Number.MIN_VALUE,b=0,g=this.data.length;b<g;b++)d=k.min(d,this.data[b].x),c=k.max(c,this.data[b].x),e=k.max(e,this.data[b].y);this.continuous?(this.minX=d,this.maxX=c):(this.minX=
d-1,this.maxX=c+1);d=0;for(c=this.data.length;d<c;d++)this.data[d].y/=e};v.zoom=function(d,c,e,b){d=this.getInverseTransformedX(d);c=this.getInverseTransformedX(c);this.minX=k.min(d,c);this.maxX=k.max(d,c);if(b){b=Number.MIN_VALUE;c=0;for(d=this.data.length;c<d;c++)w.isBetween(this.data[c].x,this.minX,this.maxX)&&(b=k.max(b,this.data[c].y));return 1/b}};v.translate=function(d,c){d=d/(c-this.memory.offsetLeft)*(this.maxX-this.minX)*(this.memory.flipXAxis?1:-1);this.minX+=d;this.maxX+=d};v.alertMetadata=
function(){alert(this.metadata.join("\n"))};v.getInternalCoordinates=function(d,c){return new ChemDoodle.structures.Point(this.getInverseTransformedX(d),this.getInverseTransformedY(c))};v.getClosestPlotInternalCoordinates=function(d){var c=this.getInverseTransformedX(d-1);d=this.getInverseTransformedX(d+1);if(c>d){var e=c;c=d;d=e}e=-1;for(var b=-Infinity,g=!1,m=0,p=this.data.length;m<p;m++){var l=this.data[m];if(w.isBetween(l.x,c,d))l.y>b&&(g=!0,b=l.y,e=m);else if(g)break}if(-1===e)return q;c=this.data[e];
return new ChemDoodle.structures.Point(c.x,100*c.y)};v.getClosestPeakInternalCoordinates=function(d){var c=this.getInverseTransformedX(d);d=0;for(var e=Infinity,b=0,g=this.data.length;b<g;b++){var m=k.abs(this.data[b].x-c);if(m<=e)e=m,d=b;else break}e=c=d;b=this.data[d].y;g=this.data[d].y;m=d+1;for(var p=this.data.length;m<p;m++)if(this.data[m].y+.05>g)g=this.data[m].y,e=m;else break;for(g=d-1;0<=g;g--)if(this.data[g].y+.05>b)b=this.data[g].y,c=g;else break;d=this.data[c-d>e-d?e:c];return new ChemDoodle.structures.Point(d.x,
100*d.y)}})(ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,ChemDoodle.lib.jQuery,Math);
(function(n,E,w,v){E._Shape=function(){};E=E._Shape.prototype;E.drawDecorations=function(k,q){if(this.isHover)for(var d=this.getPoints(),c=0,e=d.length;c<e;c++){var b=d[c];this.drawAnchor(k,q,b,b===this.hoverPoint)}};E.getBounds=function(){for(var k=new n.Bounds,q=this.getPoints(),d=0,c=q.length;d<c;d++){var e=q[d];k.expand(e.x,e.y)}return k};E.drawAnchor=function(k,q,d,c){k.save();k.translate(d.x,d.y);k.rotate(w.PI/4);k.scale(1/q.scale,1/q.scale);k.beginPath();k.moveTo(-4,-4);k.lineTo(4,-4);k.lineTo(4,
4);k.lineTo(-4,4);k.closePath();k.fillStyle=c?q.colorHover:"white";k.fill();k.beginPath();k.moveTo(-4,-2);k.lineTo(-4,-4);k.lineTo(-2,-4);k.moveTo(2,-4);k.lineTo(4,-4);k.lineTo(4,-2);k.moveTo(4,2);k.lineTo(4,4);k.lineTo(2,4);k.moveTo(-2,4);k.lineTo(-4,4);k.lineTo(-4,2);k.moveTo(-4,-2);k.strokeStyle="rgba(0,0,0,.2)";k.lineWidth=5;k.stroke();k.strokeStyle="blue";k.lineWidth=1;k.stroke();k.restore()}})(ChemDoodle.math,ChemDoodle.structures.d2,Math);
(function(n,E,w,v,k,q){v.AtomMapping=function(d,c){this.o1=d;this.o2=c;this.label="0";this.error=!1};E=v.AtomMapping.prototype=new v._Shape;E.drawDecorations=function(d,c){if(this.isHover||this.isSelected)d.strokeStyle=this.isHover?c.colorHover:c.colorSelect,d.lineWidth=1,d.beginPath(),d.moveTo(this.o1.x,this.o1.y),d.lineTo(this.o2.x,this.o2.y),d.setLineDash([2]),d.stroke(),d.setLineDash([])};E.draw=function(d,c){if(this.o1&&this.o2){this.x1=this.o1.x+14*k.cos(this.o1.angleOfLeastInterference);this.y1=
this.o1.y-14*k.sin(this.o1.angleOfLeastInterference);this.x2=this.o2.x+14*k.cos(this.o2.angleOfLeastInterference);this.y2=this.o2.y-14*k.sin(this.o2.angleOfLeastInterference);d.font=n.getFontString(c.text_font_size,c.text_font_families,c.text_font_bold,c.text_font_italic);var e=this.label,b=d.measureText(e).width;this.isLassoed&&(d.fillStyle=c.colorHover,d.fillRect(this.x1-b/2-3,this.y1-c.text_font_size/2-3,b+6,c.text_font_size+6),d.fillRect(this.x2-b/2-3,this.y2-c.text_font_size/2-3,b+6,c.text_font_size+
6));var g=this.error?c.colorError:c.shapes_color;if(this.isHover||this.isSelected)g=this.isHover?c.colorHover:c.colorSelect;d.fillStyle=g;d.fillRect(this.x1-b/2-1,this.y1-c.text_font_size/2-1,b+2,c.text_font_size+2);d.fillRect(this.x2-b/2-1,this.y2-c.text_font_size/2-1,b+2,c.text_font_size+2);d.textAlign="center";d.textBaseline="middle";d.fillStyle=c.backgroundColor;d.fillText(e,this.x1,this.y1);d.fillText(e,this.x2,this.y2)}};E.getPoints=function(){return[new w.Point(this.x1,this.y1),new w.Point(this.x2,
this.y2)]};E.isOver=function(d,c){return this.x1?d.distance({x:this.x1,y:this.y1})<c||d.distance({x:this.x2,y:this.y2})<c:!1}})(ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(n,E,w,v,k,q){v.Bracket=function(d,c){this.p1=d?d:new w.Point;this.p2=c?c:new w.Point};v=v.Bracket.prototype=new v._Shape;v.charge=0;v.mult=0;v.repeat=0;v.draw=function(d,c){var e=k.min(this.p1.x,this.p2.x),b=k.max(this.p1.x,this.p2.x),g=k.min(this.p1.y,this.p2.y),m=k.max(this.p1.y,this.p2.y),p=m-g,l=p/10;d.beginPath();d.moveTo(e+l,g);d.lineTo(e,g);d.lineTo(e,m);d.lineTo(e+l,m);d.moveTo(b-l,m);d.lineTo(b,m);d.lineTo(b,g);d.lineTo(b-l,g);this.isLassoed&&(l=d.createLinearGradient(this.p1.x,
this.p1.y,this.p2.x,this.p2.y),l.addColorStop(0,"rgba(212, 99, 0, 0)"),l.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),l.addColorStop(1,"rgba(212, 99, 0, 0)"),d.lineWidth=c.shapes_lineWidth+5,d.strokeStyle=l,d.lineJoin="miter",d.lineCap="square",d.stroke());d.strokeStyle=c.shapes_color;d.lineWidth=c.shapes_lineWidth;d.lineJoin="miter";d.lineCap="butt";d.stroke();0!==this.charge&&(d.fillStyle=c.text_color,d.textAlign="left",d.textBaseline="alphabetic",d.font=n.getFontString(c.text_font_size,c.text_font_families),
l=this.charge.toFixed(0),l="1"===l?"+":"-1"===l?"\u2013":l.startsWith("-")?l.substring(1)+"\u2013":l+"+",d.fillText(l,b+5,g+5));0!==this.mult&&(d.fillStyle=c.text_color,d.textAlign="right",d.textBaseline="middle",d.font=n.getFontString(c.text_font_size,c.text_font_families),d.fillText(this.mult.toFixed(0),e-5,g+p/2));0!==this.repeat&&(d.fillStyle=c.text_color,d.textAlign="left",d.textBaseline="top",d.font=n.getFontString(c.text_font_size,c.text_font_families),c=this.repeat.toFixed(0),d.fillText(c,
b+5,m-5))};v.getPoints=function(){return[this.p1,this.p2]};v.isOver=function(d,c){return E.isBetween(d.x,this.p1.x,this.p2.x)&&E.isBetween(d.y,this.p1.y,this.p2.y)}})(ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(n,E,w,v,k,q,d){k.DynamicBracket=function(e,b){this.b1=e;this.b2=b;this.n1=1;this.n2=4;this.contents=[];this.ps=[]};E=k.DynamicBracket.prototype=new k._Shape;E.drawDecorations=function(e,b){if(this.isHover){b=0;for(var g=this.contents.length;b<g;b++){var m=this.contents[b],p=e.createRadialGradient(m.x-1,m.y-1,0,m.x,m.y,7);p.addColorStop(0,"rgba(212, 99, 0, 0)");p.addColorStop(.7,"rgba(212, 99, 0, 0.8)");e.fillStyle=p;e.beginPath();e.arc(m.x,m.y,5,0,2*q.PI,!1);e.fill()}}};var c=function(e,
b,g,m,p){b=[];var l=0<p.length?-1===p.indexOf(g.a1)?g.a2:g.a1:g.a1.distance(m.getCenter())<g.a2.distance(m.getCenter())?g.a1:g.a2;m=l.angle(g.getNeighbor(l));var r=m+q.PI/2;g=g.getLength()/(1<p.length?4:2);p=l.x+g*q.cos(m);l=l.y-g*q.sin(m);var y=10*q.cos(r),x=10*q.sin(r);r=p+y;g=l-x;p-=y;l+=x;x=-4*q.cos(m);var A=-4*q.sin(m);m=r+x;y=g-A;x=p+x;A=l-A;e.beginPath();e.moveTo(m,y);e.lineTo(r,g);e.lineTo(p,l);e.lineTo(x,A);e.stroke();b.push(new v.Point(r,g));b.push(new v.Point(p,l));return b};E.draw=function(e,
b){if(this.b1&&this.b2){var g=this.error?b.colorError:b.shapes_color;if(this.isHover||this.isSelected)g=this.isHover?b.colorHover:b.colorSelect;e.strokeStyle=g;e.fillStyle=e.strokeStyle;e.lineWidth=b.shapes_lineWidth;e.lineJoin="miter";e.lineCap="butt";g=c(e,b,this.b1,this.b2,this.contents);var m=c(e,b,this.b2,this.b1,this.contents);this.ps=g.concat(m);this.b1.getCenter().x>this.b2.getCenter().x?this.textPos=this.ps[0].x>this.ps[1].x+5?this.ps[0]:this.ps[1]:this.textPos=this.ps[2].x>this.ps[3].x+
5?this.ps[2]:this.ps[3];!this.error&&0<this.contents.length&&(e.font=n.getFontString(b.text_font_size,b.text_font_families,b.text_font_bold,b.text_font_italic),e.fillStyle=this.isHover?b.colorHover:b.text_color,e.textAlign="left",e.textBaseline="bottom",e.fillText(this.n1+"-"+this.n2,this.textPos.x+2,this.textPos.y+2))}};E.getPoints=function(){return this.ps};E.isOver=function(e,b){return!1};E.setContents=function(e){this.contents=[];var b=e.getMoleculeByAtom(this.b1.a1);e=e.getMoleculeByAtom(this.b2.a1);
if(b&&b===e){for(var g=e=0,m=0,p=b.rings.length;m<p;m++)for(var l=b.rings[m],r=0,y=l.bonds.length;r<y;r++){var x=l.bonds[r];x===this.b1?e++:x===this.b2&&g++}e=1===e&&1===g&&this.b1.ring===this.b2.ring;this.contents.flippable=e;if(this.b1.ring===d&&this.b2.ring===d||e)for(g=0,m=b.atoms.length;g<m;g++){r=l=p=!1;y=0;for(x=b.bonds.length;y<x;y++)b.bonds[y].visited=!1;y=new v.Queue;x=b.atoms[g];for(y.enqueue(x);!(y.isEmpty()||p&&l);){var A=y.dequeue();e&&(!this.flip&&A===this.b1.a1||this.flip&&A===this.b1.a2)&&
(r=!0);for(var H=0,a=b.bonds.length;H<a;H++){var f=b.bonds[H];if(f.a1===A||f.a2===A)f===this.b1?p=!0:f===this.b2?l=!0:f.visited||(f.visited=!0,y.enqueue(f.getNeighbor(A)))}}p&&l&&(!e||r)&&this.contents.push(x)}}}})(ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.lib.jsBezier,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(n,E,w,v,k,q){v.Line=function(c,e){this.p1=c?c:new w.Point;this.p2=e?e:new w.Point};v.Line.ARROW_SYNTHETIC="synthetic";v.Line.ARROW_RETROSYNTHETIC="retrosynthetic";v.Line.ARROW_RESONANCE="resonance";v.Line.ARROW_EQUILIBRIUM="equilibrium";var d=v.Line.prototype=new v._Shape;d.arrowType=q;d.topText=q;d.bottomText=q;d.draw=function(c,e){if(this.isLassoed){var b=c.createLinearGradient(this.p1.x,this.p1.y,this.p2.x,this.p2.y);b.addColorStop(0,"rgba(212, 99, 0, 0)");b.addColorStop(.5,"rgba(212, 99, 0, 0.8)");
b.addColorStop(1,"rgba(212, 99, 0, 0)");var g=this.p1.angle(this.p2)+k.PI/2,m=k.cos(g),p=k.sin(g);g=this.p1.x-2.5*m;var l=this.p1.y+2.5*p,r=this.p1.x+2.5*m,y=this.p1.y-2.5*p,x=this.p2.x+2.5*m,A=this.p2.y-2.5*p;m=this.p2.x-2.5*m;p=this.p2.y+2.5*p;c.fillStyle=b;c.beginPath();c.moveTo(g,l);c.lineTo(r,y);c.lineTo(x,A);c.lineTo(m,p);c.closePath();c.fill()}c.strokeStyle=e.shapes_color;c.fillStyle=e.shapes_color;c.lineWidth=e.shapes_lineWidth;c.lineJoin="miter";c.lineCap="butt";if(this.p1.x!==this.p2.x||
this.p1.y!==this.p2.y){if(this.arrowType===v.Line.ARROW_RETROSYNTHETIC){g=2*k.sqrt(2);b=e.shapes_arrowLength_2D/g;r=this.p1.angle(this.p2);y=r+k.PI/2;g=e.shapes_arrowLength_2D/g;l=k.cos(r);r=k.sin(r);var H=k.cos(y),a=k.sin(y);y=this.p1.x-H*b;x=this.p1.y+a*b;A=this.p1.x+H*b;m=this.p1.y-a*b;p=this.p2.x+H*b-l*g;var f=this.p2.y-a*b+r*g,t=this.p2.x-H*b-l*g,C=this.p2.y+a*b+r*g,F=this.p2.x+H*b*2-l*g*2,I=this.p2.y-a*b*2+r*g*2;l=this.p2.x-H*b*2-l*g*2;b=this.p2.y+a*b*2+r*g*2;c.beginPath();c.moveTo(A,m);c.lineTo(p,
f);c.moveTo(F,I);c.lineTo(this.p2.x,this.p2.y);c.lineTo(l,b);c.moveTo(t,C);c.lineTo(y,x)}else this.arrowType===v.Line.ARROW_EQUILIBRIUM?(b=2*k.sqrt(2),f=e.shapes_arrowLength_2D/b/2,l=this.p1.angle(this.p2),y=l+k.PI/2,b=2*e.shapes_arrowLength_2D/k.sqrt(3),g=k.cos(l),l=k.sin(l),r=k.cos(y),y=k.sin(y),x=this.p1.x-r*f,A=this.p1.y+y*f,t=this.p1.x+r*f,C=this.p1.y-y*f,m=this.p2.x+r*f,p=this.p2.y-y*f,F=this.p2.x-r*f,f=this.p2.y+y*f,c.beginPath(),c.moveTo(t,C),c.lineTo(m,p),c.moveTo(F,f),c.lineTo(x,A),c.stroke(),
f=m-g*b*.8,t=p+l*b*.8,C=m+r*e.shapes_arrowLength_2D/3-g*b,F=p-y*e.shapes_arrowLength_2D/3+l*b,c.beginPath(),c.moveTo(m,p),c.lineTo(C,F),c.lineTo(f,t),c.closePath(),c.fill(),c.stroke(),f=x+g*b*.8,t=A-l*b*.8,C=x-r*e.shapes_arrowLength_2D/3+g*b,F=A+y*e.shapes_arrowLength_2D/3-l*b,c.beginPath(),c.moveTo(x,A),c.lineTo(C,F),c.lineTo(f,t),c.closePath(),c.fill()):this.arrowType===v.Line.ARROW_SYNTHETIC?(l=this.p1.angle(this.p2),r=l+k.PI/2,b=2*e.shapes_arrowLength_2D/k.sqrt(3),g=k.cos(l),l=k.sin(l),m=k.cos(r),
p=k.sin(r),c.beginPath(),c.moveTo(this.p1.x,this.p1.y),c.lineTo(this.p2.x-g*b/2,this.p2.y+l*b/2),c.stroke(),r=this.p2.x-g*b*.8,y=this.p2.y+l*b*.8,x=this.p2.x+m*e.shapes_arrowLength_2D/3-g*b,A=this.p2.y-p*e.shapes_arrowLength_2D/3+l*b,g=this.p2.x-m*e.shapes_arrowLength_2D/3-g*b,b=this.p2.y+p*e.shapes_arrowLength_2D/3+l*b,c.beginPath(),c.moveTo(this.p2.x,this.p2.y),c.lineTo(g,b),c.lineTo(r,y),c.lineTo(x,A),c.closePath(),c.fill()):this.arrowType===v.Line.ARROW_RESONANCE?(l=this.p1.angle(this.p2),y=l+
k.PI/2,b=2*e.shapes_arrowLength_2D/k.sqrt(3),g=k.cos(l),l=k.sin(l),r=k.cos(y),y=k.sin(y),c.beginPath(),c.moveTo(this.p1.x+g*b/2,this.p1.y-l*b/2),c.lineTo(this.p2.x-g*b/2,this.p2.y+l*b/2),c.stroke(),x=this.p2.x-g*b*.8,A=this.p2.y+l*b*.8,m=this.p2.x+r*e.shapes_arrowLength_2D/3-g*b,p=this.p2.y-y*e.shapes_arrowLength_2D/3+l*b,f=this.p2.x-r*e.shapes_arrowLength_2D/3-g*b,t=this.p2.y+y*e.shapes_arrowLength_2D/3+l*b,c.beginPath(),c.moveTo(this.p2.x,this.p2.y),c.lineTo(f,t),c.lineTo(x,A),c.lineTo(m,p),c.closePath(),
c.fill(),c.stroke(),x=this.p1.x+g*b*.8,A=this.p1.y-l*b*.8,m=this.p1.x-r*e.shapes_arrowLength_2D/3+g*b,p=this.p1.y+y*e.shapes_arrowLength_2D/3-l*b,f=this.p1.x+r*e.shapes_arrowLength_2D/3+g*b,t=this.p1.y-y*e.shapes_arrowLength_2D/3-l*b,c.beginPath(),c.moveTo(this.p1.x,this.p1.y),c.lineTo(f,t),c.lineTo(x,A),c.lineTo(m,p),c.closePath(),c.fill()):(c.beginPath(),c.moveTo(this.p1.x,this.p1.y),c.lineTo(this.p2.x,this.p2.y));c.stroke();if(this.topText||this.bottomText)c.font=n.getFontString(e.text_font_size,
e.text_font_families,e.text_font_bold,e.text_font_italic),c.fillStyle=e.text_color;this.topText&&(c.textAlign="center",c.textBaseline="bottom",c.fillText(this.topText,(this.p1.x+this.p2.x)/2,this.p1.y-5));this.bottomText&&(c.textAlign="center",c.textBaseline="top",c.fillText(this.bottomText,(this.p1.x+this.p2.x)/2,this.p1.y+5))}};d.getPoints=function(){return[this.p1,this.p2]};d.isOver=function(c,e){c=E.distanceFromPointToLineInclusive(c,this.p1,this.p2);return-1!==c&&c<e}})(ChemDoodle.extensions,
ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(n,E,w,v,k,q){var d=function(b){var g=[];if(b instanceof w.Atom)if(0===b.bondNumber)g.push(k.PI);else{if(b.angles){if(1===b.angles.length)g.push(b.angles[0]+k.PI);else{for(var m=1,p=b.angles.length;m<p;m++)g.push(b.angles[m-1]+(b.angles[m]-b.angles[m-1])/2);m=b.angles[b.angles.length-1];g.push(m+(b.angles[0]+2*k.PI-m)/2)}b.largestAngle>k.PI&&(g=[b.angleOfLeastInterference]);if(b.bonds)for(m=0,p=b.bonds.length;m<p;m++){var l=b.bonds[m];if(2===l.bondOrder&&(l=l.getNeighbor(b),"O"===l.label)){g=
[l.angle(b)];break}}}}else b=b.a1.angle(b.a2),g.push(b+k.PI/2),g.push(b+3*k.PI/2);b=0;for(m=g.length;b<m;b++){for(;g[b]>2*k.PI;)g[b]-=2*k.PI;for(;0>g[b];)g[b]+=2*k.PI}return g},c=function(b,g){var m=3;if(b instanceof w.Atom){if(b.isLabelVisible(g)&&(m=8),0!==b.charge||0!==b.numRadical||0!==b.numLonePair)m=13}else b instanceof w.Point?m=0:1<b.bondOrder&&(m=5);return m},e=function(b,g,m,p,l,r,y,x,A,H){var a=r.angle(l),f=y.angle(x),t=k.cos(a);a=k.sin(a);var C=c(m,g);l.x-=t*C;l.y+=a*C;C=f+k.PI/2;m=2*
g.shapes_arrowLength_2D/k.sqrt(3);t=k.cos(f);a=k.sin(f);var F=k.cos(C),I=k.sin(C);x.x-=5*t;x.y+=5*a;f=new w.Point(x.x,x.y);C=c(p,g)/3;f.x-=t*C;f.y+=a*C;x.x-=t*(.8*m+C);x.y+=a*(.8*m+C);p=f.x-t*m*.8;C=f.y+a*m*.8;var L=new w.Point(f.x+F*g.shapes_arrowLength_2D/3-t*m,f.y-I*g.shapes_arrowLength_2D/3+a*m);g=new w.Point(f.x-F*g.shapes_arrowLength_2D/3-t*m,f.y+I*g.shapes_arrowLength_2D/3+a*m);a=t=!0;1===A&&(L.distance(r)>g.distance(r)?a=!1:t=!1);b.beginPath();b.moveTo(f.x,f.y);a&&b.lineTo(g.x,g.y);b.lineTo(p,
C);t&&b.lineTo(L.x,L.y);b.closePath();b.fill();b.stroke();b.beginPath();b.moveTo(l.x,l.y);b.bezierCurveTo(r.x,r.y,y.x,y.y,x.x,x.y);b.stroke();H.push([l,r,y,x])};v.Pusher=function(b,g,m){this.o1=b;this.o2=g;this.numElectron=m?m:1};v=v.Pusher.prototype=new v._Shape;v.drawDecorations=function(b,g){if(this.isHover){var m=this.o1 instanceof w.Atom?new w.Point(this.o1.x,this.o1.y):this.o1.getCenter(),p=this.o2 instanceof w.Atom?new w.Point(this.o2.x,this.o2.y):this.o2.getCenter();m=[m,p];p=0;for(var l=
m.length;p<l;p++){var r=m[p];this.drawAnchor(b,g,r,r===this.hoverPoint)}}};v.draw=function(b,g){if(this.o1&&this.o2){b.strokeStyle=g.shapes_color;b.fillStyle=g.shapes_color;b.lineWidth=g.shapes_lineWidth;b.lineJoin="miter";b.lineCap="butt";for(var m=this.o1 instanceof w.Atom?new w.Point(this.o1.x,this.o1.y):this.o1.getCenter(),p=this.o2 instanceof w.Atom?new w.Point(this.o2.x,this.o2.y):this.o2.getCenter(),l=d(this.o1),r=d(this.o2),y,x,A=Infinity,H=0,a=l.length;H<a;H++)for(var f=0,t=r.length;f<t;f++){var C=
new w.Point(m.x+35*k.cos(l[H]),m.y-35*k.sin(l[H])),F=new w.Point(p.x+35*k.cos(r[f]),p.y-35*k.sin(r[f])),I=C.distance(F);I<A&&(A=I,y=C,x=F)}this.caches=[];-1===this.numElectron?(H=m.distance(p)/2,r=m.angle(p),l=r+k.PI/2,a=k.cos(r),f=k.sin(r),r=new w.Point(m.x+(H-1)*a,m.y-(H-1)*f),A=new w.Point(r.x+35*k.cos(l+k.PI/6),r.y-35*k.sin(l+k.PI/6)),H=new w.Point(m.x+(H+1)*a,m.y-(H+1)*f),l=new w.Point(H.x+35*k.cos(l-k.PI/6),H.y-35*k.sin(l-k.PI/6)),e(b,g,this.o1,r,m,y,A,r,1,this.caches),e(b,g,this.o2,H,p,x,l,
H,1,this.caches)):(n.intersectLines(m.x,m.y,y.x,y.y,p.x,p.y,x.x,x.y)&&(l=y,y=x,x=l),l=y.angle(m),r=x.angle(p),A=k.max(l,r)-k.min(l,r),.001>k.abs(A-k.PI)&&this.o1.molCenter===this.o2.molCenter&&(l+=k.PI/2,r-=k.PI/2,y.x=m.x+35*k.cos(l+k.PI),y.y=m.y-35*k.sin(l+k.PI),x.x=p.x+35*k.cos(r+k.PI),x.y=p.y-35*k.sin(r+k.PI)),e(b,g,this.o1,this.o2,m,y,x,p,this.numElectron,this.caches))}};v.getPoints=function(){return[]};v.isOver=function(b,g){for(var m=0,p=this.caches.length;m<p;m++)if(E.distanceFromCurve(b,this.caches[m]).distance<
g)return!0;return!1}})(ChemDoodle.math,ChemDoodle.lib.jsBezier,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(n,E,w,v,k){var q=new E.Bond;w.VAP=function(d,c){this.asterisk=new E.Atom("O",d,c);this.substituent;this.bondType=1;this.attachments=[]};n=w.VAP.prototype=new w._Shape;n.drawDecorations=function(d,c){if(this.isHover||this.isSelected){d.strokeStyle=this.isHover?c.colorHover:c.colorSelect;d.lineWidth=1.2;if(this.hoverBond){var e=2*v.PI,b=(this.asterisk.angleForStupidCanvasArcs(this.hoverBond)+v.PI/2)%e;d.strokeStyle=this.isHover?c.colorHover:c.colorSelect;d.beginPath();c=(b+v.PI)%e;c%=2*v.PI;
d.arc(this.asterisk.x,this.asterisk.y,7,b,c,!1);d.stroke();d.beginPath();b+=v.PI;c=(b+v.PI)%e;d.arc(this.hoverBond.x,this.hoverBond.y,7,b,c,!1)}else d.beginPath(),d.arc(this.asterisk.x,this.asterisk.y,7,0,2*v.PI,!1);d.stroke()}};n.draw=function(d,c){d.strokeStyle=this.error?c.colorError:c.shapes_color;d.lineWidth=1;var e=v.sqrt(3)/2;d.beginPath();d.moveTo(this.asterisk.x,this.asterisk.y-4);d.lineTo(this.asterisk.x,this.asterisk.y+4);d.moveTo(this.asterisk.x-4*e,this.asterisk.y-2);d.lineTo(this.asterisk.x+
4*e,this.asterisk.y+2);d.moveTo(this.asterisk.x-4*e,this.asterisk.y+2);d.lineTo(this.asterisk.x+4*e,this.asterisk.y-2);d.stroke();this.asterisk.textBounds=[];this.asterisk.textBounds.push({x:this.asterisk.x-4,y:this.asterisk.y-4,w:8,h:8});e=c.bonds_color;this.error&&(c.bonds_color=c.colorError);q.a1=this.asterisk;this.substituent&&(q.a2=this.substituent,q.bondOrder=this.bondType,q.draw(d,c));q.bondOrder=0;this.error||(c.bonds_color=c.shapes_color);for(var b=0,g=this.attachments.length;b<g;b++)q.a2=
this.attachments[b],q.draw(d,c);c.bonds_color=e};n.getPoints=function(){return[this.asterisk]};n.isOver=function(d,c){return!1}})(ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(n,E,w){n._Mesh=function(){};n=n._Mesh.prototype;n.storeData=function(v,k,q){this.positionData=v;this.normalData=k;this.indexData=q};n.setupBuffers=function(v){this.vertexPositionBuffer=v.createBuffer();v.bindBuffer(v.ARRAY_BUFFER,this.vertexPositionBuffer);v.bufferData(v.ARRAY_BUFFER,new Float32Array(this.positionData),v.STATIC_DRAW);this.vertexPositionBuffer.itemSize=3;this.vertexPositionBuffer.numItems=this.positionData.length/3;this.vertexNormalBuffer=v.createBuffer();v.bindBuffer(v.ARRAY_BUFFER,
this.vertexNormalBuffer);v.bufferData(v.ARRAY_BUFFER,new Float32Array(this.normalData),v.STATIC_DRAW);this.vertexNormalBuffer.itemSize=3;this.vertexNormalBuffer.numItems=this.normalData.length/3;this.indexData&&(this.vertexIndexBuffer=v.createBuffer(),v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexData),v.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexData.length);if(this.partitions)for(var k=
0,q=this.partitions.length;k<q;k++){var d=this.partitions[k],c=this.generateBuffers(v,d.positionData,d.normalData,d.indexData);d.vertexPositionBuffer=c[0];d.vertexNormalBuffer=c[1];d.vertexIndexBuffer=c[2]}};n.generateBuffers=function(v,k,q,d){var c=v.createBuffer();v.bindBuffer(v.ARRAY_BUFFER,c);v.bufferData(v.ARRAY_BUFFER,new Float32Array(k),v.STATIC_DRAW);c.itemSize=3;c.numItems=k.length/3;k=v.createBuffer();v.bindBuffer(v.ARRAY_BUFFER,k);v.bufferData(v.ARRAY_BUFFER,new Float32Array(q),v.STATIC_DRAW);
k.itemSize=3;k.numItems=q.length/3;if(d){var e=v.createBuffer();v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,e);v.bufferData(v.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),v.STATIC_DRAW);e.itemSize=1;e.numItems=d.length}return[c,k,e]};n.bindBuffers=function(v){this.vertexPositionBuffer||this.setupBuffers(v);v.bindBuffer(v.ARRAY_BUFFER,this.vertexPositionBuffer);v.vertexAttribPointer(v.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,v.FLOAT,!1,0,0);v.bindBuffer(v.ARRAY_BUFFER,this.vertexNormalBuffer);
v.vertexAttribPointer(v.shader.vertexNormalAttribute,this.vertexNormalBuffer.itemSize,v.FLOAT,!1,0,0);this.vertexIndexBuffer&&v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}})(ChemDoodle.structures.d3,Math);
(function(n,E){n._Measurement=function(){};n=n._Measurement.prototype=new n._Mesh;n.render=function(w,v){w.shader.setMatrixUniforms(w);v.measurement_update_3D&&(this.text=this.vertexPositionBuffer=E);this.vertexPositionBuffer||this.calculateData(v);this.bindBuffers(w);w.material.setDiffuseColor(w,v.shapes_color);w.lineWidth(v.shapes_lineWidth);w.drawElements(w.LINES,this.vertexIndexBuffer.numItems,w.UNSIGNED_SHORT,0)};n.renderText=function(w,v){w.shader.setMatrixUniforms(w);this.text||(this.text=
this.getText(v));v={position:[],texCoord:[],translation:[]};w.textImage.pushVertexData(this.text.value,this.text.pos,1,v);w.textMesh.storeData(w,v.position,v.texCoord,v.translation);w.textImage.useTexture(w);w.textMesh.render(w)}})(ChemDoodle.structures.d3);
(function(n,E,w,v,k,q,d,c){w.Angle=function(e,b,g){this.a1=e;this.a2=b;this.a3=g};n=w.Angle.prototype=new w._Measurement;n.calculateData=function(e){var b=[],g=[],m=[],p=this.a2.distance3D(this.a1),l=this.a2.distance3D(this.a3);this.distUse=k.min(p,l)/2;this.vec1=d.normalize([this.a1.x-this.a2.x,this.a1.y-this.a2.y,this.a1.z-this.a2.z]);this.vec2=d.normalize([this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z]);this.angle=E.vec3AngleFrom(this.vec1,this.vec2);p=d.normalize(d.cross(this.vec1,
this.vec2,[]));p=d.normalize(d.cross(p,this.vec1,[]));e=e.measurement_angleBands_3D;for(l=0;l<=e;++l){var r=this.angle*l/e,y=d.scale(this.vec1,k.cos(r),[]);r=d.scale(p,k.sin(r),[]);y=d.scale(d.normalize(d.add(y,r,[])),this.distUse);b.push(this.a2.x+y[0],this.a2.y+y[1],this.a2.z+y[2]);g.push(0,0,0);l<e&&m.push(l,l+1)}this.storeData(b,g,m)};n.getText=function(e){e=d.scale(d.normalize(d.add(this.vec1,this.vec2,[])),this.distUse+.3);return{pos:[this.a2.x+e[0],this.a2.y+e[1],this.a2.z+e[2]],value:[v.angleBounds(this.angle,
!0).toFixed(2)," \u00b0"].join("")}}})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures.d3,ChemDoodle.math,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3);
(function(n,E,w){n.Arrow=function(v,k){for(var q=[],d=[],c=0;c<=k;c++){var e=2*c*E.PI/k,b=E.sin(e);e=E.cos(e);d.push(0,0,-1,0,0,-1,e,b,0,e,b,0,0,0,-1,0,0,-1,e,b,1,e,b,1);q.push(0,0,0,v*e,v*b,0,v*e,v*b,0,v*e,v*b,2,v*e,v*b,2,v*e*2,v*b*2,2,v*e*2,v*b*2,2,0,0,3)}v=[];for(c=0;c<k;c++)for(b=8*c,e=0;7>e;e++){var g=e+b,m=g+7+2;v.push(g,m,g+1,m,g,m-1)}this.storeData(q,d,v)};n.Arrow.prototype=new n._Mesh})(ChemDoodle.structures.d3,Math);
(function(n,E,w){n.Box=function(v,k,q){v/=2;q/=2;var d=[],c=[];d.push(v,k,-q);d.push(v,k,-q);d.push(-v,k,-q);d.push(v,k,q);d.push(-v,k,q);d.push(-v,k,q);for(var e=6;e--;c.push(0,1,0));d.push(-v,k,q);d.push(-v,k,q);d.push(-v,0,q);d.push(v,k,q);d.push(v,0,q);d.push(v,0,q);for(e=6;e--;c.push(0,0,1));d.push(v,k,q);d.push(v,k,q);d.push(v,0,q);d.push(v,k,-q);d.push(v,0,-q);d.push(v,0,-q);for(e=6;e--;c.push(1,0,0));d.push(v,k,-q);d.push(v,k,-q);d.push(v,0,-q);d.push(-v,k,-q);d.push(-v,0,-q);d.push(-v,0,
-q);for(e=6;e--;c.push(0,0,-1));d.push(-v,k,-q);d.push(-v,k,-q);d.push(-v,0,-q);d.push(-v,k,q);d.push(-v,0,q);d.push(-v,0,q);for(k=6;k--;c.push(-1,0,0));d.push(-v,0,q);d.push(-v,0,q);d.push(-v,0,-q);d.push(v,0,q);d.push(v,0,-q);d.push(v,0,-q);for(v=6;v--;c.push(0,-1,0));this.storeData(d,c)};n.Box.prototype=new n._Mesh})(ChemDoodle.structures.d3,Math);
(function(n,E,w,v,k,q){E.Camera=function(){this.fieldOfView=45;this.aspect=1;this.near=.1;this.far=1E4;this.zoom=1;this.viewMatrix=v.identity([]);this.projectionMatrix=v.identity([])};n=E.Camera.prototype;n.perspectiveProjectionMatrix=function(){var d=k.tan(this.fieldOfView/360*k.PI)*this.near*this.zoom,c=this.aspect*d;return v.frustum(-c,c,-d,d,this.near,this.far,this.projectionMatrix)};n.orthogonalProjectionMatrix=function(){var d=k.tan(this.fieldOfView/360*k.PI)*((this.far-this.near)/2+this.near)*
this.zoom,c=this.aspect*d;return v.ortho(-c,c,-d,d,this.near,this.far,this.projectionMatrix)};n.updateProjectionMatrix=function(d){return d?this.perspectiveProjectionMatrix():this.orthogonalProjectionMatrix()};n.focalLength=function(){return(this.far-this.near)/2+this.near};n.zoomOut=function(){this.zoom=k.min(1.25*this.zoom,200)};n.zoomIn=function(){this.zoom=k.max(this.zoom/1.25,.0025)}})(ChemDoodle.math,ChemDoodle.structures.d3,ChemDoodle.lib.vec3,ChemDoodle.lib.mat4,Math);
(function(n,E,w,v){n.LineArrow=function(){this.storeData([0,0,-3,.1,0,-2.8,0,0,-3,-.1,0,-2.8,0,0,-3,0,0,3,0,0,3,.1,0,2.8,0,0,3,-.1,0,2.8],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])};n.LineArrow.prototype=new n._Mesh;n.Compass=function(q,d){this.textImage=new n.TextImage;this.textImage.init(q);this.textImage.updateFont(q,d.text_font_size,d.text_font_families,d.text_font_bold,d.text_font_italic,d.text_font_stroke_3D);this.textMesh=new n.TextMesh;this.textMesh.init(q);var c=3/(d.compass_size_3D/
q.canvas.clientHeight),e=E.tan(d.projectionPerspectiveVerticalFieldOfView_3D/360*E.PI),b=c/e,g=E.max(b-c,.1),m=q.canvas.clientWidth/q.canvas.clientHeight;if(d.projectionPerspective_3D){var p=g;var l=w.frustum}else p=b,l=w.ortho;var r=p/q.canvas.clientHeight*2*e;e*=p;p=-e;var y=m*p;m*=e;if(0===d.compass_type_3D){var x=(-(q.canvas.clientWidth-d.compass_size_3D)/2+this.textImage.charHeight)*r;d=(-(q.canvas.clientHeight-d.compass_size_3D)/2+this.textImage.charHeight)*r;y-=x;m-=x;p-=d;e-=d}this.projectionMatrix=
l(y,m,p,e,g,b+c);this.translationMatrix=w.translate(w.identity([]),[0,0,-b]);c={position:[],texCoord:[],translation:[]};this.textImage.pushVertexData("X",[3.5,0,0],0,c);this.textImage.pushVertexData("Y",[0,3.5,0],0,c);this.textImage.pushVertexData("Z",[0,0,3.5],0,c);this.textMesh.storeData(q,c.position,c.texCoord,c.translation)};var k=n.Compass.prototype;k.renderArrow=function(q,d,c,e){q.material.setDiffuseColor(q,c);q.shader.setModelViewMatrix(q,e);1===d?q.drawArrays(q.LINES,0,q.lineArrowBuffer.vertexPositionBuffer.numItems):
q.drawElements(q.TRIANGLES,q.arrowBuffer.vertexIndexBuffer.numItems,q.UNSIGNED_SHORT,0)};k.render=function(q,d){q.shader.setProjectionMatrix(q,this.projectionMatrix);1===d.compass_type_3D?q.lineArrowBuffer.bindBuffers(q):q.arrowBuffer.bindBuffers(q);q.material.setTempColors(q,d.bonds_materialAmbientColor_3D,v,d.bonds_materialSpecularColor_3D,d.bonds_materialShininess_3D);var c=w.multiply(this.translationMatrix,q.rotationMatrix,[]),e=E.PI/2;this.renderArrow(q,d.compass_type_3D,d.compass_axisXColor_3D,
w.rotateY(c,e,[]));this.renderArrow(q,d.compass_type_3D,d.compass_axisYColor_3D,w.rotateX(c,-e,[]));this.renderArrow(q,d.compass_type_3D,d.compass_axisZColor_3D,c)};k.renderAxis=function(q){q.shader.setProjectionMatrix(q,this.projectionMatrix);var d=w.multiply(this.translationMatrix,q.rotationMatrix,[]);q.shader.setModelViewMatrix(q,d);this.textImage.useTexture(q);this.textMesh.render(q)}})(ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4);
(function(n,E,w){n.Cylinder=function(v,k,q,d){var c=[],e=[];if(d){for(d=0;d<=q;d++){var b=d%q*2*E.PI/q,g=E.cos(b);b=E.sin(b);e.push(0,-1,0);c.push(0,0,0);e.push(0,-1,0);c.push(v*g,0,v*b)}for(d=0;d<=q;d++)b=d%q*2*E.PI/q,g=E.cos(b),b=E.sin(b),e.push(g,0,b),c.push(v*g,0,v*b),e.push(g,0,b),c.push(v*g,k,v*b);for(d=0;d<=q;d++)b=d%q*2*E.PI/q,g=E.cos(b),b=E.sin(b),e.push(0,1,0),c.push(v*g,k,v*b),e.push(0,1,0),c.push(0,k,0)}else{for(d=0;d<q;d++)b=2*d*E.PI/q,g=E.cos(b),b=E.sin(b),e.push(g,0,b),c.push(v*g,0,
v*b),e.push(g,0,b),c.push(v*g,k,v*b);e.push(1,0,0);c.push(v,0,0);e.push(1,0,0);c.push(v,k,0)}this.storeData(c,e)};n.Cylinder.prototype=new n._Mesh})(ChemDoodle.structures.d3,Math);
(function(n,E,w,v,k){E.Distance=function(q,d,c,e){this.a1=q;this.a2=d;this.node=c;this.offset=e?e:0};E=E.Distance.prototype=new E._Measurement;E.calculateData=function(q){var d=[this.a1.x,this.a1.y,this.a1.z,this.a2.x,this.a2.y,this.a2.z];this.node&&(this.move=this.offset+w.max(q.atoms_useVDWDiameters_3D?n[this.a1.label].vdWRadius*q.atoms_vdwMultiplier_3D:q.atoms_sphereDiameter_3D/2,q.atoms_useVDWDiameters_3D?n[this.a2.label].vdWRadius*q.atoms_vdwMultiplier_3D:q.atoms_sphereDiameter_3D/2),this.displacement=
[(this.a1.x+this.a2.x)/2-this.node.x,(this.a1.y+this.a2.y)/2-this.node.y,(this.a1.z+this.a2.z)/2-this.node.z],v.normalize(this.displacement),q=v.scale(this.displacement,this.move,[]),d[0]+=q[0],d[1]+=q[1],d[2]+=q[2],d[3]+=q[0],d[4]+=q[1],d[5]+=q[2]);this.storeData(d,[0,0,0,0,0,0],[0,1])};E.getText=function(q){q=this.a1.distance3D(this.a2);var d=[(this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2,(this.a1.z+this.a2.z)/2];if(this.node){var c=v.scale(this.displacement,this.move+.1,[]);d[0]+=c[0];d[1]+=
c[1];d[2]+=c[2]}return{pos:d,value:[q.toFixed(2)," \u212b"].join("")}}})(ChemDoodle.ELEMENT,ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3);(function(n,E,w,v){E.Fog=function(k,q,d,c){this.fogScene(k,q,d,c)};E.Fog.prototype.fogScene=function(k,q,d,c){this.colorRGB=n.getRGB(k,1);this.fogStart=q;this.fogEnd=d;this.density=c}})(ChemDoodle.math,ChemDoodle.structures.d3,ChemDoodle.lib.vec3);
(function(n,E,w){E.Label=function(v){};E=E.Label.prototype;E.updateVerticesBuffer=function(v,k,q){for(var d=0,c=k.length;d<c;d++){for(var e=k[d],b=e.labelMesh,g=e.atoms,m={position:[],texCoord:[],translation:[]},p=0<g.length&&g[0].hetatm!=w,l=0,r=g.length;l<r;l++){var y=g[l],x=y.label,A=.05;q.atoms_useVDWDiameters_3D?(x=n[x].vdWRadius*q.atoms_vdwMultiplier_3D,0===x&&(x=1),A+=x):q.atoms_sphereDiameter_3D&&(A+=q.atoms_sphereDiameter_3D/2*1.5);if(p)if(!y.hetatm){if(!q.macro_displayAtoms)continue}else if(y.isWater&&
!q.macro_showWaters)continue;v.textImage.pushVertexData(y.altLabel?y.altLabel:y.label,[y.x,y.y,y.z],A,m)}if((e=e.chains)&&(q.proteins_displayRibbon||q.proteins_displayBackbone))for(g=0,p=e.length;g<p;g++)for(l=e[g],r=0,y=l.length;r<y;r++)A=l[r],A.name&&(x=A.cp1,v.textImage.pushVertexData(A.name,[x.x,x.y,x.z],2,m));b.storeData(v,m.position,m.texCoord,m.translation,m.zDepth)}};E.render=function(v,k,q){v.shader.setMatrixUniforms(v);v.textImage.useTexture(v);k=0;for(var d=q.length;k<d;k++)q[k].labelMesh&&
q[k].labelMesh.render(v)}})(ChemDoodle.ELEMENT,ChemDoodle.structures.d3);(function(n,E,w){n.Sphere=function(v,k,q){for(var d=[],c=[],e=0;e<=k;e++){var b=e*E.PI/k,g=E.sin(b);b=E.cos(b);for(var m=0;m<=q;m++){var p=2*m*E.PI/q,l=E.sin(p);p=E.cos(p)*g;var r=b;l*=g;c.push(p,r,l);d.push(v*p,v*r,v*l)}}v=[];q+=1;for(e=0;e<k;e++)for(g=0;g<q;g++)b=e*q+g%q,m=b+q,v.push(b,b+1,m),g<q-1&&v.push(m,b+1,m+1);this.storeData(d,c,v)};n.Sphere.prototype=new n._Mesh})(ChemDoodle.structures.d3,Math);
(function(n,E,w,v,k){function q(c,e,b,g){this.entire=c;this.name=e;this.indexes=b;this.pi=g}var d=q.prototype;d.getColor=function(c){return c.macro_colorByChain?this.entire.chainColor:this.name?this.getResidueColor(n[this.name]?this.name:"*",c):this.helix?this.entire.front?c.proteins_ribbonCartoonHelixPrimaryColor:c.proteins_ribbonCartoonHelixSecondaryColor:this.sheet?c.proteins_ribbonCartoonSheetColor:this.entire.front?c.proteins_primaryColor:c.proteins_secondaryColor};d.getResidueColor=function(c,
e){c=n[c];if("shapely"===e.proteins_residueColor)return c.shapelyColor;if("amino"===e.proteins_residueColor)return c.aminoColor;if("polarity"===e.proteins_residueColor){if(c.polar)return"#C10000"}else if("acidity"===e.proteins_residueColor){if(1===c.acidity)return"#0000FF";if(-1===c.acidity)return"#FF0000";if(!c.polar)return"#773300"}return"#FFFFFF"};d.render=function(c,e,b){if(this.entire.partitions&&this.pi!==this.entire.partitions.lastRender){var g=this.entire.partitions[this.pi];c.bindBuffer(c.ARRAY_BUFFER,
g.vertexPositionBuffer);c.vertexAttribPointer(c.shader.vertexPositionAttribute,g.vertexPositionBuffer.itemSize,c.FLOAT,!1,0,0);c.bindBuffer(c.ARRAY_BUFFER,g.vertexNormalBuffer);c.vertexAttribPointer(c.shader.vertexNormalAttribute,g.vertexNormalBuffer.itemSize,c.FLOAT,!1,0,0);c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,g.vertexIndexBuffer);this.entire.partitions.lastRender=this.pi}this.vertexIndexBuffer||(this.vertexIndexBuffer=c.createBuffer(),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),c.bufferData(c.ELEMENT_ARRAY_BUFFER,
new Uint16Array(this.indexes),c.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexes.length);c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);b||"rainbow"===e.proteins_residueColor||c.material.setDiffuseColor(c,this.getColor(e));c.drawElements(c.TRIANGLES,this.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0)};E.Ribbon=function(c,e,b){var g=c[0].lineSegments.length,m=c[0].lineSegments[0].length;this.partitions=[];this.partitions.lastRender=0;this.front=
0<e;for(var p=0,l=c.length;p<l;p++){if(!r||65E3<r.positionData.length){0<this.partitions.length&&p--;var r={count:0,positionData:[],normalData:[]};this.partitions.push(r)}var y=c[p];r.count++;for(var x=0;x<g;x++)for(var A=b?y.lineSegmentsCartoon[x]:y.lineSegments[x],H=0===x,a=!1,f=0;f<m;f++){var t=A[f],C=p,F=f+1;p===c.length-1&&f===m-1?F--:f===m-1&&(C++,F=0);F=b?c[C].lineSegmentsCartoon[x][F]:c[C].lineSegments[x][F];C=!1;var I=x+1;x===g-1&&(I-=2,C=!0);I=b?y.lineSegmentsCartoon[I][f]:y.lineSegments[I][f];
F=[F.x-t.x,F.y-t.y,F.z-t.z];I=[I.x-t.x,I.y-t.y,I.z-t.z];var L=v.cross(F,I,[]);0===f&&(v.normalize(F),v.scale(F,-1),r.normalData.push(F[0],F[1],F[2]),r.positionData.push(t.x,t.y,t.z));H||a?(v.normalize(I),v.scale(I,-1),r.normalData.push(I[0],I[1],I[2]),r.positionData.push(t.x,t.y,t.z),H&&f===m-1&&(H=!1,f=-1)):(v.normalize(L),(C&&!this.front||!C&&this.front)&&v.scale(L,-1),r.normalData.push(L[0],L[1],L[2]),v.scale(L,w.abs(e)),r.positionData.push(t.x+L[0],t.y+L[1],t.z+L[2]),x===g-1&&f===m-1&&(a=!0,f=
-1));if(-1===f||f===m-1)v.normalize(F),r.normalData.push(F[0],F[1],F[2]),r.positionData.push(t.x,t.y,t.z)}}g+=2;m+=2;this.segments=[];this.partitionSegments=[];e=0;for(r=this.partitions.length;e<r;e++){p=this.partitions[e];x=[];A=k;l=0;for(y=p.count-1;l<y;l++){A=l;for(H=0;H<e;H++)A+=this.partitions[H].count-1;A=c[A];a=l*g*m;H=[];f=0;for(t=g-1;f<t;f++)for(C=a+f*m,F=0;F<m-1;F++)I=1,l===y&&(I=0),I=[C+F,C+m+F,C+m+F+I,C+F,C+F+I,C+m+F+I],F!==m-1&&(this.front?H.push(I[0],I[1],I[2],I[3],I[5],I[4]):H.push(I[0],
I[2],I[1],I[3],I[4],I[5])),F!==m-2||l===p.count-2&&e===this.partitions.length-1||(L=g*m-F,I[2]+=L,I[4]+=L,I[5]+=L),this.front?x.push(I[0],I[1],I[2],I[3],I[5],I[4]):x.push(I[0],I[2],I[1],I[3],I[4],I[5]);b&&A.split&&(x=new q(this,k,x,e),x.helix=A.helix,x.sheet=A.sheet,this.partitionSegments.push(x),x=[]);this.segments.push(new q(this,A.name,H,e))}p=new q(this,k,x,e);p.helix=A.helix;p.sheet=A.sheet;this.partitionSegments.push(p)}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData);
1===this.partitions.length&&(this.partitions=k)};(E.Ribbon.prototype=new E._Mesh).render=function(c,e){this.bindBuffers(c);var b=e.macro_colorByChain?this.chainColor:k;b||(b=this.front?e.proteins_primaryColor:e.proteins_secondaryColor);c.material.setDiffuseColor(c,b);b=0;for(var g=this.partitionSegments.length;b<g;b++)this.partitionSegments[b].render(c,e,!e.proteins_ribbonCartoonize)}})(ChemDoodle.RESIDUE,ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3);
(function(n,E,w,v,k){E.Light=function(q,d,c){this.camera=new E.Camera;this.lightScene(q,d,c)};k=E.Light.prototype;k.lightScene=function(q,d,c){this.diffuseRGB=n.getRGB(q,1);this.specularRGB=n.getRGB(d,1);this.direction=c;this.updateView()};k.updateView=function(){var q=w.normalize(this.direction,[]),d=w.scale(q,(this.camera.near-this.camera.far)/2-this.camera.near,[]);q=w.equal(q,[0,1,0])?[0,0,1]:[0,1,0];v.lookAt(d,[0,0,0],q,this.camera.viewMatrix);this.camera.orthogonalProjectionMatrix()}})(ChemDoodle.math,
ChemDoodle.structures.d3,ChemDoodle.lib.vec3,ChemDoodle.lib.mat4);(function(n,E){n.Line=function(){this.storeData([0,0,0,0,1,0],[0,0,0,0,0,0])};n.Line.prototype=new n._Mesh})(ChemDoodle.structures.d3);
(function(n,E,w){E.Material=function(){};E=E.Material.prototype;E.setTempColors=function(v,k,q,d,c){k&&v.shader.setMaterialAmbientColor(v,n.getRGB(k,1));q&&v.shader.setMaterialDiffuseColor(v,n.getRGB(q,1));d&&v.shader.setMaterialSpecularColor(v,n.getRGB(d,1));v.shader.setMaterialShininess(v,c);v.shader.setMaterialAlpha(v,1)};E.setDiffuseColor=function(v,k){v.shader.setMaterialDiffuseColor(v,n.getRGB(k,1))};E.setAlpha=function(v,k){v.shader.setMaterialAlpha(v,k)}})(ChemDoodle.math,ChemDoodle.structures.d3);
(function(n,E,w,v){n.Picker=function(){};n=n.Picker.prototype;n.init=function(k){this.framebuffer=k.createFramebuffer();var q=k.createTexture(),d=k.createRenderbuffer();k.bindTexture(k.TEXTURE_2D,q);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE);k.bindRenderbuffer(k.RENDERBUFFER,d);k.bindFramebuffer(k.FRAMEBUFFER,
this.framebuffer);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_2D,q,0);k.framebufferRenderbuffer(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,k.RENDERBUFFER,d);k.bindTexture(k.TEXTURE_2D,null);k.bindRenderbuffer(k.RENDERBUFFER,null);k.bindFramebuffer(k.FRAMEBUFFER,null)};n.setDimension=function(k,q,d){k.bindFramebuffer(k.FRAMEBUFFER,this.framebuffer);var c=k.getFramebufferAttachmentParameter(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,k.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);k.isRenderbuffer(c)&&(k.bindRenderbuffer(k.RENDERBUFFER,
c),k.renderbufferStorage(k.RENDERBUFFER,k.DEPTH_COMPONENT16,q,d),k.bindRenderbuffer(k.RENDERBUFFER,null));c=k.getFramebufferAttachmentParameter(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);k.isTexture(c)&&(k.bindTexture(k.TEXTURE_2D,c),k.texImage2D(k.TEXTURE_2D,0,k.RGBA,q,d,0,k.RGBA,k.UNSIGNED_BYTE,null),k.bindTexture(k.TEXTURE_2D,null));k.bindFramebuffer(k.FRAMEBUFFER,null)}})(ChemDoodle.structures.d3,ChemDoodle.math,document);
(function(n,E,w){n.Pill=function(v,k,q,d){var c=1,e=2*v;k-=e;0>k?(c=0,k+=e):k<e&&(c=k/e,k=e);e=[];for(var b=[],g=0;g<=q;g++){var m=g*E.PI/q,p=E.sin(m);m=E.cos(m)*c;for(var l=0;l<=d;l++){var r=2*l*E.PI/d,y=E.sin(r);r=E.cos(r)*p;var x=m;y*=p;b.push(r,x,y);e.push(v*r,v*x+(g<q/2?k:0),v*y)}}v=[];d+=1;for(k=0;k<q;k++)for(c=0;c<d;c++)g=k*d+c%d,p=g+d,v.push(g,g+1,p),c<d-1&&v.push(p,g+1,p+1);this.storeData(e,b,v)};n.Pill.prototype=new n._Mesh})(ChemDoodle.structures.d3,Math);
(function(n,E,w,v,k,q,d,c,e){function b(p,l,r){var y=new w.Residue(-1);y.cp1=y.cp2=new w.Atom("",p,l,r);return y}function g(p,l){this.a1=p;this.a2=l}function m(p,l,r){this.a1=p;this.a2=l;this.vx=r}g.prototype.render=function(p,l){var r=this.a1,y=this.a2,x=1.001*r.distance3D(y);l=l.proteins_cylinderHelixDiameter/2;x=[l,x,l];l=q.translate(q.identity(),[r.x,r.y,r.z]);var A=[0,1,0],H=0;r.x===y.x&&r.z===y.z?(A=[0,0,1],y.y<r.y&&(H=k.PI)):(r=[y.x-r.x,y.y-r.y,y.z-r.z],H=n.vec3AngleFrom(A,r),A=d.cross(A,r,
[]));0!==H&&q.rotate(l,H,A);q.scale(l,x);p.shader.setMatrixUniforms(p,l);p.drawArrays(p.TRIANGLE_STRIP,0,p.cylinderClosedBuffer.vertexPositionBuffer.numItems)};m.prototype.render=function(p,l){this.styles&&(l=this.styles);var r=1.001*this.a1.distance3D(this.a2),y=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],x=d.cross(y,this.vx,[]),A=d.cross(x,y,[]);d.normalize(A);d.normalize(y);d.normalize(x);y=[A[0],A[1],A[2],0,y[0],y[1],y[2],0,x[0],x[1],x[2],0,this.a1.x,this.a1.y,this.a1.z,1];q.scale(y,
[l.proteins_plankSheetWidth,r,l.proteins_tubeThickness]);p.shader.setMatrixUniforms(p,y);p.drawArrays(p.TRIANGLE_STRIP,0,p.boxBuffer.vertexPositionBuffer.numItems)};v.PipePlank=function(p,l){this.tubes=[];this.helixCylinders=[];this.sheetPlanks=[];this.chainColor=p.chainColor;var r=[],y=[],x=[],A=[];if(1<p.length){var H=p[0],a=p[1];a.helix?x.push(H):a.sheet?A.push(H):y.push(H)}H=1;for(a=p.length-1;H<=a;H++){var f=p[H];if(f.helix){if(x.push(f),f.arrow){var t=d.create(),C=d.create();if(1===x.length)t=
[f.guidePointsSmall[0].x,f.guidePointsSmall[0].y,f.guidePointsSmall[0].z],C=f.guidePointsSmall[f.guidePointsSmall.length-1],C=[C.x,C.y,C.z];else if(2===x.length)t=[x[0].cp1.x,x[0].cp1.y,x[0].cp1.z],C=[x[1].cp1.x,x[1].cp1.y,x[1].cp1.z];else{3===x.length&&x.unshift(p[k.max(H-3,0)]);for(var F=[],I=[],L=1,O=x.length-1;L<O;L++){var S=[x[L].cp1.x,x[L].cp1.y,x[L].cp1.z],W=[x[L-1].cp1.x,x[L-1].cp1.y,x[L-1].cp1.z],V=[x[L+1].cp1.x,x[L+1].cp1.y,x[L+1].cp1.z];d.subtract(W,S);d.subtract(V,S);var Y=d.scale(W,d.length(V),
[]);W=d.scale(V,d.length(W),[]);Y=d.normalize(d.add(Y,W,[]));F.push(S);I.push(Y)}x=[];L=0;for(O=F.length-1;L<O;L++){W=F[L];V=I[L];S=F[L+1];Y=I[L+1];var ba=d.normalize(d.cross(V,Y,[])),X=d.subtract(S,W,[]),ca=d.dot(X,ba);ba=d.scale(ba,ca,[]);ba=d.length(ba);X=d.length(X);X=-(ba*ba-X*X)/(2*d.dot(d.subtract(W,S,[]),Y));W=d.add(W,d.scale(V,X,[]),[]);S=d.add(S,d.scale(Y,X,[]),[]);x.push([W,S])}F=x[0][0];I=x[0][1];I=d.subtract(F,I,[]);d.add(F,I,t);F=x[x.length-1][1];I=x[x.length-1][0];I=d.subtract(F,I,
[]);d.add(F,I,C)}x=new w.Atom("",t[0],t[1],t[2]);F=new w.Atom("",C[0],C[1],C[2]);this.helixCylinders.push(new g(x,F));x=[];F=d.subtract(t,C,[]);d.normalize(F);d.scale(F,.5);0<y.length&&(I=d.add(t,F,[]),L=y[y.length-1].cp1,L=d.subtract([L.x,L.y,L.z],I,[]),d.normalize(L),d.scale(L,.5),d.add(I,L),L=new w.Residue(-1),L.cp1=L.cp2=new w.Atom("",I[0],I[1],I[2]),y.push(L),L=b(t[0],t[1],t[2]),y.push(L),r.push(y));y=[];H<a&&(t=b(C[0],C[1],C[2]),y.push(t),t=p[H+1],t.sheet?(y.push(f),y.push(f),r.push(y),y=[],
A.push(f)):(d.scale(F,-1),f=d.add(C,F,[]),C=t.cp1,C=d.subtract([C.x,C.y,C.z],f,[]),d.normalize(C),d.scale(C,.5),d.add(f,C),f=b(f[0],f[1],f[2]),y.push(f)))}}else if(f.sheet){if(A.push(f),f.arrow){t=[0,0,0];F=[0,0,0];C=A.length;for(I=0;I<C;I++)O=A[I].guidePointsLarge,L=O[0],O=O[O.length-1],d.add(t,[L.x,L.y,L.z]),d.add(F,[O.x,O.y,O.z]);d.scale(t,1/C);d.scale(F,1/C);t=d.subtract(t,F);C=A[C-1].guidePointsSmall[0];this.sheetPlanks.push(new m(A[0].guidePointsSmall[0],C,t));A=[];H<a&&(p[H+1].sheet?A.push(f):
(f=b(C.x,C.y,C.z),y.push(f)))}}else y.push(f),H<a&&p[H+1].sheet&&(C=f.guidePointsSmall[0],C=b(C.x,C.y,C.z),y.push(C),r.push(y),y=[],A.push(f))}1<y.length&&(2==y.length&&y.push(y[y.length-1]),r.push(y));y=[];A=0;for(H=r.length;A<H;A++){a=r[A];f=[];C=0;for(t=a.length-1;C<=t;C++)f.push(a[C].cp1);y.push(f)}r=0;for(A=y.length;r<A;r++)H=new v.CatmullTube(y[r],l.proteins_tubeThickness,l.proteins_tubeResolution_3D,l.proteins_horizontalResolution),H.chainColor=p.chainColor,this.tubes.push(H)};(v.PipePlank.prototype=
new v._Mesh).render=function(p,l){p.material.setTempColors(p,l.proteins_materialAmbientColor_3D,e,l.proteins_materialSpecularColor_3D,l.proteins_materialShininess_3D);p.material.setDiffuseColor(p,l.macro_colorByChain?this.chainColor:l.proteins_tubeColor);for(var r=0,y=this.tubes.length;r<y;r++)p.shader.setMatrixUniforms(p),this.tubes[r].render(p,l);l.macro_colorByChain||p.material.setDiffuseColor(p,l.proteins_ribbonCartoonHelixSecondaryColor);p.cylinderClosedBuffer.bindBuffers(p);r=0;for(y=this.helixCylinders.length;r<
y;r++)this.helixCylinders[r].render(p,l);l.macro_colorByChain||p.material.setDiffuseColor(p,l.proteins_ribbonCartoonSheetColor);p.boxBuffer.bindBuffers(p);r=0;for(y=this.sheetPlanks.length;r<y;r++)this.sheetPlanks[r].render(p,l)}})(ChemDoodle.extensions,ChemDoodle.RESIDUE,ChemDoodle.structures,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3,ChemDoodle.math);
(function(n,E){n.Quad=function(){this.storeData([-1,1,0,-1,-1,0,1,1,0,1,-1,0],[0,0,0,0,0,0,0,0,0,0,0,0])};n.Quad.prototype=new n._Mesh})(ChemDoodle.structures.d3);
(function(n,E,w,v){E.Shape=function(k,q){for(var d=k.length,c=[],e=[],b=new n.Point,g=0;g<d;g++){var m=g+1;g===d-1&&(m=0);var p=k[g],l=k[m];m=w.cross([0,0,1],[l.x-p.x,l.y-p.y,0]);for(var r=0;2>r;r++)c.push(p.x,p.y,q/2),c.push(p.x,p.y,-q/2),c.push(l.x,l.y,q/2),c.push(l.x,l.y,-q/2);for(l=0;4>l;l++)e.push(m[0],m[1],m[2]);e.push(0,0,1);e.push(0,0,-1);e.push(0,0,1);e.push(0,0,-1);b.add(p)}b.x/=d;b.y/=d;e.push(0,0,1);c.push(b.x,b.y,q/2);e.push(0,0,-1);c.push(b.x,b.y,-q/2);k=[];q=8*d;for(b=0;b<d;b++)g=8*
b,k.push(g),k.push(g+3),k.push(g+1),k.push(g),k.push(g+2),k.push(g+3),k.push(g+4),k.push(q),k.push(g+6),k.push(g+5),k.push(g+7),k.push(q+1);this.storeData(c,e,k)};E.Shape.prototype=new E._Mesh})(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.lib.vec3);
(function(n,E,w,v){n.Star=function(){for(var k=[.8944,.4472,0,.2764,.4472,.8506,.2764,.4472,-.8506,-.7236,.4472,.5257,-.7236,.4472,-.5257,-.3416,.4472,0,-.1056,.4472,.3249,-.1056,.4472,-.3249,.2764,.4472,.2008,.2764,.4472,-.2008,-.8944,-.4472,0,-.2764,-.4472,.8506,-.2764,-.4472,-.8506,.7236,-.4472,.5257,.7236,-.4472,-.5257,.3416,-.4472,0,.1056,-.4472,.3249,.1056,-.4472,-.3249,-.2764,-.4472,.2008,-.2764,-.4472,-.2008,-.5527,.1058,0,-.1708,.1058,.5527,-.1708,.1058,-.5527,.4471,.1058,.3249,.4471,.1058,
-.3249,.5527,-.1058,0,.1708,-.1058,.5527,.1708,-.1058,-.5527,-.4471,-.1058,.3249,-.4471,-.1058,-.3249,0,1,0,0,-1,0],q=[0,9,8,2,7,9,4,5,7,3,6,5,1,8,6,0,8,23,30,6,8,3,21,6,11,26,21,13,23,26,2,9,24,30,8,9,1,23,8,13,25,23,14,24,25,4,7,22,30,9,7,0,24,9,14,27,24,12,22,27,3,5,20,30,7,5,2,22,7,12,29,22,10,20,29,1,6,21,30,5,6,4,20,5,10,28,20,11,21,28,10,19,18,12,17,19,14,15,17,13,16,15,11,18,16,31,19,17,14,17,27,2,27,22,4,22,29,10,29,19,31,18,19,12,19,29,4,29,20,3,20,28,11,28,18,31,16,18,10,18,28,3,28,21,
1,21,26,13,26,16,31,15,16,11,16,26,1,26,23,0,23,25,14,25,15,31,17,15,13,15,25,0,25,24,2,24,27,12,27,17],d=[],c=[],e=[],b=0,g=q.length;b<g;b+=3){var m=3*q[b],p=3*q[b+1],l=3*q[b+2];m=[k[m],k[m+1],k[m+2]];p=[k[p],k[p+1],k[p+2]];l=[k[l],k[l+1],k[l+2]];var r=w.cross([l[0]-p[0],l[1]-p[1],l[2]-p[2]],[m[0]-p[0],m[1]-p[1],m[2]-p[2]],[]);w.normalize(r);d.push(m[0],m[1],m[2],p[0],p[1],p[2],l[0],l[1],l[2]);c.push(r[0],r[1],r[2],r[0],r[1],r[2],r[0],r[1],r[2]);e.push(b,b+1,b+2)}this.storeData(d,c,e)};n.Star.prototype=
new n._Mesh})(ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3);
(function(n,E,w,v,k){var q=1;v.devicePixelRatio&&(q=v.devicePixelRatio);n.TextImage=function(){this.ctx=w.createElement("canvas").getContext("2d");this.data=[];this.text="";this.charHeight=0};n=n.TextImage.prototype;n.init=function(d){this.textureImage=d.createTexture();d.bindTexture(d.TEXTURE_2D,this.textureImage);d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!1);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,
d.TEXTURE_MIN_FILTER,d.NEAREST);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST);d.bindTexture(d.TEXTURE_2D,null);this.updateFont(d,12,["Sans-serif"],!1,!1,!1)};n.charData=function(d){d=this.text.indexOf(d);return 0<=d?this.data[d]:null};n.updateFont=function(d,c,e,b,g,m){var p=this.ctx,l=this.ctx.canvas,r=[],y="";c*=q;e=E.getFontString(c,e,b,g);p.font=e;p.save();b=0;c*=1.5;for(g=32;127>g;g++){var x=String.fromCharCode(g),A=p.measureText(x).width;r.push({text:x,width:A,height:c});b+=2*
A}g=["\u00b0","\u212b","\u00ae"];x=0;for(A=g.length;x<A;x++){var H=g[x],a=p.measureText(H).width;r.push({text:H,width:a,height:c});b+=2*a}g=Math.ceil(Math.sqrt(b*c)/c);b=Math.ceil(b/(g-1));l.width=b;l.height=g*c;p.font=e;p.textAlign="left";p.textBaseline="middle";p.strokeStyle="#000";p.lineWidth=1.4;p.fillStyle="#fff";x=g=e=0;for(A=r.length;x<A;x++){H=r[x];a=2*H.width;var f=H.height,t=H.text;g+a>b&&(e++,g=0);var C=e*f;m&&p.strokeText(t,g,C+f/2);p.fillText(t,g,C+f/2);H.x=g;H.y=C;y+=t;g+=a}this.text=
y;this.data=r;this.charHeight=c;d.bindTexture(d.TEXTURE_2D,this.textureImage);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,l);d.bindTexture(d.TEXTURE_2D,null)};n.pushVertexData=function(d,c,e,b){var g=d.toString().split(""),m=this.getHeight(),p=this.getWidth();d=-this.textWidth(d)/2/q;for(var l=-this.charHeight/2/q,r=0,y=g.length;r<y;r++){var x=this.charData(g[r]),A=x.width,H=x.x/p,a=H+1.8*x.width/p,f=x.y/m;x=f+x.height/m;var t=d+1.8*A/q,C=this.charHeight/2/q;b.position.push(c[0],c[1],
c[2],c[0],c[1],c[2],c[0],c[1],c[2],c[0],c[1],c[2],c[0],c[1],c[2],c[0],c[1],c[2]);b.texCoord.push(H,f,a,x,a,f,H,f,H,x,a,x);b.translation.push(d,C,e,t,l,e,t,C,e,d,C,e,d,l,e,t,l,e);d=t+(A-1.8*A)/q}};n.getCanvas=function(){return this.ctx.canvas};n.getHeight=function(){return this.getCanvas().height};n.getWidth=function(){return this.getCanvas().width};n.textWidth=function(d){return this.ctx.measureText(d).width};n.test=function(){w.body.appendChild(this.getCanvas())};n.useTexture=function(d){d.bindTexture(d.TEXTURE_2D,
this.textureImage)}})(ChemDoodle.structures.d3,ChemDoodle.extensions,document,window);
(function(n,E,w){n.TextMesh=function(){};n=n.TextMesh.prototype;n.init=function(v){this.vertexPositionBuffer=v.createBuffer();this.vertexTexCoordBuffer=v.createBuffer();this.vertexTranslationBuffer=v.createBuffer()};n.setVertexData=function(v,k,q,d){v.bindBuffer(v.ARRAY_BUFFER,k);v.bufferData(v.ARRAY_BUFFER,new Float32Array(q),v.STATIC_DRAW);k.itemSize=d;k.numItems=q.length/d};n.storeData=function(v,k,q,d){this.setVertexData(v,this.vertexPositionBuffer,k,3);this.setVertexData(v,this.vertexTexCoordBuffer,
q,2);this.setVertexData(v,this.vertexTranslationBuffer,d,3)};n.bindBuffers=function(v){v.bindBuffer(v.ARRAY_BUFFER,this.vertexPositionBuffer);v.vertexAttribPointer(v.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,v.FLOAT,!1,0,0);v.bindBuffer(v.ARRAY_BUFFER,this.vertexTexCoordBuffer);v.vertexAttribPointer(v.shader.vertexTexCoordAttribute,this.vertexTexCoordBuffer.itemSize,v.FLOAT,!1,0,0);v.bindBuffer(v.ARRAY_BUFFER,this.vertexTranslationBuffer);v.vertexAttribPointer(v.shader.vertexNormalAttribute,
this.vertexTranslationBuffer.itemSize,v.FLOAT,!1,0,0)};n.render=function(v){var k=this.vertexPositionBuffer.numItems;k&&(this.bindBuffers(v),v.drawArrays(v.TRIANGLES,0,k))}})(ChemDoodle.structures.d3,Math);
(function(n,E,w,v,k,q,d){w.Torsion=function(c,e,b,g){this.a1=c;this.a2=e;this.a3=b;this.a4=g};n=w.Torsion.prototype=new w._Measurement;n.calculateData=function(c){var e=[],b=[],g=[],m=this.a2.distance3D(this.a1),p=this.a2.distance3D(this.a3);this.distUse=v.min(m,p)/2;p=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z];m=[this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z];var l=[this.a4.x-this.a3.x,this.a4.y-this.a3.y,this.a4.z-this.a3.z],r=q.cross(p,m,[]);l=q.cross(m,l,[]);q.scale(p,
q.length(m));this.torsion=v.atan2(q.dot(p,l),q.dot(r,l));r=q.normalize(q.cross(r,m,[]));p=q.normalize(q.cross(m,r,[]));this.pos=q.add([this.a2.x,this.a2.y,this.a2.z],q.scale(q.normalize(m,[]),this.distUse));l=[];var y=c.measurement_angleBands_3D,x=d;for(c=0;c<=y;++c){var A=this.torsion*c/y;x=q.scale(r,v.cos(A),[]);A=q.scale(p,v.sin(A),[]);x=q.scale(q.normalize(q.add(x,A,[])),this.distUse);0==c&&(l=x);e.push(this.pos[0]+x[0],this.pos[1]+x[1],this.pos[2]+x[2]);b.push(0,0,0);c<y&&g.push(c,c+1)}this.vecText=
q.normalize(q.add(l,x,[]));m=q.normalize(m,[]);q.scale(m,.0625);l=this.torsion-2*v.asin(.125)*this.torsion/v.abs(this.torsion);r=q.scale(r,v.cos(l),[]);p=q.scale(p,v.sin(l),[]);x=q.scale(q.normalize(q.add(r,p,[])),this.distUse);e.push(this.pos[0]+m[0]+x[0],this.pos[1]+m[1]+x[1],this.pos[2]+m[2]+x[2]);b.push(0,0,0);e.push(this.pos[0]-m[0]+x[0],this.pos[1]-m[1]+x[1],this.pos[2]-m[2]+x[2]);b.push(0,0,0);g.push(--c,c+1,c,c+2);this.storeData(e,b,g)};n.getText=function(c){q.add(this.pos,q.scale(this.vecText,
this.distUse+.3,[]));return{pos:this.pos,value:[E.angleBounds(this.torsion,!0,!0).toFixed(2)," \u00b0"].join("")}}})(ChemDoodle.ELEMENT,ChemDoodle.math,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3);
(function(n,E,w,v,k,q,d,c,e){var b=function(m,p){m.bindBuffer(m.ARRAY_BUFFER,p.vertexPositionBuffer);m.vertexAttribPointer(m.shader.vertexPositionAttribute,p.vertexPositionBuffer.itemSize,m.FLOAT,!1,0,0);m.bindBuffer(m.ARRAY_BUFFER,p.vertexNormalBuffer);m.vertexAttribPointer(m.shader.vertexNormalAttribute,p.vertexNormalBuffer.itemSize,m.FLOAT,!1,0,0);m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,p.vertexIndexBuffer)},g=function(m,p,l){var r=k.sqrt(p[1]*p[1]+p[2]*p[2]),y=[1,0,0,0,0,p[2]/r,-p[1]/r,0,0,p[1]/r,
p[2]/r,0,0,0,0,1],x=[1,0,0,0,0,p[2]/r,p[1]/r,0,0,-p[1]/r,p[2]/r,0,0,0,0,1],A=[r,0,-p[0],0,0,1,0,0,p[0],0,r,0,0,0,0,1];p=[r,0,p[0],0,0,1,0,0,-p[0],0,r,0,0,0,0,1];l=[k.cos(l),-k.sin(l),0,0,k.sin(l),k.cos(l),0,0,0,0,1,0,0,0,0,1];var H=q.multiply(y,q.multiply(A,q.multiply(l,q.multiply(p,x,[]))));this.rotate=function(){return q.multiplyVec3(H,m)}};v.Tube=function(m,p,l){var r=m[0].lineSegments[0].length;this.partitions=[];this.ends=[];this.ends.push(m[0].lineSegments[0][0]);this.ends.push(m[m.length-1].lineSegments[0][0]);
for(var y=[1,0,0],x=0,A=m.length;x<A;x++){if(!H||65E3<H.positionData.length){0<this.partitions.length&&x--;var H={count:0,positionData:[],normalData:[],indexData:[]};this.partitions.push(H)}var a=m[x];H.count++;for(var f=Infinity,t=new w.Atom("",m[x].cp1.x,m[x].cp1.y,m[x].cp1.z),C=0;C<r;C++){var F=a.lineSegments[0][C],I=void 0;I=C===r-1?x===m.length-1?a.lineSegments[0][C-1]:m[x+1].lineSegments[0][0]:a.lineSegments[0][C+1];I=[I.x-F.x,I.y-F.y,I.z-F.z];d.normalize(I);x===m.length-1&&C===r-1&&d.scale(I,
-1);var L=d.cross(I,y,[]);d.normalize(L);d.scale(L,p/2);I=new g(L,I,2*Math.PI/l);L=0;for(var O=l;L<O;L++){var S=I.rotate();L===k.floor(l/4)&&(y=[S[0],S[1],S[2]]);H.normalData.push(S[0],S[1],S[2]);H.positionData.push(F.x+S[0],F.y+S[1],F.z+S[2])}t&&(I=F.distance3D(t),I<f&&(f=I,m[x].pPoint=F))}}H=0;for(y=this.partitions.length;H<y;H++)for(x=this.partitions[H],A=0,a=x.count-1;A<a;A++)for(f=A*r*l,t=0,C=r;t<C;t++)for(F=f+t*l,I=0;I<l;I++)L=F+I,x.indexData.push(L),x.indexData.push(L+l),x.indexData.push(L+
l+1),x.indexData.push(L),x.indexData.push(L+l+1),x.indexData.push(L+1);this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData);l=[new w.Point(2,0)];for(r=0;60>r;r++)H=r/60*k.PI,l.push(new w.Point(2*k.cos(H),-2*k.sin(H)));l.push(new w.Point(-2,0),new w.Point(-2,4),new w.Point(2,4));var W=new w.d3.Shape(l,1);this.render=function(V,Y){this.bindBuffers(V);V.material.setDiffuseColor(V,Y.macro_colorByChain?this.chainColor:Y.nucleics_tubeColor);V.drawElements(V.TRIANGLES,
this.vertexIndexBuffer.numItems,V.UNSIGNED_SHORT,0);if(this.partitions)for(var ba=1,X=this.partitions.length;ba<X;ba++){var ca=this.partitions[ba];b(V,ca);V.drawElements(V.TRIANGLES,ca.vertexIndexBuffer.numItems,V.UNSIGNED_SHORT,0)}V.sphereBuffer.bindBuffers(V);for(ba=0;2>ba;ba++)X=this.ends[ba],X=q.translate(q.identity(),[X.x,X.y,X.z]),ca=p/2,q.scale(X,[ca,ca,ca]),V.shader.setMatrixUniforms(V,X),V.drawElements(V.TRIANGLES,V.sphereBuffer.vertexIndexBuffer.numItems,V.UNSIGNED_SHORT,0);V.cylinderBuffer.bindBuffers(V);
ba=0;for(X=m.length-1;ba<X;ba++){var ia=m[ba];ca=ia.pPoint;ia=new w.Atom("",ia.cp2.x,ia.cp2.y,ia.cp2.z);var Z=1.001*ca.distance3D(ia);Z=[p/4,Z,p/4];var oa=q.translate(q.identity(),[ca.x,ca.y,ca.z]),ka=[0,1,0],na=0,pa=[ia.x-ca.x,ia.y-ca.y,ia.z-ca.z];ca.x===ia.x&&ca.z===ia.z?(ia=[0,0,1],ca.y<ca.y&&(na=k.PI)):(na=n.vec3AngleFrom(ka,pa),ia=d.cross(ka,pa,[]));0!==na&&q.rotate(oa,na,ia);q.scale(oa,Z);V.shader.setMatrixUniforms(V,oa);V.drawArrays(V.TRIANGLE_STRIP,0,V.cylinderBuffer.vertexPositionBuffer.numItems)}W.bindBuffers(V);
"none"!==Y.nucleics_residueColor||Y.macro_colorByChain||V.material.setDiffuseColor(V,Y.nucleics_baseColor);ba=0;for(X=m.length-1;ba<X;ba++)if(ca=m[ba],oa=ca.cp2,ia=q.translate(q.identity(),[oa.x,oa.y,oa.z]),ka=[0,1,0],na=0,pa=ca.cp3){Z=[pa.x-oa.x,pa.y-oa.y,pa.z-oa.z];oa.x===pa.x&&oa.z===pa.z?(ka=[0,0,1],oa.y<oa.y&&(na=k.PI)):(na=n.vec3AngleFrom(ka,Z),ka=d.cross(ka,Z,[]));0!==na&&q.rotate(ia,na,ka);oa=[1,0,0];na=q.rotate(q.identity([]),na,ka);q.multiplyVec3(na,oa);na=ca.cp4;ka=ca.cp5;if(na.y!==ka.y||
na.z!==ka.z)na=[ka.x-na.x,ka.y-na.y,ka.z-na.z],ka=n.vec3AngleFrom(oa,na),0>d.dot(Z,d.cross(oa,na))&&(ka*=-1),q.rotateY(ia,ka);Y.macro_colorByChain||("shapely"===Y.nucleics_residueColor?E[ca.name]?V.material.setDiffuseColor(V,E[ca.name].shapelyColor):V.material.setDiffuseColor(V,E["*"].shapelyColor):"rainbow"===Y.nucleics_residueColor&&V.material.setDiffuseColor(V,c.rainbowAt(ba,X,Y.macro_rainbowColors)));V.shader.setMatrixUniforms(V,ia);V.drawElements(V.TRIANGLES,W.vertexIndexBuffer.numItems,V.UNSIGNED_SHORT,
0)}}};v.Tube.prototype=new v._Mesh;v.CatmullTube=function(m,p,l,r){var y=[];m.push(m[m.length-1]);for(var x=0,A=m.length-2;x<=A;x++){for(var H=m[0==x?0:x-1],a=m[x+0],f=m[x+1],t=m[x==A?x+1:x+2],C=[],F=0;F<r;F++){var I=F/r;x==A&&(I=F/(r-1));I=new w.Atom("C",.5*(2*a.x+(f.x-H.x)*I+(2*H.x-5*a.x+4*f.x-t.x)*I*I+(3*a.x-H.x-3*f.x+t.x)*I*I*I),.5*(2*a.y+(f.y-H.y)*I+(2*H.y-5*a.y+4*f.y-t.y)*I*I+(3*a.y-H.y-3*f.y+t.y)*I*I*I),.5*(2*a.z+(f.z-H.z)*I+(2*H.z-5*a.z+4*f.z-t.z)*I*I+(3*a.z-H.z-3*f.z+t.z)*I*I*I));C.push(I)}y.push(C)}m=
y[0].length;this.partitions=[];this.ends=[];this.ends.push(y[0][0]);this.ends.push(y[y.length-1][0]);r=[1,0,0];x=0;for(A=y.length;x<A;x++){if(!L||65E3<L.positionData.length){0<this.partitions.length&&x--;var L={count:0,positionData:[],normalData:[],indexData:[]};this.partitions.push(L)}H=y[x];L.count++;for(a=0;a<m;a++)for(f=H[a],t=a===m-1?x===y.length-1?H[a-1]:y[x+1][0]:H[a+1],t=[t.x-f.x,t.y-f.y,t.z-f.z],d.normalize(t),x===y.length-1&&a===m-1&&d.scale(t,-1),C=d.cross(t,r,[]),d.normalize(C),d.scale(C,
p/2),t=new g(C,t,2*Math.PI/l),C=0,F=l;C<F;C++)I=t.rotate(),C===k.floor(l/4)&&(r=[I[0],I[1],I[2]]),L.normalData.push(I[0],I[1],I[2]),L.positionData.push(f.x+I[0],f.y+I[1],f.z+I[2])}p=0;for(y=this.partitions.length;p<y;p++)for(L=this.partitions[p],r=0,x=L.count-1;r<x;r++)for(A=r*m*l,H=0,a=m;H<a;H++)for(f=A+H*l,t=0;t<=l;t++)C=f+t%l,L.indexData.push(C,C+l);this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData)};(v.CatmullTube.prototype=new v._Mesh).render=
function(m,p){this.bindBuffers(m);for(var l=0,r=this.partitions.length;l<r;l++){var y=this.partitions[l];b(m,y);m.drawElements(m.TRIANGLE_STRIP,y.vertexIndexBuffer.numItems,m.UNSIGNED_SHORT,0)}m.sphereBuffer.bindBuffers(m);for(l=0;2>l;l++)r=this.ends[l],r=q.translate(q.identity(),[r.x,r.y,r.z]),y=p.proteins_tubeThickness/2,q.scale(r,[y,y,y]),m.shader.setMatrixUniforms(m,r),m.drawElements(m.TRIANGLES,m.sphereBuffer.vertexIndexBuffer.numItems,m.UNSIGNED_SHORT,0)}})(ChemDoodle.extensions,ChemDoodle.RESIDUE,
ChemDoodle.structures,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3,ChemDoodle.math);
(function(n,E,w){n.UnitCell=function(v){this.unitCell=v;var k=[],q=[],d=function(e,b,g,m){k.push(e[0],e[1],e[2]);k.push(b[0],b[1],b[2]);k.push(g[0],g[1],g[2]);k.push(m[0],m[1],m[2]);for(e=0;4>e;e++)q.push(0,0,0)};d(v.o,v.x,v.xy,v.y);d(v.o,v.y,v.yz,v.z);d(v.o,v.z,v.xz,v.x);d(v.yz,v.y,v.xy,v.xyz);d(v.xyz,v.xz,v.z,v.yz);d(v.xy,v.x,v.xz,v.xyz);v=[];for(d=0;6>d;d++){var c=4*d;v.push(c,c+1,c+1,c+2,c+2,c+3,c+3,c)}this.storeData(k,q,v)};(n.UnitCell.prototype=new n._Mesh).render=function(v,k){v.shader.setMatrixUniforms(v);
this.bindBuffers(v);v.material.setDiffuseColor(v,k.shapes_color);v.lineWidth(k.shapes_lineWidth);v.drawElements(v.LINES,this.vertexIndexBuffer.numItems,v.UNSIGNED_SHORT,0)}})(ChemDoodle.structures.d3,ChemDoodle.lib.vec3);
(function(n,E,w,v){n.Framebuffer=function(){};n=n.Framebuffer.prototype;n.init=function(k){this.framebuffer=k.createFramebuffer()};n.setColorTexture=function(k,q,d){d=d===v?0:d;k.bindFramebuffer(k.FRAMEBUFFER,this.framebuffer);k.bindTexture(k.TEXTURE_2D,q);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0+d,k.TEXTURE_2D,q,0);k.bindTexture(k.TEXTURE_2D,null);k.bindFramebuffer(k.FRAMEBUFFER,null)};n.setColorRenderbuffer=function(k,q,d){d=d===v?0:d;k.bindFramebuffer(k.FRAMEBUFFER,this.framebuffer);
k.bindRenderbuffer(k.RENDERBUFFER,q);k.framebufferRenderbuffer(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0+d,k.RENDERBUFFER,q);k.bindRenderbuffer(k.RENDERBUFFER,null);k.bindFramebuffer(k.FRAMEBUFFER,null)};n.setDepthTexture=function(k,q){k.bindFramebuffer(k.FRAMEBUFFER,this.framebuffer);k.bindTexture(k.TEXTURE_2D,q);k.framebufferTexture2D(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,k.TEXTURE_2D,q,0);k.bindTexture(k.TEXTURE_2D,null);k.bindFramebuffer(k.FRAMEBUFFER,null)};n.setDepthRenderbuffer=function(k,q){k.bindFramebuffer(k.FRAMEBUFFER,
this.framebuffer);k.bindRenderbuffer(k.RENDERBUFFER,q);k.framebufferRenderbuffer(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,k.RENDERBUFFER,q);k.bindRenderbuffer(k.RENDERBUFFER,null);k.bindFramebuffer(k.FRAMEBUFFER,null)};n.bind=function(k,q,d){k.bindFramebuffer(k.FRAMEBUFFER,this.framebuffer);k.viewport(0,0,q,d)}})(ChemDoodle.structures.d3,ChemDoodle.math,document);
(function(n,E,w,v){n.Renderbuffer=function(){};n=n.Renderbuffer.prototype;n.init=function(k,q){this.renderbuffer=k.createRenderbuffer();this.format=q};n.setParameter=function(k,q,d){this.width=q;this.height=d;k.bindRenderbuffer(k.RENDERBUFFER,this.renderbuffer);k.renderbufferStorage(k.RENDERBUFFER,this.format,this.width,this.height);k.bindRenderbuffer(k.RENDERBUFFER,null)}})(ChemDoodle.structures.d3,ChemDoodle.math,document);
(function(n,E,w,v){E.SSAO=function(){};n=E.SSAO.prototype;n.initSampleKernel=function(k){for(var q=[],d=0;d<k;d++){var c=2*w.random()-1,e=2*w.random()-1,b=2*w.random()-1,g=d/k;g=.1+g*g*.9;c*=g;e*=g;b*=g;q.push(c,e,b)}this.sampleKernel=new Float32Array(q)};n.initNoiseTexture=function(k){for(var q=[],d=0;16>d;d++)q.push(2*w.random()-1),q.push(2*w.random()-1),q.push(0);this.noiseTexture=k.createTexture();k.bindTexture(k.TEXTURE_2D,this.noiseTexture);k.texImage2D(k.TEXTURE_2D,0,k.RGB,4,4,0,k.RGB,k.FLOAT,
new Float32Array(q));k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.REPEAT);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.REPEAT);k.bindTexture(k.TEXTURE_2D,null)}})(ChemDoodle.math,ChemDoodle.structures.d3,Math);
(function(n,E,w,v){n.Texture=function(){};n=n.Texture.prototype;n.init=function(k,q,d,c){this.texture=k.createTexture();this.type=q;this.internalFormat=d;this.format=c!==v?c:d;k.bindTexture(k.TEXTURE_2D,this.texture);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE);k.bindTexture(k.TEXTURE_2D,null)};n.setParameter=
function(k,q,d){this.width=q;this.height=d;k.bindTexture(k.TEXTURE_2D,this.texture);k.texImage2D(k.TEXTURE_2D,0,this.internalFormat,this.width,this.height,0,this.format,this.type,null);k.bindTexture(k.TEXTURE_2D,null)}})(ChemDoodle.structures.d3,ChemDoodle.math,document);
(function(n,E,w,v,k){n._Shader=function(){};n=n._Shader.prototype;n.useShaderProgram=function(q){q.useProgram(this.gProgram);q.shader=this};n.init=function(q){var d=this.getShader(q,"vertex-shader");d||(d=this.loadDefaultVertexShader(q));var c=this.getShader(q,"fragment-shader");c||(c=this.loadDefaultFragmentShader(q));this.gProgram=q.createProgram();q.attachShader(this.gProgram,d);q.attachShader(this.gProgram,c);this.onShaderAttached(q);q.linkProgram(this.gProgram);q.getProgramParameter(this.gProgram,
q.LINK_STATUS)||alert("Could not initialize shaders: "+q.getProgramInfoLog(this.gProgram));q.useProgram(this.gProgram);this.initUniformLocations(q);q.useProgram(null)};n.onShaderAttached=function(q){this.vertexPositionAttribute=0;this.vertexNormalAttribute=1;q.bindAttribLocation(this.gProgram,this.vertexPositionAttribute,"a_vertex_position");q.bindAttribLocation(this.gProgram,this.vertexNormalAttribute,"a_vertex_normal")};n.getShaderFromStr=function(q,d,c){d=q.createShader(d);q.shaderSource(d,c);
q.compileShader(d);return q.getShaderParameter(d,q.COMPILE_STATUS)?d:(alert(shaderScript.type+" "+q.getShaderInfoLog(d)),q.deleteShader(d),k)};n.enableAttribsArray=function(q){q.enableVertexAttribArray(this.vertexPositionAttribute)};n.disableAttribsArray=function(q){q.disableVertexAttribArray(this.vertexPositionAttribute)};n.getShader=function(q,d){d=v.getElementById(d);if(!d)return k;for(var c=[],e=d.firstChild;e;)3===e.nodeType&&c.push(e.textContent),e=e.nextSibling;c=c.join("");if("x-shader/x-fragment"===
d.type)q=this.getShaderFromStr(q,q.FRAGMENT_SHADER,c);else if("x-shader/x-vertex"===d.type)q=this.getShaderFromStr(q,q.VERTEX_SHADER,c);else return k;return q};n.initUniformLocations=function(q){this.modelViewMatrixUniform=q.getUniformLocation(this.gProgram,"u_model_view_matrix");this.projectionMatrixUniform=q.getUniformLocation(this.gProgram,"u_projection_matrix")};n.loadDefaultVertexShader=function(q){};n.loadDefaultFragmentShader=function(q){};n.setMatrixUniforms=function(q,d){d===k?this.setModelViewMatrix(q,
q.modelViewMatrix):this.setModelViewMatrix(q,w.multiply(q.modelViewMatrix,d,[]))};n.setProjectionMatrix=function(q,d){q.uniformMatrix4fv(this.projectionMatrixUniform,!1,d)};n.setModelViewMatrix=function(q,d){q.uniformMatrix4fv(this.modelViewMatrixUniform,!1,d)};n.setMaterialAmbientColor=function(q,d){};n.setMaterialDiffuseColor=function(q,d){};n.setMaterialSpecularColor=function(q,d){};n.setMaterialShininess=function(q,d){};n.setMaterialAlpha=function(q,d){}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,
ChemDoodle.lib.mat4,document);
(function(n,E,w,v,k){n.FXAAShader=function(){};var q=n._Shader.prototype;n=n.FXAAShader.prototype=new n._Shader;n.initUniformLocations=function(d){q.initUniformLocations.call(this,d);this.buffersizeUniform=d.getUniformLocation(this.gProgram,"u_buffersize");this.antialiasUniform=d.getUniformLocation(this.gProgram,"u_antialias");this.edgeThresholdUniform=d.getUniformLocation(this.gProgram,"u_edge_threshold");this.edgeThresholdMinUniform=d.getUniformLocation(this.gProgram,"u_edge_threshold_min");this.searchStepsUniform=
d.getUniformLocation(this.gProgram,"u_search_steps");this.searchThresholdUniform=d.getUniformLocation(this.gProgram,"u_search_threshold");this.subpixCapUniform=d.getUniformLocation(this.gProgram,"u_subpix_cap");this.subpixTrimUniform=d.getUniformLocation(this.gProgram,"u_subpix_trim")};n.setBuffersize=function(d,c,e){d.uniform2f(this.buffersizeUniform,c,e)};n.setAntialias=function(d,c){d.uniform1f(this.antialiasUniform,c)};n.setEdgeThreshold=function(d,c){d.uniform1f(this.edgeThresholdUniform,c)};
n.setEdgeThresholdMin=function(d,c){d.uniform1f(this.edgeThresholdMinUniform,c)};n.setSearchSteps=function(d,c){d.uniform1i(this.searchStepsUniform,c)};n.setSearchThreshold=function(d,c){d.uniform1f(this.searchThresholdUniform,c)};n.setSubpixCap=function(d,c){d.uniform1f(this.subpixCapUniform,c)};n.setSubpixTrim=function(d,c){d.uniform1f(this.subpixTrimUniform,c)};n.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;varying vec2 v_texcoord;void main() {gl_Position = vec4(a_vertex_position, 1.);v_texcoord = a_vertex_position.xy * .5 + .5;}")};
n.loadDefaultFragmentShader=function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,"precision mediump float;\nconst int fxaaMaxSearchSteps = 128;\nuniform float u_edge_threshold;\nuniform float u_edge_threshold_min;\nuniform int u_search_steps;\nuniform float u_search_threshold;\nuniform float u_subpix_cap;\nuniform float u_subpix_trim;\nuniform sampler2D u_sampler0;\nuniform vec2 u_buffersize;\nuniform bool u_antialias;\nvarying vec2 v_texcoord;\nfloat FxaaLuma(vec3 rgb) {\nreturn rgb.y * (0.587/0.299) + rgb.x;\n}\nvec3 FxaaLerp3(vec3 a, vec3 b, float amountOfA) {\nreturn (vec3(-amountOfA) * b) + ((a * vec3(amountOfA)) + b);\n}\nvec4 FxaaTexOff(sampler2D tex, vec2 pos, vec2 off, vec2 rcpFrame) {\nreturn texture2D(tex, pos + off * rcpFrame);\n}\nvec3 FxaaPixelShader(vec2 pos, sampler2D tex, vec2 rcpFrame) {\nfloat subpix_trim_scale = (1.0/(1.0 - u_subpix_trim));\nvec3 rgbN = FxaaTexOff(tex, pos.xy, vec2( 0.,-1.), rcpFrame).xyz;\nvec3 rgbW = FxaaTexOff(tex, pos.xy, vec2(-1., 0.), rcpFrame).xyz;\nvec3 rgbM = FxaaTexOff(tex, pos.xy, vec2( 0., 0.), rcpFrame).xyz;\nvec3 rgbE = FxaaTexOff(tex, pos.xy, vec2( 1., 0.), rcpFrame).xyz;\nvec3 rgbS = FxaaTexOff(tex, pos.xy, vec2( 0., 1.), rcpFrame).xyz;\nfloat lumaN = FxaaLuma(rgbN);\nfloat lumaW = FxaaLuma(rgbW);\nfloat lumaM = FxaaLuma(rgbM);\nfloat lumaE = FxaaLuma(rgbE);\nfloat lumaS = FxaaLuma(rgbS);\nfloat rangeMin = min(lumaM, min(min(lumaN, lumaW), min(lumaS, lumaE)));\nfloat rangeMax = max(lumaM, max(max(lumaN, lumaW), max(lumaS, lumaE)));\nfloat range = rangeMax - rangeMin;\nif(range < max(u_edge_threshold_min, rangeMax * u_edge_threshold)) {\nreturn rgbM;\n}\nvec3 rgbL = rgbN + rgbW + rgbM + rgbE + rgbS;\nfloat lumaL = (lumaN + lumaW + lumaE + lumaS) * 0.25;\nfloat rangeL = abs(lumaL - lumaM);\nfloat blendL = max(0.0, (rangeL / range) - u_subpix_trim) * subpix_trim_scale;\nblendL = min(u_subpix_cap, blendL);\nvec3 rgbNW = FxaaTexOff(tex, pos.xy, vec2(-1.,-1.), rcpFrame).xyz;\nvec3 rgbNE = FxaaTexOff(tex, pos.xy, vec2( 1.,-1.), rcpFrame).xyz;\nvec3 rgbSW = FxaaTexOff(tex, pos.xy, vec2(-1., 1.), rcpFrame).xyz;\nvec3 rgbSE = FxaaTexOff(tex, pos.xy, vec2( 1., 1.), rcpFrame).xyz;\nrgbL += (rgbNW + rgbNE + rgbSW + rgbSE);\nrgbL *= vec3(1.0/9.0);\nfloat lumaNW = FxaaLuma(rgbNW);\nfloat lumaNE = FxaaLuma(rgbNE);\nfloat lumaSW = FxaaLuma(rgbSW);\nfloat lumaSE = FxaaLuma(rgbSE);\nfloat edgeVert =\nabs((0.25 * lumaNW) + (-0.5 * lumaN) + (0.25 * lumaNE)) +\nabs((0.50 * lumaW ) + (-1.0 * lumaM) + (0.50 * lumaE )) +\nabs((0.25 * lumaSW) + (-0.5 * lumaS) + (0.25 * lumaSE));\nfloat edgeHorz =\nabs((0.25 * lumaNW) + (-0.5 * lumaW) + (0.25 * lumaSW)) +\nabs((0.50 * lumaN ) + (-1.0 * lumaM) + (0.50 * lumaS )) +\nabs((0.25 * lumaNE) + (-0.5 * lumaE) + (0.25 * lumaSE));\nbool horzSpan = edgeHorz >= edgeVert;\nfloat lengthSign = horzSpan ? -rcpFrame.y : -rcpFrame.x;\nif(!horzSpan) {\nlumaN = lumaW;\nlumaS = lumaE;\n}\nfloat gradientN = abs(lumaN - lumaM);\nfloat gradientS = abs(lumaS - lumaM);\nlumaN = (lumaN + lumaM) * 0.5;\nlumaS = (lumaS + lumaM) * 0.5;\nif (gradientN < gradientS) {\nlumaN = lumaS;\nlumaN = lumaS;\ngradientN = gradientS;\nlengthSign *= -1.0;\n}\nvec2 posN;\nposN.x = pos.x + (horzSpan ? 0.0 : lengthSign * 0.5);\nposN.y = pos.y + (horzSpan ? lengthSign * 0.5 : 0.0);\ngradientN *= u_search_threshold;\nvec2 posP = posN;\nvec2 offNP = horzSpan ? vec2(rcpFrame.x, 0.0) : vec2(0.0, rcpFrame.y);\nfloat lumaEndN = lumaN;\nfloat lumaEndP = lumaN;\nbool doneN = false;\nbool doneP = false;\nposN += offNP * vec2(-1.0, -1.0);\nposP += offNP * vec2( 1.0,  1.0);\nfor(int i = 0; i < fxaaMaxSearchSteps; i++) {\nif(i >= u_search_steps) break;\nif(!doneN) {\nlumaEndN = FxaaLuma(texture2D(tex, posN.xy).xyz);\n}\nif(!doneP) {\nlumaEndP = FxaaLuma(texture2D(tex, posP.xy).xyz);\n}\ndoneN = doneN || (abs(lumaEndN - lumaN) >= gradientN);\ndoneP = doneP || (abs(lumaEndP - lumaN) >= gradientN);\nif(doneN && doneP) {\nbreak;\n}\nif(!doneN) {\nposN -= offNP;\n}\nif(!doneP) {\nposP += offNP;\n}\n}\nfloat dstN = horzSpan ? pos.x - posN.x : pos.y - posN.y;\nfloat dstP = horzSpan ? posP.x - pos.x : posP.y - pos.y;\nbool directionN = dstN < dstP;\nlumaEndN = directionN ? lumaEndN : lumaEndP;\nif(((lumaM - lumaN) < 0.0) == ((lumaEndN - lumaN) < 0.0)) {\nlengthSign = 0.0;\n}\nfloat spanLength = (dstP + dstN);\ndstN = directionN ? dstN : dstP;\nfloat subPixelOffset = (0.5 + (dstN * (-1.0/spanLength))) * lengthSign;\nvec3 rgbF = texture2D(tex, vec2(\npos.x + (horzSpan ? 0.0 : subPixelOffset),\npos.y + (horzSpan ? subPixelOffset : 0.0))).xyz;\nreturn FxaaLerp3(rgbL, rgbF, blendL);\n}\nvoid main() {\ngl_FragColor = texture2D(u_sampler0, v_texcoord);\nif(u_antialias) {\ngl_FragColor.xyz = FxaaPixelShader(v_texcoord, u_sampler0, 1. / u_buffersize).xyz;\n}\n}")}})(ChemDoodle.structures.d3,
ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,w,v,k){n.LabelShader=function(){};var q=n._Shader.prototype;n=n.LabelShader.prototype=new n._Shader;n.initUniformLocations=function(d){q.initUniformLocations.call(this,d);this.dimensionUniform=d.getUniformLocation(this.gProgram,"u_dimension")};n.onShaderAttached=function(d){q.onShaderAttached.call(this,d);this.vertexTexCoordAttribute=2;d.bindAttribLocation(this.gProgram,this.vertexTexCoordAttribute,"a_vertex_texcoord")};n.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,
d.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;attribute vec3 a_vertex_normal;attribute vec2 a_vertex_texcoord;uniform mat4 u_model_view_matrix;uniform mat4 u_projection_matrix;uniform vec2 u_dimension;varying vec2 v_texcoord;void main() {gl_Position = u_model_view_matrix * vec4(a_vertex_position, 1.);vec4 depth_pos = vec4(gl_Position);depth_pos.z += a_vertex_normal.z;gl_Position = u_projection_matrix * gl_Position;depth_pos = u_projection_matrix * depth_pos;gl_Position /= gl_Position.w;gl_Position.xy += a_vertex_normal.xy / u_dimension * 2.;gl_Position.z = depth_pos.z / depth_pos.w;v_texcoord = a_vertex_texcoord;}")};
n.loadDefaultFragmentShader=function(d){var c=[d.depthTextureExt?"#define CWC_DEPTH_TEX\n":"","precision mediump float;uniform sampler2D u_image;varying vec2 v_texcoord;void main(void) {gl_FragColor = texture2D(u_image, v_texcoord);}"].join("");return this.getShaderFromStr(d,d.FRAGMENT_SHADER,c)};n.enableAttribsArray=function(d){q.enableAttribsArray.call(this,d);d.enableVertexAttribArray(this.vertexNormalAttribute);d.enableVertexAttribArray(this.vertexTexCoordAttribute)};n.disableAttribsArray=function(d){q.disableAttribsArray.call(this,
d);d.disableVertexAttribArray(this.vertexNormalAttribute);d.disableVertexAttribArray(this.vertexTexCoordAttribute)};n.setDimension=function(d,c,e){d.uniform2f(this.dimensionUniform,c,e)}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,w,v,k){n.LightingShader=function(){};var q=n._Shader.prototype;n=n.LightingShader.prototype=new n._Shader;n.initUniformLocations=function(d){q.initUniformLocations.call(this,d);this.positionSampleUniform=d.getUniformLocation(this.gProgram,"u_position_sample");this.colorSampleUniform=d.getUniformLocation(this.gProgram,"u_color_sample");this.ssaoSampleUniform=d.getUniformLocation(this.gProgram,"u_ssao_sample");this.outlineSampleUniform=d.getUniformLocation(this.gProgram,"u_outline_sample")};
n.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;varying vec2 v_texcoord;void main() {gl_Position = vec4(a_vertex_position, 1.);v_texcoord = a_vertex_position.xy * .5 + .5;}")};n.loadDefaultFragmentShader=function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,"precision mediump float;uniform sampler2D u_position_sample;uniform sampler2D u_color_sample;uniform sampler2D u_ssao_sample;uniform sampler2D u_outline_sample;varying vec2 v_texcoord;void main() {vec4 position = texture2D(u_position_sample, v_texcoord);vec4 color = texture2D(u_color_sample, v_texcoord);vec4 ao = texture2D(u_ssao_sample, v_texcoord);float outline = texture2D(u_outline_sample, v_texcoord).r;if(position.w == 0. && outline == 1.) {return;}gl_FragColor = vec4(color.rgb * ao.r * outline, 1.);}")}})(ChemDoodle.structures.d3,
ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,w,v,k){n.NormalShader=function(){};var q=n._Shader.prototype;n=n.NormalShader.prototype=new n._Shader;n.initUniformLocations=function(d){q.initUniformLocations.call(this,d);this.normalMatrixUniform=d.getUniformLocation(this.gProgram,"u_normal_matrix")};n.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;attribute vec3 a_vertex_normal;uniform mat4 u_model_view_matrix;uniform mat4 u_projection_matrix;uniform mat3 u_normal_matrix;varying vec3 v_normal;void main() {v_normal = length(a_vertex_normal)==0. ? a_vertex_normal : u_normal_matrix * a_vertex_normal;gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.);}")};n.loadDefaultFragmentShader=
function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,"precision mediump float;varying vec3 v_normal;void main(void) {vec3 normal = length(v_normal)==0. ? vec3(0., 0., 1.) : normalize(v_normal);gl_FragColor = vec4(normal, 0.);}")};n.enableAttribsArray=function(d){q.enableAttribsArray.call(this,d);d.enableVertexAttribArray(this.vertexNormalAttribute)};n.disableAttribsArray=function(d){q.disableAttribsArray.call(this,d);d.disableVertexAttribArray(this.vertexNormalAttribute)};n.setModelViewMatrix=
function(d,c){q.setModelViewMatrix.call(this,d,c);c=E.transpose(w.toInverseMat3(c,[]));d.uniformMatrix3fv(this.normalMatrixUniform,!1,c)}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,w,v,k){n.OutlineShader=function(){};var q=n._Shader.prototype;n=n.OutlineShader.prototype=new n._Shader;n.initUniformLocations=function(d){q.initUniformLocations.call(this,d);this.normalSampleUniform=d.getUniformLocation(this.gProgram,"u_normal_sample");this.depthSampleUniform=d.getUniformLocation(this.gProgram,"u_depth_sample");this.gbufferTextureSizeUniform=d.getUniformLocation(this.gProgram,"u_gbuffer_texture_size");this.normalThresholdUniform=d.getUniformLocation(this.gProgram,"u_normal_threshold");
this.depthThresholdUniform=d.getUniformLocation(this.gProgram,"u_depth_threshold");this.thicknessUniform=d.getUniformLocation(this.gProgram,"u_thickness")};n.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;varying vec2 v_texcoord;void main() {gl_Position = vec4(a_vertex_position, 1.);v_texcoord = a_vertex_position.xy * .5 + .5;}")};n.loadDefaultFragmentShader=function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,
"precision mediump float;uniform sampler2D u_normal_sample;uniform sampler2D u_depth_sample;uniform float u_normal_threshold;uniform float u_depth_threshold;uniform float u_thickness;uniform vec2 u_gbuffer_texture_size;varying vec2 v_texcoord;void main() {vec3 normal = texture2D(u_normal_sample, v_texcoord).xyz;float depth = texture2D(u_depth_sample, v_texcoord).r;vec2 texelSize = u_thickness/u_gbuffer_texture_size * .5;vec2 offsets[8];offsets[0] = vec2(-texelSize.x, -texelSize.y);offsets[1] = vec2(-texelSize.x, 0);offsets[2] = vec2(-texelSize.x, texelSize.y);offsets[3] = vec2(0, -texelSize.y);offsets[4] = vec2(0,  texelSize.y);offsets[5] = vec2(texelSize.x, -texelSize.y);offsets[6] = vec2(texelSize.x, 0);offsets[7] = vec2(texelSize.x, texelSize.y);float edge = 0.;for (int i = 0; i < 8; i++) {vec3 sampleNorm = texture2D(u_normal_sample, v_texcoord + offsets[i]).xyz;if(normal == vec3(.0, .0, .0)) {if(sampleNorm != vec3(.0, .0, .0)) {edge = 1.0;break;}continue;}if (dot(sampleNorm, normal) < u_normal_threshold) {edge = 1.0;break;}float sampleDepth = texture2D(u_depth_sample, v_texcoord + offsets[i]).r;if (abs(sampleDepth - depth) > u_depth_threshold) {edge = 1.0;break;}}edge = 1. - edge;gl_FragColor = vec4(edge, edge, edge, 1.);}")};
n.setGbufferTextureSize=function(d,c,e){d.uniform2f(this.gbufferTextureSizeUniform,c,e)};n.setNormalThreshold=function(d,c){d.uniform1f(this.normalThresholdUniform,c)};n.setDepthThreshold=function(d,c){d.uniform1f(this.depthThresholdUniform,c)};n.setThickness=function(d,c){d.uniform1f(this.thicknessUniform,c)}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,w,v,k){n.PhongShader=function(){};var q=n._Shader.prototype;n=n.PhongShader.prototype=new n._Shader;n.initUniformLocations=function(d){q.initUniformLocations.call(this,d);this.shadowUniform=d.getUniformLocation(this.gProgram,"u_shadow");this.flatColorUniform=d.getUniformLocation(this.gProgram,"u_flat_color");this.normalMatrixUniform=d.getUniformLocation(this.gProgram,"u_normal_matrix");this.lightModelViewMatrixUniform=d.getUniformLocation(this.gProgram,"u_light_model_view_matrix");this.lightProjectionMatrixUniform=
d.getUniformLocation(this.gProgram,"u_light_projection_matrix");this.lightDiffuseColorUniform=d.getUniformLocation(this.gProgram,"u_light_diffuse_color");this.lightSpecularColorUniform=d.getUniformLocation(this.gProgram,"u_light_specular_color");this.lightDirectionUniform=d.getUniformLocation(this.gProgram,"u_light_direction");this.materialAmbientColorUniform=d.getUniformLocation(this.gProgram,"u_material_ambient_color");this.materialDiffuseColorUniform=d.getUniformLocation(this.gProgram,"u_material_diffuse_color");
this.materialSpecularColorUniform=d.getUniformLocation(this.gProgram,"u_material_specular_color");this.materialShininessUniform=d.getUniformLocation(this.gProgram,"u_material_shininess");this.materialAlphaUniform=d.getUniformLocation(this.gProgram,"u_material_alpha");this.fogModeUniform=d.getUniformLocation(this.gProgram,"u_fog_mode");this.fogColorUniform=d.getUniformLocation(this.gProgram,"u_fog_color");this.fogStartUniform=d.getUniformLocation(this.gProgram,"u_fog_start");this.fogEndUniform=d.getUniformLocation(this.gProgram,
"u_fog_end");this.fogDensityUniform=d.getUniformLocation(this.gProgram,"u_fog_density");this.shadowDepthSampleUniform=d.getUniformLocation(this.gProgram,"u_shadow_depth_sample");this.shadowTextureSizeUniform=d.getUniformLocation(this.gProgram,"u_shadow_texture_size");this.shadowIntensityUniform=d.getUniformLocation(this.gProgram,"u_shadow_intensity");this.gammaCorrectionUniform=d.getUniformLocation(this.gProgram,"u_gamma_inverted");this.pointSizeUniform=d.getUniformLocation(this.gProgram,"u_point_size")};
n.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;attribute vec3 a_vertex_normal;uniform vec3 u_light_diffuse_color;uniform vec3 u_material_ambient_color;uniform vec3 u_material_diffuse_color;uniform mat4 u_model_view_matrix;uniform mat4 u_projection_matrix;uniform mat3 u_normal_matrix;uniform mat4 u_light_model_view_matrix;uniform mat4 u_light_projection_matrix;uniform bool u_shadow;varying vec3 v_viewpos;varying vec4 v_shadcoord;varying vec3 v_diffuse;varying vec3 v_ambient;varying vec3 v_normal;uniform float u_point_size;void main() {v_normal = length(a_vertex_normal)==0. ? a_vertex_normal : u_normal_matrix * a_vertex_normal;v_ambient = u_material_ambient_color;v_diffuse = u_material_diffuse_color * u_light_diffuse_color;if(u_shadow) {v_shadcoord = u_light_projection_matrix * u_light_model_view_matrix * vec4(a_vertex_position, 1.);v_shadcoord /= v_shadcoord.w;}vec4 viewPos = u_model_view_matrix * vec4(a_vertex_position, 1.);v_viewpos = viewPos.xyz / viewPos.w;gl_Position = u_projection_matrix * viewPos;gl_Position /= gl_Position.w;gl_PointSize = u_point_size;}")};
n.loadDefaultFragmentShader=function(d){var c=[d.depthTextureExt?"#define CWC_DEPTH_TEX\n":"","precision mediump float;uniform vec3 u_light_specular_color;uniform vec3 u_light_direction;uniform vec3 u_material_specular_color;uniform float u_material_shininess;uniform float u_material_alpha;uniform int u_fog_mode;uniform vec3 u_fog_color;uniform float u_fog_density;uniform float u_fog_start;uniform float u_fog_end;uniform bool u_shadow;uniform float u_shadow_intensity;uniform bool u_flat_color;uniform float u_gamma_inverted;uniform sampler2D u_shadow_depth_sample;uniform vec2 u_shadow_texture_size;varying vec3 v_viewpos;varying vec4 v_shadcoord;varying vec3 v_diffuse;varying vec3 v_ambient;varying vec3 v_normal;\n#ifndef CWC_DEPTH_TEX\nfloat unpack (vec4 colour) {const vec4 bitShifts = vec4(1.,1. / 255.,1. / (255. * 255.),1. / (255. * 255. * 255.));return dot(colour, bitShifts);}\n#endif\nfloat shadowMapDepth(vec4 shadowMapColor) {float zShadowMap;\n#ifdef CWC_DEPTH_TEX\nzShadowMap = shadowMapColor.r;\n#else\nzShadowMap = unpack(shadowMapColor);\n#endif\nreturn zShadowMap;}void main(void) {vec3 color = v_diffuse;if(length(v_normal)!=0.){vec3 normal = normalize(v_normal);vec3 lightDir = normalize(-u_light_direction);float nDotL = dot(normal, lightDir);float shadow = 0.0;if(u_shadow) {vec3 depthCoord = .5 + v_shadcoord.xyz / v_shadcoord.w * .5;if(depthCoord.z <= 1. && depthCoord.z >= 0.) {float bias = max(.05 * (1. - nDotL), .005);vec2 texelSize = 1. / u_shadow_texture_size;for(int x = -1; x <= 1; ++x) {for(int y = -1; y <= 1; ++y)  {vec4 shadowMapColor = texture2D(u_shadow_depth_sample, depthCoord.xy + vec2(x, y) * texelSize);float zShadowMap = shadowMapDepth(shadowMapColor);shadow += zShadowMap + bias < depthCoord.z ? 1. : 0.;}}shadow /= 9.;shadow *= u_shadow_intensity;}}if(!u_flat_color) {vec3 viewDir = normalize(-v_viewpos);vec3 halfDir = normalize(lightDir + viewDir);float nDotHV = max(dot(halfDir, normal), 0.);vec3 specular = u_material_specular_color * u_light_specular_color;color*=max(nDotL, 0.);color+=specular * pow(nDotHV, u_material_shininess);}color = (1.-shadow)*color+v_ambient;}gl_FragColor = vec4(pow(color, vec3(u_gamma_inverted)), u_material_alpha);if(u_fog_mode != 0){float fogCoord = 1.-clamp((u_fog_end - gl_FragCoord.z/gl_FragCoord.w) / (u_fog_end - u_fog_start), 0., 1.);float fogFactor = 1.;if(u_fog_mode == 1){fogFactor = 1.-fogCoord;}else if(u_fog_mode == 2) {fogFactor = clamp(exp(-u_fog_density*fogCoord), 0., 1.);}else if(u_fog_mode == 3) {fogFactor = clamp(exp(-pow(u_fog_density*fogCoord, 2.)), 0., 1.);}gl_FragColor = mix(vec4(u_fog_color, 1.), gl_FragColor, fogFactor);}}"].join("");
return this.getShaderFromStr(d,d.FRAGMENT_SHADER,c)};n.enableAttribsArray=function(d){q.enableAttribsArray.call(this,d);d.enableVertexAttribArray(this.vertexNormalAttribute)};n.disableAttribsArray=function(d){q.disableAttribsArray.call(this,d);d.disableVertexAttribArray(this.vertexNormalAttribute)};n.setMatrixUniforms=function(d,c){if(c===k)this.setModelViewMatrix(d,d.modelViewMatrix),this.setLightModelViewMatrix(d,d.lightViewMatrix);else{var e=w.multiply(d.modelViewMatrix,c,[]);c=w.multiply(d.lightViewMatrix,
c,[]);this.setModelViewMatrix(d,e);this.setLightModelViewMatrix(d,c)}};n.setModelViewMatrix=function(d,c){q.setModelViewMatrix.call(this,d,c);c=E.transpose(w.toInverseMat3(c,[]));d.uniformMatrix3fv(this.normalMatrixUniform,!1,c)};n.setFlatColor=function(d,c){d.uniform1i(this.flatColorUniform,c)};n.setShadow=function(d,c){d.uniform1i(this.shadowUniform,c)};n.setFogMode=function(d,c){d.uniform1i(this.fogModeUniform,c)};n.setFogColor=function(d,c){d.uniform3fv(this.fogColorUniform,c)};n.setFogStart=
function(d,c){d.uniform1f(this.fogStartUniform,c)};n.setFogEnd=function(d,c){d.uniform1f(this.fogEndUniform,c)};n.setFogDensity=function(d,c){d.uniform1f(this.fogDensityUniform,c)};n.setMaterialAmbientColor=function(d,c){d.uniform3fv(this.materialAmbientColorUniform,c)};n.setMaterialDiffuseColor=function(d,c){d.uniform3fv(this.materialDiffuseColorUniform,c)};n.setMaterialSpecularColor=function(d,c){d.uniform3fv(this.materialSpecularColorUniform,c)};n.setMaterialShininess=function(d,c){d.uniform1f(this.materialShininessUniform,
c)};n.setMaterialAlpha=function(d,c){d.uniform1f(this.materialAlphaUniform,c)};n.setLightDiffuseColor=function(d,c){d.uniform3fv(this.lightDiffuseColorUniform,c)};n.setLightSpecularColor=function(d,c){d.uniform3fv(this.lightSpecularColorUniform,c)};n.setLightDirection=function(d,c){d.uniform3fv(this.lightDirectionUniform,c)};n.setLightModelViewMatrix=function(d,c){d.uniformMatrix4fv(this.lightModelViewMatrixUniform,!1,c)};n.setLightProjectionMatrix=function(d,c){d.uniformMatrix4fv(this.lightProjectionMatrixUniform,
!1,c)};n.setShadowTextureSize=function(d,c,e){d.uniform2f(this.shadowTextureSizeUniform,c,e)};n.setShadowIntensity=function(d,c){d.uniform1f(this.shadowIntensityUniform,c)};n.setGammaCorrection=function(d,c){d.uniform1f(this.gammaCorrectionUniform,1/c)};n.setPointSize=function(d,c){d.uniform1f(this.pointSizeUniform,c)}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,w,v,k){n.PickShader=function(){};var q=n._Shader.prototype;n=n.PickShader.prototype=new n._Shader;n.initUniformLocations=function(d){q.initUniformLocations.call(this,d);this.materialDiffuseColorUniform=d.getUniformLocation(this.gProgram,"u_material_diffuse_color")};n.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;uniform mat4 u_model_view_matrix;uniform mat4 u_projection_matrix;void main() {gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.);gl_Position /= gl_Position.w;}")};
n.loadDefaultFragmentShader=function(d){var c=[d.depthTextureExt?"#define CWC_DEPTH_TEX\n":"","precision mediump float;uniform vec3 u_material_diffuse_color;void main(void) {gl_FragColor = vec4(u_material_diffuse_color, 1.);}"].join("");return this.getShaderFromStr(d,d.FRAGMENT_SHADER,c)};n.setMaterialDiffuseColor=function(d,c){d.uniform3fv(this.materialDiffuseColorUniform,c)}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,w,v,k){n.PositionShader=function(){};n=n.PositionShader.prototype=new n._Shader;n.loadDefaultVertexShader=function(q){return this.getShaderFromStr(q,q.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;uniform mat4 u_model_view_matrix;uniform mat4 u_projection_matrix;varying vec4 v_position;void main() {vec4 viewPos = u_model_view_matrix * vec4(a_vertex_position, 1.);gl_Position = u_projection_matrix * viewPos;v_position = viewPos / viewPos.w;}")};n.loadDefaultFragmentShader=
function(q){return this.getShaderFromStr(q,q.FRAGMENT_SHADER,"precision mediump float;varying vec4 v_position;void main(void) {gl_FragColor = v_position;}")}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,w,v,k){n.QuadShader=function(){};n=n.QuadShader.prototype=new n._Shader;n.loadDefaultVertexShader=function(q){return this.getShaderFromStr(q,q.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;varying vec2 v_texcoord;void main() {gl_Position = vec4(a_vertex_position, 1.);v_texcoord = a_vertex_position.xy * .5 + .5;}")};n.loadDefaultFragmentShader=function(q){return this.getShaderFromStr(q,q.FRAGMENT_SHADER,"precision mediump float;uniform sampler2D u_image;varying vec2 v_texcoord;void main() {gl_FragColor = texture2D(u_image, v_texcoord);}")}})(ChemDoodle.structures.d3,
ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,w,v,k,q,d){var c=function(e,b,g){this.i1=e;this.i2=b;this.i3=g};E._Surface=function(){};E=E._Surface.prototype=new E._Mesh;E.generate=function(e,b,g,m,p,l,r,y){e=[];b=p[4]-m;for(g=0;g<y;g++){for(var x=p[2]-m,A=0;A<r;A++){for(var H=p[0]-m,a=0;a<l;a++)e.push(this.calculate(H,x,b)),H+=m;x+=m}b+=m}return e};E.build=function(e,b,g){var m=[],p=[],l=[],r=[Infinity,-Infinity,Infinity,-Infinity,Infinity,-Infinity];b+=2;for(var y=0,x=e.length;y<x;y++){var A=e[y];r[0]=q.min(r[0],A.x-b);r[1]=q.max(r[1],
A.x+b);r[2]=q.min(r[2],A.y-b);r[3]=q.max(r[3],A.y+b);r[4]=q.min(r[4],A.z-b);r[5]=q.max(r[5],A.z+b)}b=r[1]-r[0];y=r[3]-r[2];x=r[5]-r[4];e=q.min(b,q.min(y,x))/g;g=2+q.ceil(b/e);A=2+q.ceil(y/e);var H=2+q.ceil(x/e);b=this.generate(b,y,x,e,r,g,A,H);b=v(b,[g,A,H]);g=[];y=[];x=0;for(A=b.vertices.length;x<A;x++){H=y;var a=H.push,f=b.vertices[x],t=g,C=f[0]*e+r[0]-e,F=f[1]*e+r[2]-e;f=f[2]*e+r[4]-e;for(var I=-1,L=0,O=t.length;L<O;L++){var S=t[L];if(.001>q.abs(S.x-C)&&.001>q.abs(S.y-F)&&.001>q.abs(S.z-f)){I=
L;break}}-1==I&&(I=t.length,t.push(new n.Atom("C",C,F,f)));a.call(H,I)}r=[];e=0;for(x=b.faces.length;e<x;e++)a=b.faces[e],A=y[a[0]],H=y[a[1]],a=y[a[2]],r.push(new c(A,H,a)),l.push(A,H,a);e=[];b=0;for(y=g.length;b<y;b++){x=[];A=0;for(H=r.length;A<H;A++)if(a=r[A],a.i1===b||a.i2===b||a.i3===b)a.i1!=b&&-1===x.indexOf(a.i1)&&x.push(a.i1),a.i2!=b&&-1===x.indexOf(a.i2)&&x.push(a.i2),a.i3!=b&&-1===x.indexOf(a.i3)&&x.push(a.i3);e.push(x)}b=[];y=0;for(x=g.length;y<x;y++){H=g[y];a=e[y];A=new n.Atom;if(3>a.length)A.x=
H.x,A.y=H.y,A.z=H.z;else{t=1;5>a.length&&(t=.5);C=0;for(F=a.length;C<F;C++)f=g[a[C]],A.x+=f.x,A.y+=f.y,A.z+=f.z;A.x+=H.x*t;A.y+=H.y*t;A.z+=H.z*t;H=1/(t+a.length);A.x*=H;A.y*=H;A.z*=H}b.push(A)}g=b;e=0;for(b=g.length;e<b;e++)y=g[e],m.push(y.x,y.y,y.z);e=0;for(b=r.length;e<b;e++)y=r[e],x=g[y.i1],H=g[y.i2],A=g[y.i3],H=[H.x-x.x,H.y-x.y,H.z-x.z],k.cross(H,[A.x-x.x,A.y-x.y,A.z-x.z]),isNaN(H[0])&&(H=[0,0,0]),y.normal=H;e=0;for(g=g.length;e<g;e++){b=[0,0,0];y=0;for(x=r.length;y<x;y++)if(A=r[y],A.i1===e||
A.i2===e||A.i3===e)b[0]+=A.normal[0],b[1]+=A.normal[1],b[2]+=A.normal[2];k.normalize(b);p.push(b[0],b[1],b[2])}this.storeData(m,p,l)};E.render=function(e,b){this.styles&&(b=this.styles);b.surfaces_display&&(e.shader.setMatrixUniforms(e),this.bindBuffers(e),e.material.setTempColors(e,b.surfaces_materialAmbientColor_3D,b.surfaces_color,b.surfaces_materialSpecularColor_3D,b.surfaces_materialShininess_3D),e.material.setAlpha(e,b.surfaces_alpha),"Dots"===b.surfaces_style?(e.shader.setPointSize(e,b.shapes_pointSize),
e.drawElements(e.POINTS,this.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)):"Mesh"===b.surfaces_style?(e.lineWidth(b.shapes_lineWidth),e.drawElements(e.LINES,this.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)):e.drawElements(e.TRIANGLES,this.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0))}})(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.ELEMENT,ChemDoodle.lib.MarchingCubes,ChemDoodle.lib.vec3,Math);
(function(n,E,w,v,k){E.SASSurface=function(q,d,c){this.atoms=q;this.probeRadius=d;this.resolution=c;this.build(q,d,c)};(E.SASSurface.prototype=new E._Surface).calculate=function(q,d,c){var e=Infinity;q=new n.Atom("C",q,d,c);d=0;for(c=this.atoms.length;d<c;d++){var b=this.atoms[d],g=w[b.label]&&0!==w[b.label].vdWRadius?w[b.label].vdWRadius:2;b=b.distance3D(q)-this.probeRadius-g;e=v.min(e,b)}return e}})(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.ELEMENT,Math);
(function(n,E,w,v,k){E.VDWSurface=function(q,d){this.atoms=q;this.probeRadius=0;this.resolution=d;this.build(q,0,d)};(E.VDWSurface.prototype=new E._Surface).calculate=function(q,d,c){var e=Infinity;q=new n.Atom("C",q,d,c);d=0;for(c=this.atoms.length;d<c;d++){var b=this.atoms[d],g=w[b.label]&&0!==w[b.label].vdWRadius?w[b.label].vdWRadius:2;b=b.distance3D(q)-g;e=v.min(e,b)}return e}})(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.ELEMENT,Math);
(function(n,E,w,v){n.Plate=function(k){this.lanes=Array(k);i=0;for(ii=k;i<ii;i++)this.lanes[i]=[]};v=n.Plate.prototype;v.sort=function(){i=0;for(ii=this.lanes.length;i<ii;i++)this.lanes[i].sort(function(k,q){return k-q})};v.draw=function(k,q){q=k.canvas.width;var d=k.canvas.height;this.origin=9*d/10;this.front=d/10;this.laneLength=this.origin-this.front;k.strokeStyle="#000000";k.beginPath();k.moveTo(0,this.front);k.lineTo(q,this.front);k.setLineDash([3]);k.stroke();k.setLineDash([]);k.beginPath();
k.moveTo(0,this.origin);k.lineTo(q,this.origin);k.closePath();k.stroke();i=0;for(ii=this.lanes.length;i<ii;i++)for(d=(i+1)*q/(ii+1),k.beginPath(),k.moveTo(d,this.origin),k.lineTo(d,this.origin+3),k.closePath(),k.stroke(),s=0,ss=this.lanes[i].length;s<ss;s++){var c=this.origin-this.laneLength*this.lanes[i][s].rf;switch(this.lanes[i][s].type){case "compact":k.beginPath();k.arc(d,c,3,0,2*w.PI,!1);k.closePath();break;case "expanded":k.beginPath();k.arc(d,c,7,0,2*w.PI,!1);k.closePath();break;case "widened":E.contextEllipse(k,
d-18,c-10,36,10);break;case "cresent":k.beginPath(),k.arc(d,c,9,0,w.PI,!0),k.closePath()}switch(this.lanes[i][s].style){case "solid":k.fillStyle="#000000";k.fill();break;case "transparent":k.stroke()}}};n.Plate.Spot=function(k,q,d){this.type=k;this.rf=q;this.style=d?d:"solid"}})(ChemDoodle.structures,ChemDoodle.extensions,Math);
(function(n,E,w,v,k,q){n.DEFAULT_STYLES={backgroundColor:"#FFFFFF",scale:1,rotateAngle:0,bondLength_2D:20,angstromsPerBondLength:1.25,lightDirection_3D:[-.1,-.1,-1],lightDiffuseColor_3D:"#FFFFFF",lightSpecularColor_3D:"#FFFFFF",projectionPerspective_3D:!0,projectionPerspectiveVerticalFieldOfView_3D:45,projectionOrthoWidth_3D:40,projectionWidthHeightRatio_3D:q,projectionFrontCulling_3D:.1,projectionBackCulling_3D:1E4,cullBackFace_3D:!0,fog_mode_3D:0,fog_color_3D:"#000000",fog_start_3D:0,fog_end_3D:1,
fog_density_3D:1,shadow_3D:!1,shadow_intensity_3D:.85,flat_color_3D:!1,antialias_3D:!0,gammaCorrection_3D:2.2,colorHover:"#885110",colorSelect:"#0060B2",colorError:"#c10000",colorPreview:"#00FF00",ssao_3D:!1,ssao_kernel_radius:17,ssao_kernel_samples:32,ssao_power:1,outline_3D:!1,outline_thickness:1,outline_normal_threshold:.85,outline_depth_threshold:.1,fxaa_edgeThreshold:.0625,fxaa_edgeThresholdMin:1/12,fxaa_searchSteps:64,fxaa_searchThreshold:.25,fxaa_subpixCap:1,fxaa_subpixTrim:0,atoms_display:!0,
atoms_color:"#000000",atoms_font_size_2D:12,atoms_font_families_2D:["Helvetica","Arial","Dialog"],atoms_font_bold_2D:!1,atoms_font_italic_2D:!1,atoms_circles_2D:!1,atoms_circleDiameter_2D:10,atoms_circleBorderWidth_2D:1,atoms_lonePairDistance_2D:8,atoms_lonePairSpread_2D:4,atoms_lonePairDiameter_2D:1,atoms_useJMOLColors:!1,atoms_usePYMOLColors:!1,atoms_HBlack_2D:!0,atoms_implicitHydrogens_2D:!0,atoms_displayTerminalCarbonLabels_2D:!1,atoms_showHiddenCarbons_2D:!0,atoms_showAttributedCarbons_2D:!0,
atoms_displayAllCarbonLabels_2D:!1,atoms_resolution_3D:30,atoms_sphereDiameter_3D:.8,atoms_useVDWDiameters_3D:!1,atoms_vdwMultiplier_3D:1,atoms_materialAmbientColor_3D:"#000000",atoms_materialSpecularColor_3D:"#555555",atoms_materialShininess_3D:32,atoms_nonBondedAsStars_3D:!1,atoms_displayLabels_3D:!1,bonds_display:!0,bonds_color:"#000000",bonds_width_2D:1,bonds_useAbsoluteSaturationWidths_2D:!0,bonds_saturationWidth_2D:.2,bonds_saturationWidthAbs_2D:5,bonds_ends_2D:"round",bonds_splitColor:!1,bonds_colorGradient:!1,
bonds_saturationAngle_2D:w.PI/3,bonds_symmetrical_2D:!1,bonds_clearOverlaps_2D:!1,bonds_overlapClearWidth_2D:.5,bonds_atomLabelBuffer_2D:1,bonds_wedgeThickness_2D:6,bonds_wavyLength_2D:4,bonds_hashWidth_2D:1,bonds_hashSpacing_2D:2.5,bonds_dotSize_2D:2,bonds_lewisStyle_2D:!1,bonds_showBondOrders_3D:!1,bonds_resolution_3D:30,bonds_renderAsLines_3D:!1,bonds_cylinderDiameter_3D:.3,bonds_pillLatitudeResolution_3D:10,bonds_pillLongitudeResolution_3D:20,bonds_pillHeight_3D:.3,bonds_pillSpacing_3D:.1,bonds_pillDiameter_3D:.3,
bonds_materialAmbientColor_3D:"#000000",bonds_materialSpecularColor_3D:"#555555",bonds_materialShininess_3D:32,proteins_displayRibbon:!0,proteins_displayBackbone:!1,proteins_backboneThickness:1.5,proteins_backboneColor:"#CCCCCC",proteins_ribbonCartoonize:!1,proteins_displayPipePlank:!1,proteins_residueColor:"none",proteins_primaryColor:"#FF0D0D",proteins_secondaryColor:"#FFFF30",proteins_ribbonCartoonHelixPrimaryColor:"#00E740",proteins_ribbonCartoonHelixSecondaryColor:"#9905FF",proteins_ribbonCartoonSheetColor:"#E8BB99",
proteins_tubeColor:"#FF0D0D",proteins_tubeResolution_3D:15,proteins_ribbonThickness:.2,proteins_tubeThickness:.5,proteins_plankSheetWidth:3.5,proteins_cylinderHelixDiameter:4,proteins_verticalResolution:8,proteins_horizontalResolution:8,proteins_materialAmbientColor_3D:"#000000",proteins_materialSpecularColor_3D:"#555555",proteins_materialShininess_3D:32,nucleics_display:!0,nucleics_tubeColor:"#CCCCCC",nucleics_baseColor:"#C10000",nucleics_residueColor:"none",nucleics_tubeThickness:1.5,nucleics_tubeResolution_3D:15,
nucleics_verticalResolution:8,nucleics_materialAmbientColor_3D:"#000000",nucleics_materialSpecularColor_3D:"#555555",nucleics_materialShininess_3D:32,macro_displayAtoms:!1,macro_displayBonds:!1,macro_atomToLigandDistance:-1,macro_showWater:!1,macro_colorByChain:!1,macro_rainbowColors:["#0000FF","#00FFFF","#00FF00","#FFFF00","#FF0000"],surfaces_display:!0,surfaces_alpha:.5,surfaces_style:"Solid",surfaces_color:"white",surfaces_materialAmbientColor_3D:"#000000",surfaces_materialSpecularColor_3D:"#000000",
surfaces_materialShininess_3D:32,plots_color:"#000000",plots_width:1,plots_showIntegration:!1,plots_integrationColor:"#c10000",plots_integrationLineWidth:1,plots_showGrid:!1,plots_gridColor:"gray",plots_gridLineWidth:.5,plots_showYAxis:!0,plots_flipXAxis:!1,text_font_size:12,text_font_families:["Helvetica","Arial","Dialog"],text_font_bold:!0,text_font_italic:!1,text_font_stroke_3D:!0,text_color:"#000000",shapes_color:"#000000",shapes_lineWidth:1,shapes_pointSize:2,shapes_arrowLength_2D:8,compass_display:!1,
compass_axisXColor_3D:"#FF0000",compass_axisYColor_3D:"#00FF00",compass_axisZColor_3D:"#0000FF",compass_size_3D:50,compass_resolution_3D:10,compass_displayText_3D:!0,compass_type_3D:0,measurement_update_3D:!1,measurement_angleBands_3D:10,measurement_displayText_3D:!0};E.Styles=function(d){k.assign(this,v.parse(v.stringify(d===q?n.DEFAULT_STYLES:d)))};w=E.Styles.prototype;w.set3DRepresentation=function(d){this.bonds_display=this.atoms_display=!0;this.bonds_color="#777777";this.bonds_showBondOrders_3D=
this.bonds_splitColor=this.atoms_useJMOLColors=this.atoms_useVDWDiameters_3D=!0;this.bonds_renderAsLines_3D=!1;"Ball and Stick"===d?(this.atoms_vdwMultiplier_3D=.3,this.bonds_splitColor=!1,this.bonds_cylinderDiameter_3D=.3,this.bonds_materialAmbientColor_3D=ChemDoodle.DEFAULT_STYLES.atoms_materialAmbientColor_3D,this.bonds_pillDiameter_3D=.15):"van der Waals Spheres"===d?(this.bonds_display=!1,this.atoms_vdwMultiplier_3D=1):"Stick"===d?(this.bonds_showBondOrders_3D=this.atoms_useVDWDiameters_3D=!1,
this.bonds_cylinderDiameter_3D=this.atoms_sphereDiameter_3D=.8,this.bonds_materialAmbientColor_3D=this.atoms_materialAmbientColor_3D):"Wireframe"===d?(this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.bonds_pillDiameter_3D=.05,this.atoms_sphereDiameter_3D=.15,this.bonds_materialAmbientColor_3D=ChemDoodle.DEFAULT_STYLES.atoms_materialAmbientColor_3D):"Line"===d?(this.atoms_display=!1,this.bonds_renderAsLines_3D=!0,this.bonds_width_2D=1,this.bonds_cylinderDiameter_3D=.05):alert('"'+
d+'" is not recognized. Use one of the following strings:\n\n1. Ball and Stick\n2. van der Waals Spheres\n3. Stick\n4. Wireframe\n5. Line\n')};w.copy=function(){return new E.Styles(this)}})(ChemDoodle,ChemDoodle.structures,Math,JSON,Object);
(function(n,E,w,v,k){w.getPointsPerAngstrom=function(){return n.DEFAULT_STYLES.bondLength_2D/n.DEFAULT_STYLES.angstromsPerBondLength};w.BondDeducer=function(){};k=w.BondDeducer.prototype;k.margin=1.1;k.deduceCovalentBonds=function(q,d){var c=w.getPointsPerAngstrom();d&&(c=d);d=0;for(var e=q.atoms.length;d<e;d++)for(var b=d+1;b<e;b++){var g=q.atoms[d],m=q.atoms[b];g.distance3D(m)<(E[g.label].covalentRadius+E[m.label].covalentRadius)*c*this.margin&&q.bonds.push(new v.Bond(g,m,1))}}})(ChemDoodle,ChemDoodle.ELEMENT,
ChemDoodle.informatics,ChemDoodle.structures);
(function(n,E,w){n.HydrogenDeducer=function(){};n.HydrogenDeducer.prototype.removeHydrogens=function(v,k){for(var q=[],d=[],c=0,e=v.bonds.length;c<e;c++){var b=v.bonds[c],g="H"!==b.a1.label&&"H"!==b.a2.label;g||k||b.stereo===E.Bond.STEREO_NONE||(g=!0);g?(b.a1.tag=!0,d.push(b)):("H"===b.a1.label&&(b.a1.remove=!0),"H"===b.a2.label&&(b.a2.remove=!0))}k=0;for(c=v.atoms.length;k<c;k++)e=v.atoms[k],e.remove?e.remove=w:q.push(e);v.atoms=q;v.bonds=d}})(ChemDoodle.informatics,ChemDoodle.structures);
(function(n,E,w){n.Splitter=function(){};n.Splitter.prototype.split=function(v){for(var k=[],q=0,d=v.atoms.length;q<d;q++)v.atoms[q].visited=!1;q=0;for(d=v.bonds.length;q<d;q++)v.bonds[q].visited=!1;q=0;for(d=v.atoms.length;q<d;q++){var c=v.atoms[q];if(!c.visited){var e=new E.Molecule;e.atoms.push(c);c.visited=!0;var b=new E.Queue;for(b.enqueue(c);!b.isEmpty();){c=b.dequeue();for(var g=0,m=v.bonds.length;g<m;g++){var p=v.bonds[g];p.contains(c)&&!p.visited&&(p.visited=!0,e.bonds.push(p),p=p.getNeighbor(c),
p.visited||(p.visited=!0,e.atoms.push(p),b.enqueue(p)))}}k.push(e)}}return k}})(ChemDoodle.informatics,ChemDoodle.structures);(function(n,E,w,v){n.StructureBuilder=function(){};n.StructureBuilder.prototype.copy=function(k){var q=new E.JSONInterpreter;return q.molFrom(q.molTo(k))}})(ChemDoodle.informatics,ChemDoodle.io,ChemDoodle.structures);
(function(n,E){n._Counter=function(){};n=n._Counter.prototype;n.value=0;n.molecule=E;n.setMolecule=function(w){this.value=0;this.molecule=w;this.innerCalculate&&this.innerCalculate()}})(ChemDoodle.informatics);(function(n,E){n.FrerejacqueNumberCounter=function(w){this.setMolecule(w)};(n.FrerejacqueNumberCounter.prototype=new n._Counter).innerCalculate=function(){this.value=this.molecule.bonds.length-this.molecule.atoms.length+(new n.NumberOfMoleculesCounter(this.molecule)).value}})(ChemDoodle.informatics);
(function(n,E,w){E.NumberOfMoleculesCounter=function(v){this.setMolecule(v)};(E.NumberOfMoleculesCounter.prototype=new E._Counter).innerCalculate=function(){for(var v=0,k=this.molecule.atoms.length;v<k;v++)this.molecule.atoms[v].visited=!1;v=0;for(k=this.molecule.atoms.length;v<k;v++)if(!this.molecule.atoms[v].visited){this.value++;var q=new n.Queue;this.molecule.atoms[v].visited=!0;for(q.enqueue(this.molecule.atoms[v]);!q.isEmpty();)for(var d=q.dequeue(),c=0,e=this.molecule.bonds.length;c<e;c++){var b=
this.molecule.bonds[c];b.contains(d)&&(b=b.getNeighbor(d),b.visited||(b.visited=!0,q.enqueue(b)))}}}})(ChemDoodle.structures,ChemDoodle.informatics);
(function(n,E){n._RingFinder=function(){};n=n._RingFinder.prototype;n.atoms=E;n.bonds=E;n.rings=E;n.reduce=function(w){for(var v=0,k=w.atoms.length;v<k;v++)w.atoms[v].visited=!1;v=0;for(k=w.bonds.length;v<k;v++)w.bonds[v].visited=!1;for(v=!0;v;){v=!1;k=0;for(var q=w.atoms.length;k<q;k++){for(var d=0,c=void 0,e=0,b=w.bonds.length;e<b;e++)if(w.bonds[e].contains(w.atoms[k])&&!w.bonds[e].visited){d++;if(2===d)break;c=w.bonds[e]}1===d&&(v=!0,c.visited=!0,w.atoms[k].visited=!0)}}v=0;for(k=w.atoms.length;v<
k;v++)w.atoms[v].visited||this.atoms.push(w.atoms[v]);v=0;for(k=w.bonds.length;v<k;v++)w.bonds[v].visited||this.bonds.push(w.bonds[v]);0===this.bonds.length&&0!==this.atoms.length&&(this.atoms=[])};n.setMolecule=function(w){this.atoms=[];this.bonds=[];this.rings=[];this.reduce(w);2<this.atoms.length&&this.innerGetRings&&this.innerGetRings()};n.fuse=function(){for(var w=0,v=this.rings.length;w<v;w++)for(var k=0,q=this.bonds.length;k<q;k++)-1!==this.rings[w].atoms.indexOf(this.bonds[k].a1)&&-1!==this.rings[w].atoms.indexOf(this.bonds[k].a2)&&
this.rings[w].bonds.push(this.bonds[k])}})(ChemDoodle.informatics);
(function(n,E,w){function v(q,d){this.atoms=[];if(d)for(var c=0,e=d.atoms.length;c<e;c++)this.atoms[c]=d.atoms[c];this.atoms.push(q)}var k=v.prototype;k.grow=function(q,d){for(var c=this.atoms[this.atoms.length-1],e=[],b=0,g=q.length;b<g;b++)if(q[b].contains(c)){var m=q[b].getNeighbor(c);-1===d.indexOf(m)&&e.push(m)}q=[];d=0;for(c=e.length;d<c;d++)q.push(new v(e[d],this));return q};k.check=function(q,d,c){for(var e=0,b=d.atoms.length-1;e<b;e++)if(-1!==this.atoms.indexOf(d.atoms[e]))return w;if(d.atoms[d.atoms.length-
1]===this.atoms[this.atoms.length-1]){var g=new E.Ring;g.atoms[0]=c;c=0;for(q=this.atoms.length;c<q;c++)g.atoms.push(this.atoms[c]);for(c=d.atoms.length-2;0<=c;c--)g.atoms.push(d.atoms[c])}else{e=[];b=0;for(var m=q.length;b<m;b++)q[b].contains(d.atoms[d.atoms.length-1])&&e.push(q[b]);q=0;for(b=e.length;q<b;q++)if((1===d.atoms.length||!e[q].contains(d.atoms[d.atoms.length-2]))&&e[q].contains(this.atoms[this.atoms.length-1])){g=new E.Ring;g.atoms[0]=c;c=0;for(q=this.atoms.length;c<q;c++)g.atoms.push(this.atoms[c]);
for(c=d.atoms.length-1;0<=c;c--)g.atoms.push(d.atoms[c]);break}}return g};n.EulerFacetRingFinder=function(q){this.setMolecule(q)};n=n.EulerFacetRingFinder.prototype=new n._RingFinder;n.fingerBreak=5;n.innerGetRings=function(){for(var q=0,d=this.atoms.length;q<d;q++){for(var c=[],e=0,b=this.bonds.length;e<b;e++)this.bonds[e].contains(this.atoms[q])&&c.push(this.bonds[e].getNeighbor(this.atoms[q]));e=0;for(b=c.length;e<b;e++)for(var g=e+1;g<c.length;g++){var m=[];m[0]=new v(c[e]);m[1]=new v(c[g]);var p=
[];p[0]=this.atoms[q];for(var l=0,r=c.length;l<r;l++)l!==e&&l!==g&&p.push(c[l]);l=[];for((r=m[0].check(this.bonds,m[1],this.atoms[q]))&&(l[0]=r);0===l.length&&0<m.length&&m[0].atoms.length<this.fingerBreak;){r=[];for(var y=0,x=m.length;y<x;y++)for(var A=m[y].grow(this.bonds,p),H=0,a=A.length;H<a;H++)r.push(A[H]);m=r;r=0;for(y=m.length;r<y;r++)for(x=r+1;x<y;x++)(A=m[r].check(this.bonds,m[x],this.atoms[q]))&&l.push(A);if(0===l.length){r=[];y=0;for(x=p.length;y<x;y++)for(A=0,H=this.bonds.length;A<H;A++)this.bonds[A].contains(p[y])&&
(a=this.bonds[A].getNeighbor(p[y]),-1===p.indexOf(a)&&-1===r.indexOf(a)&&r.push(a));y=0;for(x=r.length;y<x;y++)p.push(r[y])}}if(0<l.length){m=w;p=0;for(r=l.length;p<r;p++)if(!m||m.atoms.length>l[p].atoms.length)m=l[p];l=!1;p=0;for(r=this.rings.length;p<r;p++){y=!0;x=0;for(A=m.atoms.length;x<A;x++)if(-1===this.rings[p].atoms.indexOf(m.atoms[x])){y=!1;break}if(y){l=!0;break}}l||this.rings.push(m)}}}this.fuse()}})(ChemDoodle.informatics,ChemDoodle.structures);
(function(n,E){n.SSSRFinder=function(w){this.rings=[];if(0<w.atoms.length){var v=(new n.FrerejacqueNumberCounter(w)).value,k=(new n.EulerFacetRingFinder(w)).rings;k.sort(function(b,g){return b.atoms.length-g.atoms.length});for(var q=0,d=w.bonds.length;q<d;q++)w.bonds[q].visited=!1;w=0;for(q=k.length;w<q;w++){d=!1;for(var c=0,e=k[w].bonds.length;c<e;c++)if(!k[w].bonds[c].visited){d=!0;break}if(d){d=0;for(c=k[w].bonds.length;d<c;d++)k[w].bonds[d].visited=!0;this.rings.push(k[w])}if(this.rings.length===
v)break}}}})(ChemDoodle.informatics);(function(n,E){n._Interpreter=function(){};n._Interpreter.prototype.fit=function(w,v,k){for(var q=w.length,d=[],c=0;c<v-q;c++)d.push(" ");return k?w+d.join(""):d.join("")+w}})(ChemDoodle.io);
(function(n,E,w,v,k,q,d,c){var e=/\s+/g,b=/\(|\)|\s+/g,g=/'|\s+/g,m=/,|'|\s+/g,p=/^\s+/,l=/[0-9]/g,r=/[0-9]|\+|\-/g,y=function(a){return 0!==a.length},x={P:[],A:[[0,.5,.5]],B:[[.5,0,.5]],C:[[.5,.5,0]],I:[[.5,.5,.5]],R:[[2/3,1/3,1/3],[1/3,2/3,2/3]],S:[[1/3,1/3,2/3],[2/3,2/3,1/3]],T:[[1/3,2/3,1/3],[2/3,1/3,2/3]],F:[[0,.5,.5],[.5,0,.5],[.5,.5,0]]},A=function(a){var f=0,t=0,C=0,F=0,I=a.indexOf("x"),L=a.indexOf("y"),O=a.indexOf("z");-1!==I&&(t++,0<I&&"+"!==a.charAt(I-1)&&(t*=-1));-1!==L&&(C++,0<L&&"+"!==
a.charAt(L-1)&&(C*=-1));-1!==O&&(F++,0<O&&"+"!==a.charAt(O-1)&&(F*=-1));if(2<a.length)for(I="+",L=0,O=a.length;L<O;L++){var S=a.charAt(L);"-"!==S&&"/"!==S||L!==a.length-1&&!a.charAt(L+1).match(l)||(I=S);S.match(l)&&("+"===I?f+=parseInt(S):"-"===I?f-=parseInt(S):"/"===I&&(f/=parseInt(S)))}return[f,t,C,F]};E.CIFInterpreter=function(){};(E.CIFInterpreter.prototype=new E._Interpreter).read=function(a,f,t,C){f=f?f:1;t=t?t:1;C=C?C:1;var F=new w.Molecule;if(!a)return F;for(var I=a.split("\n"),L=0,O=0,S=
0,W=0,V=0,Y=0,ba="P",X,ca,ia,Z,oa=!0;0<I.length;)if(oa?Z=I.shift():oa=!0,0<Z.length)if(Z.startsWith("_cell_length_a"))L=parseFloat(Z.split(b)[1]);else if(Z.startsWith("_cell_length_b"))O=parseFloat(Z.split(b)[1]);else if(Z.startsWith("_cell_length_c"))S=parseFloat(Z.split(b)[1]);else if(Z.startsWith("_cell_angle_alpha"))W=k.PI*parseFloat(Z.split(b)[1])/180;else if(Z.startsWith("_cell_angle_beta"))V=k.PI*parseFloat(Z.split(b)[1])/180;else if(Z.startsWith("_cell_angle_gamma"))Y=k.PI*parseFloat(Z.split(b)[1])/
180;else if(Z.startsWith("_symmetry_space_group_name_H-M"))ba=Z.split(g)[1];else if(Z.startsWith("loop_")){for(var ka={fields:[],lines:[]},na=!1;(Z=I.shift())!==c&&!(Z=Z.replace(p,"")).startsWith("loop_")&&0<Z.length;)if(Z.startsWith("_")){if(na)break;ka.fields=ka.fields.concat(Z.split(e).filter(y))}else na=!0,ka.lines.push(Z);0!==I.length&&(Z.startsWith("loop_")||Z.startsWith("_"))&&(oa=!1);-1!==ka.fields.indexOf("_symmetry_equiv_pos_as_xyz")||-1!==ka.fields.indexOf("_space_group_symop_operation_xyz")?
X=ka:-1!==ka.fields.indexOf("_atom_site_label")?ca=ka:-1!==ka.fields.indexOf("_geom_bond_atom_site_label_1")&&(ia=ka)}var pa=L,ta=O,Ea=S,Ua=V,Qa=Y,Va=(k.cos(W)-k.cos(Qa)*k.cos(Ua))/k.sin(Qa);var Ka=[pa,0,0,0,ta*k.cos(Qa),ta*k.sin(Qa),0,0,Ea*k.cos(Ua),Ea*Va,Ea*k.sqrt(1-k.pow(k.cos(Ua),2)-Va*Va),0,0,0,0,1];if(ca){for(var mb=-1,Wa=-1,ma=-1,eb=-1,Jb=-1,fb=0,Tb=ca.fields.length;fb<Tb;fb++){var tb=ca.fields[fb];"_atom_site_type_symbol"===tb?mb=fb:"_atom_site_label"===tb?Wa=fb:"_atom_site_fract_x"===tb?
ma=fb:"_atom_site_fract_y"===tb?eb=fb:"_atom_site_fract_z"===tb&&(Jb=fb)}for(var cc=0,Cb=ca.lines.length;cc<Cb;cc++){Z=ca.lines[cc];var Ba=Z.split(e).filter(y),B=new w.Atom(Ba[-1===mb?Wa:mb].split(r)[0],parseFloat(Ba[ma]),parseFloat(Ba[eb]),parseFloat(Ba[Jb]));F.atoms.push(B);-1!==Wa&&(B.cifId=Ba[Wa],B.cifPart=0)}}if(X&&!ia){for(var Mb=0,Nb=0,vc=X.fields.length;Nb<vc;Nb++){var wc=X.fields[Nb];if("_symmetry_equiv_pos_as_xyz"===wc||"_space_group_symop_operation_xyz"===wc)Mb=Nb}for(var vb=x[ba],kb=[],
Fb=0,pc=X.lines.length;Fb<pc;Fb++)for(var Zb=X.lines[Fb].split(m).filter(y),Ib=A(Zb[Mb]),$b=A(Zb[Mb+1]),Gb=A(Zb[Mb+2]),Hb=0,zc=F.atoms.length;Hb<zc;Hb++){var Ga=F.atoms[Hb],wb=Ga.x*Ib[1]+Ga.y*Ib[2]+Ga.z*Ib[3]+Ib[0],qb=Ga.x*$b[1]+Ga.y*$b[2]+Ga.z*$b[3]+$b[0],Qb=Ga.x*Gb[1]+Ga.y*Gb[2]+Ga.z*Gb[3]+Gb[0],sa=new w.Atom(Ga.label,wb,qb,Qb);kb.push(sa);Ga.cifId!==c&&(sa.cifId=Ga.cifId,sa.cifPart=Fb+1);if(vb)for(var Ma=0,Fc=vb.length;Ma<Fc;Ma++){var bc=vb[Ma],ec=new w.Atom(Ga.label,wb+bc[0],qb+bc[1],Qb+bc[2]);
kb.push(ec);Ga.cifId!==c&&(ec.cifId=Ga.cifId,ec.cifPart=Fb+1)}}for(var yb=0,lb=kb.length;yb<lb;yb++){for(var Ta=kb[yb];1<=Ta.x;)Ta.x--;for(;0>Ta.x;)Ta.x++;for(;1<=Ta.y;)Ta.y--;for(;0>Ta.y;)Ta.y++;for(;1<=Ta.z;)Ta.z--;for(;0>Ta.z;)Ta.z++}for(var Ya=[],Za=0,kc=kb.length;Za<kc;Za++){for(var xa=!1,jc=kb[Za],qc=0,Ic=F.atoms.length;qc<Ic;qc++)if(1E-4>F.atoms[qc].distance3D(jc)){xa=!0;break}if(!xa){for(var fc=0,Jc=Ya.length;fc<Jc;fc++)if(1E-4>Ya[fc].distance3D(jc)){xa=!0;break}xa||Ya.push(jc)}}F.atoms=F.atoms.concat(Ya)}for(var Ac=
[],Vb=0;Vb<f;Vb++)for(var Ub=0;Ub<t;Ub++)for(var ob=0;ob<C;ob++)if(0!==Vb||0!==Ub||0!==ob)for(var zb=0,lc=F.atoms.length;zb<lc;zb++){var sb=F.atoms[zb],Kb=new w.Atom(sb.label,sb.x+Vb,sb.y+Ub,sb.z+ob);Ac.push(Kb);sb.cifId!==c&&(Kb.cifId=sb.cifId,Kb.cifPart=sb.cifPart+(X?X.lines.length:0)+Vb+10*Ub+100*ob)}F.atoms=F.atoms.concat(Ac);for(var Ab=0,rc=F.atoms.length;Ab<rc;Ab++){var rb=F.atoms[Ab],sc=q.multiplyVec3(Ka,[rb.x,rb.y,rb.z]);rb.x=sc[0];rb.y=sc[1];rb.z=sc[2]}if(ia){for(var Bc=-1,tc=-1,Lb=0,uc=
ia.fields.length;Lb<uc;Lb++){var Bb=ia.fields[Lb];"_geom_bond_atom_site_label_1"===Bb?Bc=Lb:"_geom_bond_atom_site_label_2"===Bb&&(tc=Lb)}for(var Rb=0,Kc=ia.lines.length;Rb<Kc;Rb++)for(var Cc=ia.lines[Rb].split(e).filter(y),Sb=Cc[Bc],Dc=Cc[tc],gc=0,Ec=F.atoms.length;gc<Ec;gc++)for(var ac=gc+1;ac<Ec;ac++){var hc=F.atoms[gc],nb=F.atoms[ac];if(hc.cifPart!==nb.cifPart)break;(hc.cifId===Sb&&nb.cifId===Dc||hc.cifId===Dc&&nb.cifId===Sb)&&F.bonds.push(new w.Bond(hc,nb))}}else(new n.informatics.BondDeducer).deduceCovalentBonds(F,
1);var Ja=[-f/2,-t/2,-C/2],xb={o:q.multiplyVec3(Ka,Ja,[]),x:q.multiplyVec3(Ka,[Ja[0]+1,Ja[1],Ja[2]]),y:q.multiplyVec3(Ka,[Ja[0],Ja[1]+1,Ja[2]]),z:q.multiplyVec3(Ka,[Ja[0],Ja[1],Ja[2]+1]),xy:q.multiplyVec3(Ka,[Ja[0]+1,Ja[1]+1,Ja[2]]),xz:q.multiplyVec3(Ka,[Ja[0]+1,Ja[1],Ja[2]+1]),yz:q.multiplyVec3(Ka,[Ja[0],Ja[1]+1,Ja[2]+1]),xyz:q.multiplyVec3(Ka,[Ja[0]+1,Ja[1]+1,Ja[2]+1])};return{molecule:F,unitCell:new v.UnitCell(xb)}};var H=new E.CIFInterpreter;n.readCIF=function(a,f,t,C){return H.read(a,f,t,C)}})(ChemDoodle,
ChemDoodle.io,ChemDoodle.structures,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3);
(function(n,E,w,v,k){E.CMLInterpreter=function(){};var q=E.CMLInterpreter.prototype=new E._Interpreter;q.read=function(c){var e=[];c=v.parseXML(c);c=v(c).find("cml");for(var b=0,g=c.length;b<g;b++)for(var m=v(c[b]).find("molecule"),p=0,l=m.length;p<l;p++){for(var r=e[p]=new w.Molecule,y=[],x=v(m[p]).find("atom"),A=0,H=x.length;A<H;A++){var a=v(x[A]),f=a.attr("elementType");if(a.attr("x2")==k){var t=a.attr("x3");var C=a.attr("y3");var F=a.attr("z3")}else t=a.attr("x2"),C=a.attr("y2"),F=0;f=e[p].atoms[A]=
new w.Atom(f,t,C,F);y[A]=a.attr("id");a.attr("formalCharge")!=k&&(f.charge=a.attr("formalCharge"))}x=v(m[p]).find("bond");A=0;for(H=x.length;A<H;A++){a=v(x[A]);t=a.attr("atomRefs2").split(" ");f=r.atoms[v.inArray(t[0],y)];t=r.atoms[v.inArray(t[1],y)];switch(a.attr("order")){case "2":case "D":C=2;break;case "3":case "T":C=3;break;case "A":C=1.5;break;default:C=1}f=e[p].bonds[A]=new w.Bond(f,t,C);switch(a.find("bondStereo").text()){case "W":f.stereo=w.Bond.STEREO_PROTRUDING;break;case "H":f.stereo=
w.Bond.STEREO_RECESSED}}}return e};q.write=function(c){var e=[];e.push('<?xml version="1.0" encoding="UTF-8"?>\n');e.push('<cml convention="conventions:molecular" xmlns="http://www.xml-cml.org/schema" xmlns:conventions="http://www.xml-cml.org/convention/" xmlns:dc="http://purl.org/dc/elements/1.1/">\n');for(var b=0,g=c.length;b<g;b++){e.push('<molecule id="m');e.push(b);e.push('">');e.push("<atomArray>");for(var m=0,p=c[b].atoms.length;m<p;m++){var l=c[b].atoms[m];e.push('<atom elementType="');e.push(l.label);
e.push('" id="a');e.push(m);e.push('" ');e.push('x3="');e.push(l.x);e.push('" y3="');e.push(l.y);e.push('" z3="');e.push(l.z);e.push('" ');0!=l.charge&&(e.push('formalCharge="'),e.push(l.charge),e.push('" '));e.push("/>")}e.push("</atomArray>");e.push("<bondArray>");m=0;for(p=c[b].bonds.length;m<p;m++){l=c[b].bonds[m];e.push('<bond atomRefs2="a');e.push(c[b].atoms.indexOf(l.a1));e.push(" a");e.push(c[b].atoms.indexOf(l.a2));e.push('" order="');switch(l.bondOrder){case 1.5:e.push("A");break;case 1:case 2:case 3:e.push(l.bondOrder);
break;default:e.push("S")}e.push('"/>')}e.push("</bondArray>");e.push("</molecule>")}e.push("</cml>");return e.join("")};var d=new E.CMLInterpreter;n.readCML=function(c){return d.read(c)};n.writeCML=function(c){return d.write(c)}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery);
(function(n,E,w,v,k){w.MOLInterpreter=function(){};k=w.MOLInterpreter.prototype=new w._Interpreter;k.read=function(d,c){c||(c=n.DEFAULT_STYLES.bondLength_2D);var e=new v.Molecule;if(!d)return e;d=d.split("\n");var b=d[3],g=parseInt(b.substring(0,3));b=parseInt(b.substring(3,6));for(var m=0;m<g;m++){var p=d[4+m];e.atoms[m]=new v.Atom(p.substring(31,34),parseFloat(p.substring(0,10))*c,(1===c?1:-1)*parseFloat(p.substring(10,20))*c,parseFloat(p.substring(20,30))*c);var l=parseInt(p.substring(34,36));
0!==l&&E[e.atoms[m].label]&&(e.atoms[m].mass=E[e.atoms[m].label].mass+l);switch(parseInt(p.substring(36,39))){case 1:e.atoms[m].charge=3;break;case 2:e.atoms[m].charge=2;break;case 3:e.atoms[m].charge=1;break;case 5:e.atoms[m].charge=-1;break;case 6:e.atoms[m].charge=-2;break;case 7:e.atoms[m].charge=-3}}for(c=0;c<b;c++){p=d[4+g+c];l=parseInt(p.substring(6,9));m=parseInt(p.substring(9,12));if(3<l)switch(l){case 4:l=1.5;break;default:l=1}p=new v.Bond(e.atoms[parseInt(p.substring(0,3))-1],e.atoms[parseInt(p.substring(3,
6))-1],l);switch(m){case 3:p.stereo=v.Bond.STEREO_AMBIGUOUS;break;case 1:p.stereo=v.Bond.STEREO_PROTRUDING;break;case 6:p.stereo=v.Bond.STEREO_RECESSED}e.bonds[c]=p}return e};k.write=function(d){var c=[];c.push("Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n");c.push(this.fit(d.atoms.length.toString(),3));c.push(this.fit(d.bonds.length.toString(),3));c.push("  0  0  0  0            999 V2000\n");for(var e=d.getCenter(),b=0,g=d.atoms.length;b<g;b++){var m=d.atoms[b],p=" 0";if(-1!==
m.mass&&E[m.label]){var l=m.mass-E[m.label].mass;5>l&&-4<l&&(p=(-1<l?" ":"")+l)}l="  0";if(0!==m.charge)switch(m.charge){case 3:l="  1";break;case 2:l="  2";break;case 1:l="  3";break;case -1:l="  5";break;case -2:l="  6";break;case -3:l="  7"}c.push(this.fit(((m.x-e.x)/n.DEFAULT_STYLES.bondLength_2D).toFixed(4),10));c.push(this.fit((-(m.y-e.y)/n.DEFAULT_STYLES.bondLength_2D).toFixed(4),10));c.push(this.fit((m.z/n.DEFAULT_STYLES.bondLength_2D).toFixed(4),10));c.push(" ");c.push(this.fit(m.label,3,
!0));c.push(p);c.push(l);c.push("  0  0  0  0\n")}e=0;for(b=d.bonds.length;e<b;e++){m=d.bonds[e];g=0;m.stereo===v.Bond.STEREO_AMBIGUOUS?g=3:m.stereo===v.Bond.STEREO_PROTRUDING?g=1:m.stereo===v.Bond.STEREO_RECESSED&&(g=6);c.push(this.fit((d.atoms.indexOf(m.a1)+1).toString(),3));c.push(this.fit((d.atoms.indexOf(m.a2)+1).toString(),3));m=m.bondOrder;if(1.5==m)m=4;else if(3<m||0!=m%1)m=1;c.push(this.fit(m.toString(),3));c.push("  ");c.push(g);c.push("  0  0  0\n")}c.push("M  END");return c.join("")};
var q=new w.MOLInterpreter;n.readMOL=function(d,c){return q.read(d,c)};n.writeMOL=function(d){return q.write(d)}})(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.io,ChemDoodle.structures);
(function(n,E,w,v,k,q,d){function c(b,g,m,p,l){for(var r=0,y=g.length;r<y;r++){var x=g[r];if(x.id===m&&p>=x.start&&p<=x.end){l?b.helix=!0:b.sheet=!0;p===x.end&&(b.arrow=!0);break}}}E.PDBInterpreter=function(){};d=E.PDBInterpreter.prototype=new E._Interpreter;d.calculateRibbonDistances=!1;d.deduceResidueBonds=!1;d.read=function(b,g){var m=new w.Molecule;m.chains=[];if(!b)return m;var p=b.split("\n");g||(g=1);var l=[],r=[],y=[];b=[];for(var x=[],A=0,H=p.length;A<H;A++){var a=p[A];if(a.startsWith("HELIX"))l.push({id:a.substring(19,
20),start:parseInt(a.substring(21,25)),end:parseInt(a.substring(33,37))});else if(a.startsWith("SHEET"))r.push({id:a.substring(21,22),start:parseInt(a.substring(22,26)),end:parseInt(a.substring(33,37))});else if(a.startsWith("ATOM")){var f=a.substring(16,17);if(" "===f||"A"===f){f=k(a.substring(76,78));if(0===f.length){var t=k(a.substring(12,14));"HD"===t?f="H":0<t.length&&(f=1<t.length?t.charAt(0)+t.substring(1).toLowerCase():t)}f=new w.Atom(f,parseFloat(a.substring(30,38))*g,parseFloat(a.substring(38,
46))*g,parseFloat(a.substring(46,54))*g);f.hetatm=!1;b.push(f);t=parseInt(a.substring(22,26));if(0===y.length)for(var C=0;3>C;C++){var F=new w.Residue(-1);F.cp1=f;F.cp2=f;y.push(F)}y[y.length-1].resSeq!==t&&(C=new w.Residue(t),C.name=k(a.substring(17,20)),3===C.name.length?C.name=C.name.substring(0,1)+C.name.substring(1).toLowerCase():2===C.name.length&&"D"===C.name.charAt(0)&&(C.name=C.name.substring(1)),y.push(C),F=a.substring(21,22),c(C,l,F,t,!0),c(C,r,F,t,!1));a=k(a.substring(12,16));t=y[y.length-
1];if("CA"===a||"P"===a||"O5'"===a)t.cp1||(t.cp1=f);else if("N3"===a&&("C"===t.name||"U"===t.name||"T"===t.name)||"N1"===a&&("A"===t.name||"G"===t.name))t.cp3=f;else if("C2"===a)t.cp4=f;else if("C4"===a&&("C"===t.name||"U"===t.name||"T"===t.name)||"C6"===a&&("A"===t.name||"G"===t.name))t.cp5=f;else if("O"===a||"C6"===a&&("C"===t.name||"U"===t.name||"T"===t.name)||"N9"===a){if(!y[y.length-1].cp2){if("C6"===a||"N9"===a)var I=f;t.cp2=f}}else"C"===a&&(I=f)}}else if(a.startsWith("HETATM"))f=k(a.substring(76,
78)),0===f.length&&(f=k(a.substring(12,16))),1<f.length&&(f=f.substring(0,1)+f.substring(1).toLowerCase()),f=new w.Atom(f,parseFloat(a.substring(30,38))*g,parseFloat(a.substring(38,46))*g,parseFloat(a.substring(46,54))*g),f.hetatm=!0,"HOH"===k(a.substring(17,20))&&(f.isWater=!0),m.atoms.push(f),x[parseInt(k(a.substring(6,11)))]=f;else if(a.startsWith("CONECT")){if(f=parseInt(k(a.substring(6,11))),x[f])for(f=x[f],t=0;4>t;t++)if(C=k(a.substring(11+5*t,16+5*t)),0!==C.length&&(C=parseInt(C),x[C])){C=
x[C];F=!1;for(var L=0,O=m.bonds.length;L<O;L++){var S=m.bonds[L];if(S.a1===f&&S.a2===C||S.a1===C&&S.a2===f){F=!0;break}}F||m.bonds.push(new w.Bond(f,C))}}else if(a.startsWith("TER"))this.endChain(m,y,I,b),y=[];else if(a.startsWith("ENDMDL"))break}this.endChain(m,y,I,b);0===m.bonds.size&&(new n.informatics.BondDeducer).deduceCovalentBonds(m,g);if(this.deduceResidueBonds)for(g=0,I=b.length;g<I;g++)for(p=q.min(I,g+20),l=g+1;l<p;l++)r=b[g],y=b[l],r.distance3D(y)<1.1*(v[r.label].covalentRadius+v[y.label].covalentRadius)&&
m.bonds.push(new w.Bond(r,y,1));m.atoms=m.atoms.concat(b);this.calculateRibbonDistances&&this.calculateDistances(m,b);return m};d.endChain=function(b,g,m,p){if(0<g.length){var l=g[g.length-1];l.cp1||(l.cp1=p[p.length-2]);l.cp2||(l.cp2=p[p.length-1]);for(p=0;4>p;p++)l=new w.Residue(-1),l.cp1=m,l.cp2=g[g.length-1].cp2,g.push(l);b.chains.push(g)}};d.calculateDistances=function(b,g){for(var m=[],p=0,l=b.atoms.length;p<l;p++){var r=b.atoms[p];r.hetatm&&(r.isWater||m.push(r))}b=0;for(p=g.length;b<p;b++)if(l=
g[b],l.closestDistance=Number.POSITIVE_INFINITY,0===m.length)l.closestDistance=0;else{r=0;for(var y=m.length;r<y;r++)l.closestDistance=Math.min(l.closestDistance,l.distance3D(m[r]))}};var e=new E.PDBInterpreter;n.readPDB=function(b,g){return e.read(b,g)}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.ELEMENT,ChemDoodle.lib.jQuery.trim,Math);
(function(n,E,w,v,k){var q={"@":0,A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,a:-1,b:-2,c:-3,d:-4,e:-5,f:-6,g:-7,h:-8,i:-9},d={"%":0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,j:-1,k:-2,l:-3,m:-4,n:-5,o:-6,p:-7,q:-8,r:-9},c={S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,s:9};E.JCAMPInterpreter=function(){};v=E.JCAMPInterpreter.prototype=new E._Interpreter;v.convertHZ2PPM=!1;v.read=function(b){this.isBreak=function(pa){return q[pa]!==k||d[pa]!==k||c[pa]!==k||" "===pa||"-"===pa||"+"===pa};this.getValue=function(pa,ta){var Ea=pa.charAt(0);
pa=pa.substring(1);return q[Ea]!==k?parseFloat(q[Ea]+pa):d[Ea]!==k?parseFloat(d[Ea]+pa)+ta:parseFloat(pa)};var g=new w.Spectrum;if(b===k||0===b.length)return g;b=b.split("\n");for(var m=[],p,l,r,y,x=1,A=1,H=1,a=-1,f=-1,t=!0,C=!1,F=0,I=b.length;F<I;F++){var L=b[F].trim(),O=L.indexOf("$$");-1!==O&&(L=L.substring(0,O));if(0!==m.length&&b[F].startsWith("##"))if(O=m.join(""),t&&100>O.length&&g.metadata.push(O),m=[L],O.startsWith("##TITLE="))g.title=O.substring(8).trim();else if(O.startsWith("##XUNITS="))g.xUnit=
O.substring(9).trim(),this.convertHZ2PPM&&"HZ"===g.xUnit.toUpperCase()&&(g.xUnit="PPM",C=!0);else if(O.startsWith("##YUNITS="))g.yUnit=O.substring(9).trim();else{if(!O.startsWith("##XYPAIRS="))if(O.startsWith("##FIRSTX="))l=parseFloat(O.substring(9).trim());else if(O.startsWith("##LASTX="))p=parseFloat(O.substring(8).trim());else if(O.startsWith("##FIRSTY="))r=parseFloat(O.substring(9).trim());else if(O.startsWith("##NPOINTS="))y=parseFloat(O.substring(10).trim());else if(O.startsWith("##XFACTOR="))x=
parseFloat(O.substring(10).trim());else if(O.startsWith("##YFACTOR="))A=parseFloat(O.substring(10).trim());else if(O.startsWith("##DELTAX="))parseFloat(O.substring(9).trim());else if(O.startsWith("##.OBSERVE FREQUENCY="))this.convertHZ2PPM&&(H=parseFloat(O.substring(21).trim()));else if(O.startsWith("##.SHIFT REFERENCE="))this.convertHZ2PPM&&(f=O.substring(19).split(","),a=parseInt(f[2].trim()),f=parseFloat(f[3].trim()));else if(O.startsWith("##XYDATA=")){C||(H=1);L=t=!1;O=O.split("\n");for(var S=
(p-l)/(y-1),W=l-S,V=r,Y=0,ba=void 0,X=1,ca=O.length;X<ca;X++){var ia=[];W=O[X].trim();var Z=[],oa=0;for(V=W.length;oa<V;oa++)this.isBreak(W.charAt(oa))?(0<Z.length&&(1!==Z.length||" "!==Z[0])&&ia.push(Z.join("")),Z=[W.charAt(oa)]):Z.push(W.charAt(oa));ia.push(Z.join(""));W=parseFloat(ia[0])*x-S;Z=1;for(oa=ia.length;Z<oa;Z++)if(V=ia[Z],c[V.charAt(0)]!==k)for(var ka=parseInt(c[V.charAt(0)]+V.substring(1))-1,na=0;na<ka;na++)W+=S,Y=this.getValue(ba,Y),V=Y*A,g.data[g.data.length-1]=new w.Point(W/H,V);
else q[V.charAt(0)]!==k&&L?V=this.getValue(V,Y)*A:(L=d[V.charAt(0)]!==k,ba=V,W+=S,Y=this.getValue(V,Y),V=Y*A,g.data.push(new w.Point(W/H,V)))}if(-1!==a)for(L=f-g.data[a-1].x,O=0,S=g.data.length;O<S;O++)g.data[O].x+=L}else if(O.startsWith("##PEAK TABLE="))for(t=!1,g.continuous=!1,L=O.split("\n"),O=/[\s,]+/,S=1,Y=L.length;S<Y;S++)for(ba=L[S].split(O),X=0,ca=ba.length;X+1<ca;X+=2)g.data.push(new w.Point(parseFloat(ba[X].trim()),parseFloat(ba[X+1].trim())));else if(O.startsWith("##ATOMLIST="))for(g.molecule=
new w.Molecule,L=O.split("\n"),O=/[\s]+/,S=1,Y=L.length;S<Y;S++)ba=L[S].split(O),g.molecule.atoms.push(new w.Atom(ba[1]));else if(O.startsWith("##BONDLIST="))for(L=O.split("\n"),O=/[\s]+/,S=1,Y=L.length;S<Y;S++)ba=L[S].split(O),X=1,"D"===ba[2]?X=2:"T"===ba[2]&&(X=3),g.molecule.bonds.push(new w.Bond(g.molecule.atoms[parseInt(ba[0])-1],g.molecule.atoms[parseInt(ba[1])-1],X));else if(g.molecule&&O.startsWith("##XY_RASTER=")){L=O.split("\n");O=/[\s]+/;S=1;for(Y=L.length;S<Y;S++)ba=L[S].split(O),X=g.molecule.atoms[parseInt(ba[0])-
1],X.x=parseInt(ba[1]),X.y=parseInt(ba[2]),4==ba.length&&(X.z=parseInt(ba[3]));g.molecule.scaleToAverageBondLength(20)}else if(O.startsWith("##PEAK ASSIGNMENTS="))for(L=O.split("\n"),O=/[\s,()<>]+/,g.assignments=[],S=1,Y=L.length;S<Y;S++){ca=L[S].split(O);ba=parseFloat(ca[1]);X=parseFloat(ca[2]);ca=g.molecule.atoms[parseInt(ca[3])-1];ia=!1;W=0;for(Z=g.assignments.length;W<Z;W++)if(oa=g.assignments[W],oa.x===ba){oa.as.push(ca);ca.assigned=oa;ia=!0;break}ia||(ba={x:ba,y:X,as:[ca]},ca.assigned=ba,g.assignments.push(ba))}}else L=
L.trim(),0!==m.length&&0!==L.length&&m.push("\n"),m.push(L)}g.setup();return g};v.makeStructureSpectrumSet=function(b,g){this.convertHZ2PPM=!0;var m=this.read(g),p=new n.ViewerCanvas(b+"_molecule",200,200);p.styles.atoms_displayTerminalCarbonLabels_2D=!0;p.styles.atoms_displayImplicitHydrogens_2D=!0;p.mouseout=function(r){if(0!==this.molecules.length){r=0;for(var y=this.molecules[0].atoms.length;r<y;r++)this.molecules[0].atoms[r].isHover=!1;m.hovered=k;this.repaint();l.repaint()}};p.touchend=p.mouseout;
p.mousemove=function(r){if(0!==this.molecules.length){for(var y=k,x=0,A=this.molecules[0].atoms.length;x<A;x++){var H=this.molecules[0].atoms[x];H.isHover=!1;H.assigned&&(y===k||r.p.distance(H)<r.p.distance(y))&&(y=H)}m.hovered=k;if(20>r.p.distance(y)){r=0;for(x=y.assigned.as.length;r<x;r++)y.assigned.as[r].isHover=!0;l.spectrum.hovered=y.assigned}this.repaint();l.repaint()}};p.touchmove=p.mousemove;p.drawChildExtras=function(r,y){if(0!==this.molecules.length)for(var x=0,A=this.molecules[0].atoms.length;x<
A;x++)this.molecules[0].atoms[x].drawDecorations(r,y)};var l=new n.ObserverCanvas(b+"_spectrum",400,200);l.styles.plots_showYAxis=!1;l.styles.plots_flipXAxis=!0;l.mouseout=function(r){if(this.spectrum&&this.spectrum.assignments){r=0;for(var y=p.molecules[0].atoms.length;r<y;r++)p.molecules[0].atoms[r].isHover=!1;this.spectrum.hovered=k;p.repaint();this.repaint()}};l.touchend=l.mouseout;l.mousemove=function(r){if(this.spectrum&&this.spectrum.assignments){for(var y=k,x=0,A=p.molecules[0].atoms.length;x<
A;x++)p.molecules[0].atoms[x].isHover=!1;this.spectrum.hovered=k;x=0;for(A=this.spectrum.assignments.length;x<A;x++){var H=this.spectrum.assignments[x];if(y===k||Math.abs(this.spectrum.getTransformedX(H.x,this.styles,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-r.p.x)<Math.abs(this.spectrum.getTransformedX(y.x,this.styles,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-r.p.x))y=H}if(20>Math.abs(this.spectrum.getTransformedX(y.x,this.styles,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-
r.p.x)){r=0;for(x=y.as.length;r<x;r++)y.as[r].isHover=!0;this.spectrum.hovered=y}p.repaint();this.repaint()}};l.touchmove=l.mousemove;l.drawChildExtras=function(r){if(this.spectrum&&this.spectrum.hovered){var y=this.spectrum.getTransformedX(this.spectrum.hovered.x,l.styles,this.spectrum.memory.width,this.spectrum.memory.offsetLeft);y>=this.spectrum.memory.offsetLeft&&y<this.spectrum.memory.width&&(r.save(),r.strokeStyle="#885110",r.lineWidth=3,r.beginPath(),r.moveTo(y,this.spectrum.memory.height-
this.spectrum.memory.offsetBottom),r.lineTo(y,this.spectrum.getTransformedY(this.spectrum.hovered.y,l.styles,this.spectrum.memory.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)),r.stroke(),r.restore())}};m&&(l.loadSpectrum(m),m.molecule&&p.loadMolecule(m.molecule));return[p,l]};var e=new E.JCAMPInterpreter;e.convertHZ2PPM=!0;n.readJCAMP=function(b){return e.read(b)}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery);
(function(n,E,w,v,k,q,d){E.JSONInterpreter=function(){};var c=E.JSONInterpreter.prototype;c.contentTo=function(b,g){b||(b=[]);g||(g=[]);for(var m=0,p=0,l=0,r=b.length;l<r;l++){for(var y=b[l],x=0,A=y.atoms.length;x<A;x++)y.atoms[x].tmpid="a"+m++;x=0;for(A=y.bonds.length;x<A;x++)y.bonds[x].tmpid="b"+p++}p=m=0;for(l=g.length;p<l;p++)g[p].tmpid="s"+m++;m={};if(b&&0<b.length)for(m.m=[],p=0,l=b.length;p<l;p++)m.m.push(this.molTo(b[p]));if(g&&0<g.length)for(m.s=[],p=0,l=g.length;p<l;p++)m.s.push(this.shapeTo(g[p]));
p=0;for(l=b.length;p<l;p++){r=b[p];y=0;for(x=r.atoms.length;y<x;y++)r.atoms[y].tmpid=d;y=0;for(x=r.bonds.length;y<x;y++)r.bonds[y].tmpid=d}b=0;for(p=g.length;b<p;b++)g[b].tmpid=d;return m};c.contentFrom=function(b){var g={molecules:[],shapes:[]};if(b.m)for(var m=0,p=b.m.length;m<p;m++)g.molecules.push(this.molFrom(b.m[m]));if(b.s)for(m=0,p=b.s.length;m<p;m++)g.shapes.push(this.shapeFrom(b.s[m],g.molecules));b=0;for(m=g.molecules.length;b<m;b++){p=g.molecules[b];for(var l=0,r=p.atoms.length;l<r;l++)p.atoms[l].tmpid=
d;l=0;for(r=p.bonds.length;l<r;l++)p.bonds[l].tmpid=d}b=0;for(m=g.shapes.length;b<m;b++)g.shapes[b].tmpid=d;return g};c.queryTo=function(b){var g={},m=function(p,l,r,y){l&&(p[r]={v:y?b.outputRange(l.v):l.v,n:l.not})};b.type===w.Query.TYPE_ATOM?(m(g,b.elements,"as"),m(g,b.chirality,"@"),m(g,b.aromatic,"A"),m(g,b.charge,"C",!0),m(g,b.hydrogens,"H",!0),m(g,b.ringCount,"R",!0),m(g,b.saturation,"S"),m(g,b.connectivity,"X",!0),m(g,b.connectivityNoH,"x",!0)):(m(g,b.orders,"bs"),m(g,b.stereo,"@"),m(g,b.aromatic,
"A"),m(g,b.ringCount,"R",!0));return g};c.molTo=function(b){for(var g={a:[]},m=0,p=b.atoms.length;m<p;m++){var l=b.atoms[m],r={x:l.x,y:l.y};l.tmpid&&(r.i=l.tmpid);"C"!==l.label&&(r.l=l.label);0!==l.z&&(r.z=l.z);0!==l.charge&&(r.c=l.charge);-1!==l.mass&&(r.m=l.mass);-1!==l.implicitH&&(r.h=l.implicitH);0!==l.numRadical&&(r.r=l.numRadical);0!==l.numLonePair&&(r.p=l.numLonePair);l.query&&(r.q=this.queryTo(l.query));g.a.push(r)}if(0<b.bonds.length)for(g.b=[],m=0,p=b.bonds.length;m<p;m++)l=b.bonds[m],r=
{b:b.atoms.indexOf(l.a1),e:b.atoms.indexOf(l.a2)},l.tmpid&&(r.i=l.tmpid),1!==l.bondOrder&&(r.o=l.bondOrder),l.stereo!==w.Bond.STEREO_NONE&&(r.s=l.stereo),l.query&&(r.q=this.queryTo(l.query)),g.b.push(r);return g};c.queryFrom=function(b){var g=new w.Query(b.as?w.Query.TYPE_ATOM:w.Query.TYPE_BOND),m=function(p,l,r,y){l&&(p[r]={},p[r].v=y?p.parseRange(l.v):l.v,l.n&&(p[r].not=!0))};g.type===w.Query.TYPE_ATOM?(m(g,b.as,"elements"),m(g,b["@"],"chirality"),m(g,b.A,"aromatic"),m(g,b.C,"charge",!0),m(g,b.H,
"hydrogens",!0),m(g,b.R,"ringCount",!0),m(g,b.S,"saturation"),m(g,b.X,"connectivity",!0),m(g,b.x,"connectivityNoH",!0)):(m(g,b.bs,"orders"),m(g,b["@"],"stereo"),m(g,b.A,"aromatic"),m(g,b.R,"ringCount",!0));return g};c.molFrom=function(b){for(var g=new w.Molecule,m=0,p=b.a.length;m<p;m++){var l=b.a[m],r=new w.Atom(l.l?l.l:"C",l.x,l.y);l.i&&(r.tmpid=l.i);l.z&&(r.z=l.z);l.c&&(r.charge=l.c);l.m&&(r.mass=l.m);l.h&&(r.implicitH=l.h);l.r&&(r.numRadical=l.r);l.p&&(r.numLonePair=l.p);l.q&&(r.query=this.queryFrom(l.q));
l.p_h!==d&&(r.hetatm=l.p_h);l.p_w!==d&&(r.isWater=l.p_w);l.p_d!==d&&(r.closestDistance=l.p_d);g.atoms.push(r)}if(b.b)for(m=0,p=b.b.length;m<p;m++)l=b.b[m],r=new w.Bond(g.atoms[l.b],g.atoms[l.e],l.o===d?1:l.o),l.i&&(r.tmpid=l.i),l.s&&(r.stereo=l.s),l.q&&(r.query=this.queryFrom(l.q)),g.bonds.push(r);return g};c.shapeTo=function(b){var g={};b.tmpid&&(g.i=b.tmpid);if(b instanceof v.Line)g.t="Line",g.x1=b.p1.x,g.y1=b.p1.y,g.x2=b.p2.x,g.y2=b.p2.y,g.a=b.arrowType;else if(b instanceof v.Pusher)g.t="Pusher",
g.o1=b.o1.tmpid,g.o2=b.o2.tmpid,1!==b.numElectron&&(g.e=b.numElectron);else if(b instanceof v.AtomMapping)g.t="AtomMapping",g.a1=b.o1.tmpid,g.a2=b.o2.tmpid;else if(b instanceof v.Bracket)g.t="Bracket",g.x1=b.p1.x,g.y1=b.p1.y,g.x2=b.p2.x,g.y2=b.p2.y,0!==b.charge&&(g.c=b.charge),0!==b.mult&&(g.m=b.mult),0!==b.repeat&&(g.r=b.repeat);else if(b instanceof v.DynamicBracket)g.t="DynamicBracket",g.b1=b.b1.tmpid,g.b2=b.b2.tmpid,g.n1=b.n1,g.n2=b.n2,!0===b.flip&&(g.f=!0);else if(b instanceof v.VAP){g.t="VAP";
g.x=b.asterisk.x;g.y=b.asterisk.y;1!==b.bondType&&(g.o=b.bondType);b.substituent&&(g.s=b.substituent.tmpid);g.a=[];for(var m=0,p=b.attachments.length;m<p;m++)g.a.push(b.attachments[m].tmpid)}else if(b instanceof k.Distance)g.t="Distance",g.a1=b.a1.tmpid,g.a2=b.a2.tmpid,b.node&&(g.n=b.node,g.o=b.offset);else if(b instanceof k.Angle)g.t="Angle",g.a1=b.a1.tmpid,g.a2=b.a2.tmpid,g.a3=b.a3.tmpid;else if(b instanceof k.Torsion)g.t="Torsion",g.a1=b.a1.tmpid,g.a2=b.a2.tmpid,g.a3=b.a3.tmpid,g.a4=b.a4.tmpid;
else if(b instanceof k._Surface){g.t="Surface";g.a=[];m=0;for(p=b.atoms.length;m<p;m++)g.a.push(b.atoms[m].tmpid);b instanceof k.VDWSurface||(g.p=b.probeRadius);g.r=b.resolution;m="vdw";b instanceof k.SASSurface?m="sas":k.SESSurface&&b instanceof k.SESSurface&&(m="ses");g.f=m}else if(b instanceof k.UnitCell)for(m in g.t="UnitCell",b.unitCell)g[m]=b.unitCell[m];return g};c.shapeFrom=function(b,g){if("Line"===b.t){var m=new v.Line(new w.Point(b.x1,b.y1),new w.Point(b.x2,b.y2));m.arrowType=b.a}else if("Pusher"===
b.t){var p,l;m=0;for(var r=g.length;m<r;m++){for(var y=g[m],x=0,A=y.atoms.length;x<A;x++){var H=y.atoms[x];H.tmpid===b.o1?p=H:H.tmpid===b.o2&&(l=H)}x=0;for(A=y.bonds.length;x<A;x++)H=y.bonds[x],H.tmpid===b.o1?p=H:H.tmpid===b.o2&&(l=H)}m=new v.Pusher(p,l);b.e&&(m.numElectron=b.e)}else if("AtomMapping"===b.t){m=0;for(p=g.length;m<p;m++)for(l=g[m],x=0,A=l.atoms.length;x<A;x++)H=l.atoms[x],H.tmpid===b.a1?r=H:H.tmpid===b.a2&&(y=H);m=new v.AtomMapping(r,y)}else if("Bracket"===b.t)m=new v.Bracket(new w.Point(b.x1,
b.y1),new w.Point(b.x2,b.y2)),b.c!==d&&(m.charge=b.c),b.m!==d&&(m.mult=b.m),b.r!==d&&(m.repeat=b.r);else if("DynamicBracket"===b.t){m=0;for(p=g.length;m<p;m++)for(l=g[m],r=0,y=l.bonds.length;r<y;r++)H=l.bonds[r],H.tmpid===b.b1?x=H:H.tmpid===b.b2&&(A=H);m=new v.DynamicBracket(x,A);m.n1=b.n1;m.n2=b.n2;b.f&&(m.flip=!0)}else if("VAP"===b.t)for(m=new v.VAP(b.x,b.y),b.o&&(m.bondType=b.o),p=0,l=g.length;p<l;p++)for(r=g[p],y=0,x=r.atoms.length;y<x;y++)if(A=r.atoms[y],A.tmpid===b.s)m.substituent=A;else{H=
0;for(var a=b.a.length;H<a;H++)A.tmpid===b.a[H]&&m.attachments.push(A)}else if("Distance"===b.t){m=0;for(p=g.length;m<p;m++)for(l=g[m],r=0,y=l.atoms.length;r<y;r++)x=l.atoms[r],x.tmpid===b.a1?H=x:x.tmpid===b.a2&&(a=x);m=new k.Distance(H,a,b.n,b.o)}else if("Angle"===b.t){var f,t,C;m=0;for(p=g.length;m<p;m++)for(l=g[m],r=0,y=l.atoms.length;r<y;r++)x=l.atoms[r],x.tmpid===b.a1?f=x:x.tmpid===b.a2?t=x:x.tmpid===b.a3&&(C=x);m=new k.Angle(f,t,C)}else if("Torsion"===b.t){var F,I,L,O;m=0;for(p=g.length;m<p;m++)for(l=
g[m],r=0,y=l.atoms.length;r<y;r++)x=l.atoms[r],x.tmpid===b.a1?F=x:x.tmpid===b.a2?I=x:x.tmpid===b.a3?L=x:x.tmpid===b.a4&&(O=x);m=new k.Torsion(F,I,L,O)}else if("Surface"===b.t){p=[];l=0;for(r=g.length;l<r;l++)for(y=g[l],x=0,A=y.atoms.length;x<A;x++)for(H=y.atoms[x],a=0,f=b.a.length;a<f;a++)H.tmpid===b.a[a]&&p.push(H);g=b.p?b.p:1.4;l=b.r?b.r:30;"vdw"===b.f?m=new k.VDWSurface(p,l):"sas"===b.f?m=new k.SASSurface(p,g,l):"ses"===b.f&&(m=new k.SESSurface(p,g,l))}else if("UnitCell"===b.t){g={};for(var S in b)g[S]=
b[S];m=new k.UnitCell(g)}return m};c.pdbFrom=function(b){var g=this.molFrom(b.mol);g.findRings=!1;g.fromJSON=!0;g.chains=this.chainsFrom(b.ribbons);return g};c.chainsFrom=function(b){for(var g=[],m=0,p=b.cs.length;m<p;m++){for(var l=b.cs[m],r=[],y=0,x=l.length;y<x;y++){var A=l[y],H=new w.Residue;H.name=A.n;H.cp1=new w.Atom("",A.x1,A.y1,A.z1);H.cp2=new w.Atom("",A.x2,A.y2,A.z2);A.x3&&(H.cp3=new w.Atom("",A.x3,A.y3,A.z3),H.cp4=new w.Atom("",A.x4,A.y4,A.z4),H.cp5=new w.Atom("",A.x5,A.y5,A.z5));H.helix=
A.h;H.sheet=A.s;H.arrow=0<y&&l[y-1].a;r.push(H)}g.push(r)}return g};var e=new E.JSONInterpreter;n.readJSON=function(b){try{var g=q.parse(b)}catch(m){return d}return g?g.m||g.s?e.contentFrom(g):g.a?{molecules:[e.molFrom(g)],shapes:[]}:{molecules:[],shapes:[]}:d};n.writeJSON=function(b,g){return q.stringify(e.contentTo(b,g))}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.structures.d2,ChemDoodle.structures.d3,JSON);
(function(n,E,w,v){E.RXNInterpreter=function(){};var k=E.RXNInterpreter.prototype=new E._Interpreter;k.read=function(d,c){c||(c=n.DEFAULT_STYLES.bondLength_2D);var e=[];if(d){var b=d.split("$MOL\n");d=b[0].split("\n")[4];for(var g=parseInt(d.substring(0,3)),m=parseInt(d.substring(3,6)),p=1,l=d=0,r=g+m;l<r;l++){e[l]=n.readMOL(b[p],c);var y=e[l].getBounds();d-=y.maxX-y.minX+40;p++}for(c=0;c<g;c++){b=e[c].getBounds();b=b.maxX-b.minX;p=e[c].getCenter();l=0;for(r=e[c].atoms.length;l<r;l++)y=e[c].atoms[l],
y.x+=d+b/2-p.x,y.y-=p.y;d+=b+40}c=new w.d2.Line(new w.Point(d,0),new w.Point(d+40,0));d+=80;b=g;for(g+=m;b<g;b++){m=e[b].getBounds();m=m.maxX-m.minX;p=e[b].getCenter();for(l=0;l<e[b].atoms.length;l++)r=e[b].atoms[l],r.x+=d+m/2-p.x,r.y-=p.y;d+=m+40}}else e.push(new w.Molecule),c=new w.d2.Line(new w.Point(-20,0),new w.Point(20,0));c.arrowType=w.d2.Line.ARROW_SYNTHETIC;return{molecules:e,shapes:[c]}};k.write=function(d,c){var e=[[],[]],b=v;if(d&&c){for(var g=0,m=c.length;g<m;g++)if(c[g]instanceof w.d2.Line){b=
c[g].getPoints();break}if(!b)return"";c=0;for(g=d.length;c<g;c++)d[c].getCenter().x<b[1].x?e[0].push(d[c]):e[1].push(d[c]);d=[];d.push("$RXN\nReaction from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n");d.push(this.fit(e[0].length.toString(),3));d.push(this.fit(e[1].length.toString(),3));d.push("\n");for(b=0;2>b;b++)for(c=0,g=e[b].length;c<g;c++)d.push("$MOL\n"),d.push(n.writeMOL(e[b][c])),d.push("\n");return d.join("")}};var q=new E.RXNInterpreter;n.readRXN=function(d,c){return q.read(d,
c)};n.writeRXN=function(d,c){return q.write(d,c)}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures);
(function(n,E,w,v,k,q,d){v.XYZInterpreter=function(){};E=v.XYZInterpreter.prototype=new v._Interpreter;E.deduceCovalentBonds=!0;E.read=function(e){var b=new k.Molecule;if(!e)return b;e=e.split("\n");for(var g=parseInt(q(e[0])),m=0;m<g;m++){var p=e[m+2].split(/\s+/g);b.atoms[m]=new k.Atom(isNaN(p[0])?p[0]:w[parseInt(p[0])-1],parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3]))}this.deduceCovalentBonds&&(new n.informatics.BondDeducer).deduceCovalentBonds(b,1);return b};var c=new v.XYZInterpreter;n.readXYZ=
function(e){return c.read(e)}})(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.SYMBOLS,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery.trim);
ChemDoodle.monitor=function(n,E,w,v){var k={};k.CANVAS_DRAGGING=v;k.CANVAS_OVER=v;k.ALT=!1;k.SHIFT=!1;k.META=!1;n.supports_touch()||E(w).ready(function(){E(w).mousemove(function(q){k.CANVAS_DRAGGING&&k.CANVAS_DRAGGING.drag&&(k.CANVAS_DRAGGING.prehandleEvent(q),k.CANVAS_DRAGGING.drag(q))});E(w).mouseup(function(q){k.CANVAS_DRAGGING&&k.CANVAS_DRAGGING!==k.CANVAS_OVER&&k.CANVAS_DRAGGING.mouseup&&(k.CANVAS_DRAGGING.prehandleEvent(q),k.CANVAS_DRAGGING.mouseup(q));k.CANVAS_DRAGGING=v});E(w).keydown(function(q){k.SHIFT=
q.shiftKey;k.ALT=q.altKey;k.META=q.metaKey||q.ctrlKey;var d=k.CANVAS_OVER;k.CANVAS_DRAGGING&&(d=k.CANVAS_DRAGGING);d&&d.keydown&&(d.prehandleEvent(q),d.keydown(q))});E(w).keypress(function(q){var d=k.CANVAS_OVER;k.CANVAS_DRAGGING&&(d=k.CANVAS_DRAGGING);d&&d.keypress&&(d.prehandleEvent(q),d.keypress(q))});E(w).keyup(function(q){k.SHIFT=q.shiftKey;k.ALT=q.altKey;k.META=q.metaKey||q.ctrlKey;var d=k.CANVAS_OVER;k.CANVAS_DRAGGING&&(d=k.CANVAS_DRAGGING);d&&d.keyup&&(d.prehandleEvent(q),d.keyup(q))})});
return k}(ChemDoodle.featureDetection,ChemDoodle.lib.jQuery,document);
(function(n,E,w,v,k,q,d,c,e,b,g){n._Canvas=function(){};var m=n._Canvas.prototype;m.molecules=g;m.shapes=g;m.emptyMessage=g;m.image=g;m.repaint=function(){if(!this.test){var p=c.getElementById(this.id);if(p.getContext){var l=p.getContext("2d");1!==this.pixelRatio&&p.width===this.width&&(p.width=this.width*this.pixelRatio,p.height=this.height*this.pixelRatio,l.scale(this.pixelRatio,this.pixelRatio));if(this.image)l.drawImage(this.image,0,0);else{var r=this.styles.backgroundColor?this.styles.backgroundColor:
"transparent";l.clearRect(0,0,this.width,this.height);this.bgCache!==r&&(p.style.backgroundColor=r,this.bgCache=p.style.backgroundColor);"transparent"!==r&&(l.fillStyle=r,l.fillRect(0,0,this.width,this.height))}if(this.innerRepaint)this.innerRepaint(l);else if(0!==this.molecules.length||0!==this.shapes.length){l.save();l.translate(this.width/2,this.height/2);l.rotate(this.styles.rotateAngle);l.scale(this.styles.scale,this.styles.scale);l.translate(-this.width/2,-this.height/2);p=0;for(r=this.molecules.length;p<
r;p++)this.molecules[p].check(!0),this.molecules[p].draw(l,this.styles);this.checksOnAction&&this.checksOnAction(!0);p=0;for(r=this.shapes.length;p<r;p++)this.shapes[p].draw(l,this.styles);l.restore()}else this.emptyMessage&&(l.fillStyle="#737683",l.textAlign="center",l.textBaseline="middle",l.font="18px Helvetica, Verdana, Arial, Sans-serif",l.fillText(this.emptyMessage,this.width/2,this.height/2));this.drawChildExtras&&this.drawChildExtras(l,this.styles)}}};m.resize=function(p,l){var r=q("#"+this.id);
r.attr({width:p,height:l});r.css("width",p);r.css("height",l);this.width=p;this.height=l;if(n._Canvas3D&&this instanceof n._Canvas3D)1!==this.pixelRatio&&(p*=this.pixelRatio,l*=this.pixelRatio,this.gl.canvas.width=p,this.gl.canvas.height=l),this.gl.viewport(0,0,p,l),this.afterLoadContent();else if(0<this.molecules.length)for(this.center(),l=0,p=this.molecules.length;l<p;l++)this.molecules[l].check();this.repaint()};m.setBackgroundImage=function(p){this.image=new Image;var l=this;this.image.onload=
function(){l.repaint()};this.image.src=p};m.loadMolecule=function(p){this.clear();this.molecules.push(p);for(var l=0;2>l;l++)this.center(),n._Canvas3D&&this instanceof n._Canvas3D||p.check(),this.afterLoadContent&&this.afterLoadContent(),this.repaint()};m.loadContent=function(p,l){this.molecules=p?p:[];this.shapes=l?l:[];for(p=0;2>p;p++){this.center();if(!(n._Canvas3D&&this instanceof n._Canvas3D)){l=0;for(var r=this.molecules.length;l<r;l++)this.molecules[l].check()}this.afterLoadContent&&this.afterLoadContent();
this.repaint()}};m.addMolecule=function(p){this.molecules.push(p);n._Canvas3D&&this instanceof n._Canvas3D||p.check();this.repaint()};m.removeMolecule=function(p){this.molecules=q.grep(this.molecules,function(l){return l!==p});this.repaint()};m.getMolecule=function(){return 0<this.molecules.length?this.molecules[0]:g};m.getMolecules=function(){return this.molecules};m.addShape=function(p){this.shapes.push(p);this.repaint()};m.removeShape=function(p){this.shapes=q.grep(this.shapes,function(l){return l!==
p});this.repaint()};m.getShapes=function(){return this.shapes};m.clear=function(){this.molecules=[];this.shapes=[];this.styles.scale=1;this.repaint()};m.center=function(){for(var p=this.getContentBounds(),l=new k.Point((this.width-p.minX-p.maxX)/2,(this.height-p.minY-p.maxY)/2),r=0,y=this.molecules.length;r<y;r++)for(var x=this.molecules[r],A=0,H=x.atoms.length;A<H;A++)x.atoms[A].add(l);r=0;for(y=this.shapes.length;r<y;r++)for(x=this.shapes[r].getPoints(),A=0,H=x.length;A<H;A++)x[A].add(l);this.styles.scale=
1;l=p.maxX-p.minX;p=p.maxY-p.minY;if(l>this.width-20||p>this.height-20)this.styles.scale=.85*d.min(this.width/l,this.height/p)};m.bondExists=function(p,l){for(var r=0,y=this.molecules.length;r<y;r++)for(var x=this.molecules[r],A=0,H=x.bonds.length;A<H;A++){var a=x.bonds[A];if(a.contains(p)&&a.contains(l))return!0}return!1};m.getBond=function(p,l){for(var r=0,y=this.molecules.length;r<y;r++)for(var x=this.molecules[r],A=0,H=x.bonds.length;A<H;A++){var a=x.bonds[A];if(a.contains(p)&&a.contains(l))return a}return g};
m.getMoleculeByAtom=function(p){for(var l=0,r=this.molecules.length;l<r;l++){var y=this.molecules[l];if(-1!==y.atoms.indexOf(p))return y}return e.undefined};m.getAllAtoms=function(){for(var p=[],l=0,r=this.molecules.length;l<r;l++)p=p.concat(this.molecules[l].atoms);return p};m.getAllBonds=function(){for(var p=[],l=0,r=this.molecules.length;l<r;l++)p=p.concat(this.molecules[l].bonds);return p};m.getAllPoints=function(){for(var p=[],l=0,r=this.molecules.length;l<r;l++)p=p.concat(this.molecules[l].atoms);
l=0;for(r=this.shapes.length;l<r;l++)p=p.concat(this.shapes[l].getPoints());return p};m.getContentBounds=function(){for(var p=new w.Bounds,l=0,r=this.molecules.length;l<r;l++)p.expand(this.molecules[l].getBounds());l=0;for(r=this.shapes.length;l<r;l++)p.expand(this.shapes[l].getBounds());return p};m.create=function(p,l,r){this.id=p;this.width=l;this.height=r;this.molecules=[];this.shapes=[];if(c.getElementById(p)){var y=q("#"+p);l?y.attr("width",l):this.width=parseInt(y.attr("width"));r?y.attr("height",
r):this.height=parseInt(y.attr("height"));y.attr("class","ChemDoodleWebComponent")}else if(n.featureDetection.supports_canvas_text()||-1==b.indexOf("MSIE"))c.writeln('<canvas class="ChemDoodleWebComponent" id="'+p+'" width="'+l+'" height="'+r+'" alt="ChemDoodle Web Component">This browser does not support HTML5/Canvas.</canvas>');else{c.writeln('<div style="border: 1px solid black;" width="'+l+'" height="'+r+'">Please install <a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a>, then restart Internet Explorer.</div>');
return}p=q("#"+p);p.css("width",this.width);p.css("height",this.height);this.pixelRatio=e.devicePixelRatio?e.devicePixelRatio:1;this.styles=new k.Styles;var x=this;E.supports_touch()?(p.bind("touchstart",function(A){var H=(new Date).getTime();if(!E.supports_gesture()&&2===A.originalEvent.touches.length){var a=A.originalEvent.touches,f=new k.Point(a[0].pageX,a[0].pageY);a=new k.Point(a[1].pageX,a[1].pageY);x.implementedGestureDist=f.distance(a);x.implementedGestureAngle=f.angle(a);x.gesturestart&&
(x.prehandleEvent(A),x.gesturestart(A))}x.lastTouch&&1===A.originalEvent.touches.length&&500>H-x.lastTouch?x.dbltap?(x.prehandleEvent(A),x.dbltap(A)):x.dblclick?(x.prehandleEvent(A),x.dblclick(A)):x.touchstart?(x.prehandleEvent(A),x.touchstart(A)):x.mousedown&&(x.prehandleEvent(A),x.mousedown(A)):x.touchstart?(x.prehandleEvent(A),x.touchstart(A),this.hold&&clearTimeout(this.hold),this.touchhold&&(this.hold=setTimeout(function(){x.touchhold(A)},1E3))):x.mousedown&&(x.prehandleEvent(A),x.mousedown(A));
x.lastTouch=H}),p.bind("touchmove",function(A){this.hold&&(clearTimeout(this.hold),this.hold=g);if(!E.supports_gesture()&&2===A.originalEvent.touches.length&&x.gesturechange){var H=A.originalEvent.touches,a=new k.Point(H[0].pageX,H[0].pageY),f=new k.Point(H[1].pageX,H[1].pageY);H=a.distance(f);a=a.angle(f);A.originalEvent.scale=H/x.implementedGestureDist;A.originalEvent.rotation=180*(x.implementedGestureAngle-a)/d.PI;x.prehandleEvent(A);x.gesturechange(A)}if(1<A.originalEvent.touches.length&&x.multitouchmove){a=
A.originalEvent.touches.length;x.prehandleEvent(A);H=new k.Point(-A.offset.left*a,-A.offset.top*a);for(f=0;f<a;f++)H.x+=A.originalEvent.changedTouches[f].pageX,H.y+=A.originalEvent.changedTouches[f].pageY;H.x/=a;H.y/=a;A.p=H;x.multitouchmove(A,a)}else x.touchmove?(x.prehandleEvent(A),x.touchmove(A)):x.drag&&(x.prehandleEvent(A),x.drag(A))}),p.bind("touchend",function(A){this.hold&&(clearTimeout(this.hold),this.hold=g);!E.supports_gesture()&&x.implementedGestureDist&&(x.implementedGestureDist=g,x.implementedGestureAngle=
g,x.gestureend&&(x.prehandleEvent(A),x.gestureend(A)));x.touchend?(x.prehandleEvent(A),x.touchend(A)):x.mouseup&&(x.prehandleEvent(A),x.mouseup(A));250>(new Date).getTime()-x.lastTouch&&(x.tap?(x.prehandleEvent(A),x.tap(A)):x.click&&(x.prehandleEvent(A),x.click(A)))}),p.bind("gesturestart",function(A){x.gesturestart&&(x.prehandleEvent(A),x.gesturestart(A))}),p.bind("gesturechange",function(A){x.gesturechange&&(x.prehandleEvent(A),x.gesturechange(A))}),p.bind("gestureend",function(A){x.gestureend&&
(x.prehandleEvent(A),x.gestureend(A))})):(p.click(function(A){switch(A.which){case 1:x.click&&(x.prehandleEvent(A),x.click(A));break;case 2:x.middleclick&&(x.prehandleEvent(A),x.middleclick(A));break;case 3:x.rightclick&&(x.prehandleEvent(A),x.rightclick(A))}}),p.dblclick(function(A){x.dblclick&&(x.prehandleEvent(A),x.dblclick(A))}),p.mousedown(function(A){switch(A.which){case 1:v.CANVAS_DRAGGING=x;x.mousedown&&(x.prehandleEvent(A),x.mousedown(A));break;case 2:x.middlemousedown&&(x.prehandleEvent(A),
x.middlemousedown(A));break;case 3:x.rightmousedown&&(x.prehandleEvent(A),x.rightmousedown(A))}}),p.mousemove(function(A){!v.CANVAS_DRAGGING&&x.mousemove&&(x.prehandleEvent(A),x.mousemove(A))}),p.mouseout(function(A){v.CANVAS_OVER=g;x.mouseout&&(x.prehandleEvent(A),x.mouseout(A))}),p.mouseover(function(A){v.CANVAS_OVER=x;x.mouseover&&(x.prehandleEvent(A),x.mouseover(A))}),p.mouseup(function(A){switch(A.which){case 1:x.mouseup&&(x.prehandleEvent(A),x.mouseup(A));break;case 2:x.middlemouseup&&(x.prehandleEvent(A),
x.middlemouseup(A));break;case 3:x.rightmouseup&&(x.prehandleEvent(A),x.rightmouseup(A))}}),p.mousewheel(function(A,H){x.mousewheel&&(x.prehandleEvent(A),x.mousewheel(A,H))}));this.subCreate&&this.subCreate()};m.prehandleEvent=function(p){p.originalEvent.changedTouches&&(p.pageX=p.originalEvent.changedTouches[0].pageX,p.pageY=p.originalEvent.changedTouches[0].pageY);this.doEventDefault||(p.preventDefault(),p.returnValue=!1);p.offset=q("#"+this.id).offset();p.p=new k.Point(p.pageX-p.offset.left,p.pageY-
p.offset.top)}})(ChemDoodle,ChemDoodle.featureDetection,ChemDoodle.math,ChemDoodle.monitor,ChemDoodle.structures,ChemDoodle.lib.jQuery,Math,document,window,navigator.userAgent);
(function(n,E,w){n._AnimatorCanvas=function(v,k,q){v&&this.create(v,k,q)};n=n._AnimatorCanvas.prototype=new n._Canvas;n.timeout=33;n.startAnimation=function(){this.stopAnimation();this.lastTime=(new Date).getTime();var v=this;this.nextFrame&&(this.handle=E.requestInterval(function(){var k=(new Date).getTime();v.nextFrame(k-v.lastTime);v.repaint();v.lastTime=k},this.timeout))};n.stopAnimation=function(){this.handle&&(E.clearRequestInterval(this.handle),this.handle=w)};n.isRunning=function(){return this.handle!==
w}})(ChemDoodle,ChemDoodle.animations);
(function(n,E,w){n.FileCanvas=function(v,k,q,d){v&&this.create(v,k,q);E.writeln('<br><form name="FileForm" enctype="multipart/form-data" method="POST" action="'+d+'" target="HiddenFileFrame"><input type="file" name="f" /><input type="submit" name="submitbutton" value="Show File" /></form><iframe id="HFF-'+v+'" name="HiddenFileFrame" height="0" width="0" style="display:none;" onLoad="GetMolFromFrame(\'HFF-'+v+"', "+v+')"></iframe>');this.emptyMessage="Click below to load file";this.repaint()};n.FileCanvas.prototype=
new n._Canvas})(ChemDoodle,document);
(function(n,E){n.HyperlinkCanvas=function(w,v,k,q,d,c){w&&this.create(w,v,k);this.urlOrFunction=q;this.color=d?d:"blue";this.size=c?c:2};n=n.HyperlinkCanvas.prototype=new n._Canvas;n.openInNewWindow=!0;n.hoverImage=E;n.drawChildExtras=function(w){this.e&&(this.hoverImage?w.drawImage(this.hoverImage,0,0):(w.strokeStyle=this.color,w.lineWidth=2*this.size,w.strokeRect(0,0,this.width,this.height)))};n.setHoverImage=function(w){this.hoverImage=new Image;this.hoverImage.src=w};n.click=function(w){this.e=
E;this.repaint();this.urlOrFunction instanceof Function?this.urlOrFunction():this.openInNewWindow?window.open(this.urlOrFunction):location.href=this.urlOrFunction};n.mouseout=function(w){this.e=E;this.repaint()};n.mouseover=function(w){this.e=w;this.repaint()}})(ChemDoodle);
(function(n,E,w,v,k){n.MolGrabberCanvas=function(q,d,c){q&&this.create(q,d,c);d=[];d.push('<br><input type="text" id="');d.push(q);d.push('_query" size="32" value="" />');d.push(this.getInputFields());v.getElementById(q);w("#"+q).after(d.join(""));var e=this;w("#"+q+"_submit").click(function(){e.search()});w("#"+q+"_query").keypress(function(b){13===b.which&&e.search()});this.emptyMessage="Enter search term below";this.repaint()};n=n.MolGrabberCanvas.prototype=new n._Canvas;n.setSearchTerm=function(q){w("#"+
this.id+"_query").val(q);this.search()};n.getInputFields=function(){var q=[];q.push("<br><nobr>");q.push('<select id="');q.push(this.id);q.push('_select">');q.push('<option value="chemexper">ChemExper');q.push('<option value="chemspider">ChemSpider');q.push('<option value="pubchem" selected>PubChem');q.push("</select>");q.push('<button type="button" id="');q.push(this.id);q.push('_submit">Show Molecule</button>');q.push("</nobr>");return q.join("")};n.search=function(){this.emptyMessage="Searching...";
this.clear();var q=this;E.getMoleculeFromDatabase(w("#"+this.id+"_query").val(),{database:w("#"+this.id+"_select").val()},function(d){q.loadMolecule(d)})}})(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery,document);
(function(n,E,w,v){var k=[],q=[1,0,0],d=[0,1,0],c=[0,0,1];n.RotatorCanvas=function(e,b,g,m){e&&this.create(e,b,g);this.rotate3D=m};n=n.RotatorCanvas.prototype=new n._AnimatorCanvas;E=E.PI/15;n.xIncrement=E;n.yIncrement=E;n.zIncrement=E;n.nextFrame=function(e){if(0===this.molecules.length&&0===this.shapes.length)this.stopAnimation();else if(e/=1E3,this.rotate3D){w.identity(k);w.rotate(k,this.xIncrement*e,q);w.rotate(k,this.yIncrement*e,d);w.rotate(k,this.zIncrement*e,c);e=0;for(var b=this.molecules.length;e<
b;e++){for(var g=this.molecules[e],m=0,p=g.atoms.length;m<p;m++){var l=g.atoms[m],r=[l.x-this.width/2,l.y-this.height/2,l.z];w.multiplyVec3(k,r);l.x=r[0]+this.width/2;l.y=r[1]+this.height/2;l.z=r[2]}m=0;for(p=g.rings.length;m<p;m++)g.rings[m].center=g.rings[m].getCenter();this.styles.atoms_display&&this.styles.atoms_circles_2D&&g.sortAtomsByZ();this.styles.bonds_display&&this.styles.bonds_clearOverlaps_2D&&g.sortBondsByZ()}e=0;for(b=this.shapes.length;e<b;e++)for(g=this.shapes[e].getPoints(),m=0,
p=g.length;m<p;m++)l=g[m],r=[l.x-this.width/2,l.y-this.height/2,0],w.multiplyVec3(k,r),l.x=r[0]+this.width/2,l.y=r[1]+this.height/2}else this.styles.rotateAngle+=this.zIncrement*e};n.dblclick=function(e){this.isRunning()?this.stopAnimation():this.startAnimation()}})(ChemDoodle,Math,ChemDoodle.lib.mat4);
(function(n,E,w,v){n.SlideshowCanvas=function(k,q,d){k&&this.create(k,q,d)};n=n.SlideshowCanvas.prototype=new n._AnimatorCanvas;n.frames=[];n.curIndex=0;n.timeout=5E3;n.alpha=0;n.innerHandle=v;n.phase=0;n.drawChildExtras=function(k){var q=w.getRGB(this.styles.backgroundColor,255);k.fillStyle="rgba("+q[0]+", "+q[1]+", "+q[2]+", "+this.alpha+")";k.fillRect(0,0,this.width,this.height)};n.nextFrame=function(k){if(0===this.frames.length)this.stopAnimation();else{this.phase=0;var q=this,d=1;this.innerHandle=
setInterval(function(){q.alpha=d/15;q.repaint();15===d&&q.breakInnerHandle();d++},33)}};n.breakInnerHandle=function(){this.innerHandle&&(clearInterval(this.innerHandle),this.innerHandle=v);if(0===this.phase){this.curIndex++;this.curIndex>this.frames.length-1&&(this.curIndex=0);this.alpha=1;var k=this.frames[this.curIndex];this.loadContent(k.mols,k.shapes);this.phase=1;var q=this,d=1;this.innerHandle=setInterval(function(){q.alpha=(15-d)/15;q.repaint();15===d&&q.breakInnerHandle();d++},33)}else 1===
this.phase&&(this.alpha=0,this.repaint())};n.addFrame=function(k,q){0===this.frames.length&&this.loadContent(k,q);this.frames.push({mols:k,shapes:q})}})(ChemDoodle,ChemDoodle.animations,ChemDoodle.math);
(function(n,E,w,v,k,q){n.TransformCanvas=function(d,c,e,b){d&&this.create(d,c,e);this.rotate3D=b};n=n.TransformCanvas.prototype=new n._Canvas;n.lastPoint=q;n.rotationMultMod=1.3;n.lastPinchScale=1;n.lastGestureRotate=0;n.mousedown=function(d){this.lastPoint=d.p};n.dblclick=function(d){this.center();this.repaint()};n.drag=function(d){if(!this.lastPoint.multi){if(E.ALT){var c=new w.Point(d.p.x,d.p.y);c.sub(this.lastPoint);for(var e=0,b=this.molecules.length;e<b;e++){for(var g=this.molecules[e],m=0,
p=g.atoms.length;m<p;m++)g.atoms[m].add(c);g.check()}e=0;for(b=this.shapes.length;e<b;e++)for(g=this.shapes[e].getPoints(),m=0,p=g.length;m<p;m++)g[m].add(c);this.lastPoint=d.p}else if(!0===this.rotate3D)for(c=v.max(this.width/4,this.height/4),e=(d.p.x-this.lastPoint.x)/c*this.rotationMultMod,b=-(d.p.y-this.lastPoint.y)/c*this.rotationMultMod,c=[],k.identity(c),k.rotate(c,b,[1,0,0]),k.rotate(c,e,[0,1,0]),e=0,b=this.molecules.length;e<b;e++){g=this.molecules[e];m=0;for(p=g.atoms.length;m<p;m++){var l=
g.atoms[m],r=[l.x-this.width/2,l.y-this.height/2,l.z];k.multiplyVec3(c,r);l.x=r[0]+this.width/2;l.y=r[1]+this.height/2;l.z=r[2]}m=0;for(p=g.rings.length;m<p;m++)g.rings[m].center=g.rings[m].getCenter();this.lastPoint=d.p;this.styles.atoms_display&&this.styles.atoms_circles_2D&&g.sortAtomsByZ();this.styles.bonds_display&&this.styles.bonds_clearOverlaps_2D&&g.sortBondsByZ()}else e=new w.Point(this.width/2,this.height/2),c=e.angle(this.lastPoint),e=e.angle(d.p),this.styles.rotateAngle-=e-c,this.lastPoint=
d.p;this.repaint()}};n.mousewheel=function(d,c){this.styles.scale+=c/50;.01>this.styles.scale&&(this.styles.scale=.01);this.repaint()};n.multitouchmove=function(d,c){if(2===c)if(this.lastPoint.multi){c=new w.Point(d.p.x,d.p.y);c.sub(this.lastPoint);for(var e=0,b=this.molecules.length;e<b;e++){for(var g=this.molecules[e],m=0,p=g.atoms.length;m<p;m++)g.atoms[m].add(c);g.check()}e=0;for(b=this.shapes.length;e<b;e++)for(g=this.shapes[e].getPoints(),m=0,p=g.length;m<p;m++)g[m].add(c);this.lastPoint=d.p;
this.lastPoint.multi=!0;this.repaint()}else this.lastPoint=d.p,this.lastPoint.multi=!0};n.gesturechange=function(d){0!==d.originalEvent.scale-this.lastPinchScale&&(this.styles.scale*=d.originalEvent.scale/this.lastPinchScale,.01>this.styles.scale&&(this.styles.scale=.01),this.lastPinchScale=d.originalEvent.scale);if(0!==this.lastGestureRotate-d.originalEvent.rotation){for(var c=(this.lastGestureRotate-d.originalEvent.rotation)/180*v.PI,e=new w.Point(this.width/2,this.height/2),b=0,g=this.molecules.length;b<
g;b++){for(var m=this.molecules[b],p=0,l=m.atoms.length;p<l;p++){var r=m.atoms[p],y=e.distance(r),x=e.angle(r)+c;r.x=e.x+y*v.cos(x);r.y=e.y-y*v.sin(x)}m.check()}this.lastGestureRotate=d.originalEvent.rotation}this.repaint()};n.gestureend=function(d){this.lastPinchScale=1;this.lastGestureRotate=0}})(ChemDoodle,ChemDoodle.monitor,ChemDoodle.structures,Math,ChemDoodle.lib.mat4);(function(n,E){n.ViewerCanvas=function(w,v,k){w&&this.create(w,v,k)};n.ViewerCanvas.prototype=new n._Canvas})(ChemDoodle);
(function(n,E,w){n._SpectrumCanvas=function(v,k,q){v&&this.create(v,k,q)};n=n._SpectrumCanvas.prototype=new n._Canvas;n.spectrum=w;n.emptyMessage="No Spectrum Loaded or Recognized";n.loadMolecule=w;n.getMolecule=w;n.innerRepaint=function(v){this.spectrum&&0<this.spectrum.data.length?this.spectrum.draw(v,this.styles,this.width,this.height):this.emptyMessage&&(v.fillStyle="#737683",v.textAlign="center",v.textBaseline="middle",v.font="18px Helvetica, Verdana, Arial, Sans-serif",v.fillText(this.emptyMessage,
this.width/2,this.height/2))};n.loadSpectrum=function(v){this.spectrum=v;this.repaint()};n.getSpectrum=function(){return this.spectrum};n.getSpectrumCoordinates=function(v,k){return spectrum.getInternalCoordinates(v,k,this.width,this.height)}})(ChemDoodle,document);(function(n,E){n.ObserverCanvas=function(w,v,k){w&&this.create(w,v,k)};n.ObserverCanvas.prototype=new n._SpectrumCanvas})(ChemDoodle);
(function(n,E){n.OverlayCanvas=function(w,v,k){w&&this.create(w,v,k)};n=n.OverlayCanvas.prototype=new n._SpectrumCanvas;n.overlaySpectra=[];n.superRepaint=n.innerRepaint;n.innerRepaint=function(w){this.superRepaint(w);if(this.spectrum&&0<this.spectrum.data.length)for(var v=0,k=this.overlaySpectra.length;v<k;v++){var q=this.overlaySpectra[v];q&&0<q.data.length&&(q.minX=this.spectrum.minX,q.maxX=this.spectrum.maxX,q.drawPlot(w,this.styles,this.width,this.height,this.spectrum.memory.offsetTop,this.spectrum.memory.offsetLeft,
this.spectrum.memory.offsetBottom))}};n.addSpectrum=function(w){this.spectrum?this.overlaySpectra.push(w):this.spectrum=w}})(ChemDoodle);
(function(n,E,w,v){n.PerspectiveCanvas=function(q,d,c){q&&this.create(q,d,c)};var k=n.PerspectiveCanvas.prototype=new n._SpectrumCanvas;k.dragRange=v;k.rescaleYAxisOnZoom=!0;k.lastPinchScale=1;k.mousedown=function(q){this.dragRange=new n.structures.Point(q.p.x,q.p.x)};k.mouseup=function(q){this.dragRange&&this.dragRange.x!==this.dragRange.y&&(this.dragRange.multi||(q=this.spectrum.zoom(this.dragRange.x,q.p.x,this.width,this.rescaleYAxisOnZoom),this.rescaleYAxisOnZoom&&(this.styles.scale=q)),this.dragRange=
v,this.repaint())};k.drag=function(q){this.dragRange&&(this.dragRange.multi?this.dragRange=v:(E.SHIFT&&(this.spectrum.translate(q.p.x-this.dragRange.x,this.width),this.dragRange.x=q.p.x),this.dragRange.y=q.p.x),this.repaint())};k.drawChildExtras=function(q){if(this.dragRange){var d=w.min(this.dragRange.x,this.dragRange.y),c=w.max(this.dragRange.x,this.dragRange.y);q.strokeStyle="gray";q.lineStyle=1;q.beginPath();for(q.moveTo(d,this.height/2);d<=c;d++)5>d%10?q.lineTo(d,w.round(this.height/2)):q.moveTo(d,
w.round(this.height/2));q.stroke()}};k.mousewheel=function(q,d){this.styles.scale-=d/10;.01>this.styles.scale&&(this.styles.scale=.01);this.repaint()};k.dblclick=function(q){this.spectrum.setup();this.styles.scale=1;this.repaint()};k.multitouchmove=function(q,d){2===d&&(this.dragRange&&this.dragRange.multi?(this.spectrum.translate(q.p.x-this.dragRange.x,this.width),this.dragRange.x=q.p.x,this.dragRange.y=q.p.x,this.repaint()):(this.dragRange=new n.structures.Point(q.p.x,q.p.x),this.dragRange.multi=
!0))};k.gesturechange=function(q){this.styles.scale*=q.originalEvent.scale/this.lastPinchScale;.01>this.styles.scale&&(this.styles.scale=.01);this.lastPinchScale=q.originalEvent.scale;this.repaint()};k.gestureend=function(q){this.lastPinchScale=1}})(ChemDoodle,ChemDoodle.monitor,Math);
(function(n,E,w,v){n.SeekerCanvas=function(q,d,c,e){q&&this.create(q,d,c);this.seekType=e};var k=n.SeekerCanvas.prototype=new n._SpectrumCanvas;k.superRepaint=k.innerRepaint;k.innerRepaint=function(q){this.superRepaint(q);if(this.spectrum&&0<this.spectrum.data.length&&this.p){if(this.seekType===n.SeekerCanvas.SEEK_POINTER){var d=this.p;var c=this.spectrum.getInternalCoordinates(d.x,d.y)}else if(this.seekType===n.SeekerCanvas.SEEK_PLOT||this.seekType===n.SeekerCanvas.SEEK_PEAK){c=this.seekType===n.SeekerCanvas.SEEK_PLOT?
this.spectrum.getClosestPlotInternalCoordinates(this.p.x):this.spectrum.getClosestPeakInternalCoordinates(this.p.x);if(!c)return;d={x:this.spectrum.getTransformedX(c.x,this.styles,this.width,this.spectrum.memory.offsetLeft),y:this.spectrum.getTransformedY(c.y/100,this.styles,this.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)}}q.fillStyle="white";q.strokeStyle=this.styles.plots_color;q.lineWidth=this.styles.plots_width;q.beginPath();q.arc(d.x,d.y,3,0,2*w.PI,!1);q.fill();
q.stroke();q.font=E.getFontString(this.styles.text_font_size,this.styles.text_font_families);q.textAlign="left";q.textBaseline="bottom";c="x:"+c.x.toFixed(3)+", y:"+c.y.toFixed(3);var e=d.x+3,b=q.measureText(c).width;e+b>this.width-2&&(e-=6+b);d=d.y;0>d-this.styles.text_font_size-2&&(d+=this.styles.text_font_size);q.fillRect(e,d-this.styles.text_font_size,b,this.styles.text_font_size);q.fillStyle="black";q.fillText(c,e,d)}};k.mouseout=function(q){this.p=v;this.repaint()};k.mousemove=function(q){this.p=
{x:q.p.x-2,y:q.p.y-3};this.repaint()};k.touchstart=function(q){this.mousemove(q)};k.touchmove=function(q){this.mousemove(q)};k.touchend=function(q){this.mouseout(q)};n.SeekerCanvas.SEEK_POINTER="pointer";n.SeekerCanvas.SEEK_PLOT="plot";n.SeekerCanvas.SEEK_PEAK="peak"})(ChemDoodle,ChemDoodle.extensions,Math);
(function(n,E,w,v,k,q,d,c,e,b,g,m,p,l){n._Canvas3D=function(y,x,A){y&&this.create(y,x,A)};b=n._Canvas3D.prototype=new n._Canvas;var r=n._Canvas.prototype;b.rotationMatrix=l;b.lastPoint=l;b.emptyMessage="WebGL is Unavailable!";b.lastPinchScale=1;b.lastGestureRotate=0;b.afterLoadContent=function(){for(var y=new w.Bounds,x=0,A=this.molecules.length;x<A;x++)y.expand(this.molecules[x].getBounds3D());A=g.dist([y.maxX,y.maxY,y.maxZ],[y.minX,y.minY,y.minZ])/2+1.5;Infinity===A&&(A=10);this.maxDimension=d.max(y.maxX-
y.minX,y.maxY-y.minY);y=d.min(179.9,d.max(this.styles.projectionPerspectiveVerticalFieldOfView_3D,.1));x=y/360*d.PI;var H=d.tan(x)/.8;H=A/H;var a=this.width/this.height;this.camera.fieldOfView=y;this.camera.near=H-A;this.camera.far=H+A;this.camera.aspect=a;e.translate(e.identity(this.camera.viewMatrix),[0,0,-H]);x=A/d.tan(x);this.lighting.camera.fieldOfView=y;this.lighting.camera.near=x-A;this.lighting.camera.far=x+A;this.lighting.updateView();this.setupScene()};b.renderDepthMap=function(){if(this.styles.shadow_3D&&
k.DepthShader){var y=this.gl.isEnabled(this.gl.CULL_FACE);y||this.gl.enable(this.gl.CULL_FACE);this.depthShader.useShaderProgram(this.gl);var x=this.gl.getParameter(this.gl.COLOR_CLEAR_VALUE);this.gl.clearColor(1,1,1,0);this.lightDepthMapFramebuffer.bind(this.gl,this.shadowTextureSize,this.shadowTextureSize);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.depthShader.setProjectionMatrix(this.gl,this.lighting.camera.projectionMatrix);this.depthShader.enableAttribsArray(this.gl);
for(var A=0,H=this.molecules.length;A<H;A++)this.molecules[A].render(this.gl,this.styles);this.gl.flush();this.depthShader.disableAttribsArray(this.gl);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);this.gl.clearColor(x[0],x[1],x[2],x[3]);y||this.gl.disable(this.gl.CULL_FACE)}};b.renderExtras=function(){this.phongShader.useShaderProgram(this.gl);this.phongShader.enableAttribsArray(this.gl);for(var y=[],x=0,A=this.shapes.length;x<A;x++){var H=this.shapes[x];H instanceof k._Surface&&(!H.styles&&
1!==this.styles.surfaces_alpha||H.styles&&1!==H.styles.surfaces_alpha)?y.push(H):H.render(this.gl,this.styles)}if(0!==y.length){this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.enable(this.gl.BLEND);this.gl.depthMask(!1);x=0;for(A=y.length;x<A;x++)y[x].render(this.gl,this.styles);this.gl.depthMask(!0);this.gl.disable(this.gl.BLEND);this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)}this.phongShader.setShadow(this.gl,
!1);this.phongShader.setFogMode(this.gl,0);this.phongShader.setFlatColor(this.gl,!1);this.styles.compass_display&&(this.phongShader.setLightDirection(this.gl,[0,0,-1]),this.compass.render(this.gl,this.styles));this.phongShader.disableAttribsArray(this.gl);this.gl.flush();this.gl.enable(this.gl.BLEND);this.gl.depthMask(!1);this.labelShader.useShaderProgram(this.gl);this.labelShader.setMatrixUniforms(this.gl,this.gl.modelViewMatrix);this.labelShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);
this.labelShader.setDimension(this.gl,this.gl.canvas.clientWidth,this.gl.canvas.clientHeight);this.labelShader.enableAttribsArray(this.gl);this.styles.atoms_displayLabels_3D&&this.label3D.render(this.gl,this.styles,this.getMolecules());if(this.styles.measurement_displayText_3D)for(y=0,x=this.shapes.length;y<x;y++)A=this.shapes[y],A.renderText&&A.renderText(this.gl,this.styles);this.styles.compass_display&&this.styles.compass_displayText_3D&&this.compass.renderAxis(this.gl);this.labelShader.disableAttribsArray(this.gl);
this.gl.disable(this.gl.BLEND);this.gl.depthMask(!0);this.gl.flush();this.drawChildExtras&&this.drawChildExtras(this.gl);this.gl.flush()};b.renderColor=function(){this.phongShader.useShaderProgram(this.gl);this.gl.uniform1i(this.phongShader.shadowDepthSampleUniform,0);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.bindTexture(this.gl.TEXTURE_2D,this.lightDepthMapTexture.texture);this.phongShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);this.phongShader.setShadow(this.gl,this.styles.shadow_3D);
this.phongShader.setFlatColor(this.gl,this.styles.flat_color_3D);this.phongShader.setGammaCorrection(this.gl,this.styles.gammaCorrection_3D);this.phongShader.setShadowTextureSize(this.gl,this.shadowTextureSize,this.shadowTextureSize);this.phongShader.setShadowIntensity(this.gl,this.styles.shadow_intensity_3D);this.phongShader.setFogMode(this.gl,this.styles.fog_mode_3D);this.phongShader.setFogColor(this.gl,this.fogging.colorRGB);this.phongShader.setFogStart(this.gl,this.fogging.fogStart);this.phongShader.setFogEnd(this.gl,
this.fogging.fogEnd);this.phongShader.setFogDensity(this.gl,this.fogging.density);this.phongShader.setLightProjectionMatrix(this.gl,this.lighting.camera.projectionMatrix);this.phongShader.setLightDiffuseColor(this.gl,this.lighting.diffuseRGB);this.phongShader.setLightSpecularColor(this.gl,this.lighting.specularRGB);this.phongShader.setLightDirection(this.gl,this.lighting.direction);this.phongShader.enableAttribsArray(this.gl);for(var y=0,x=this.molecules.length;y<x;y++)this.molecules[y].render(this.gl,
this.styles);this.phongShader.disableAttribsArray(this.gl);this.gl.flush()};b.renderPosition=function(){this.positionShader.useShaderProgram(this.gl);this.positionShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);this.positionShader.enableAttribsArray(this.gl);for(var y=0,x=this.molecules.length;y<x;y++)this.molecules[y].render(this.gl,this.styles);this.positionShader.disableAttribsArray(this.gl);this.gl.flush()};b.renderNormal=function(){this.normalShader.useShaderProgram(this.gl);
this.normalShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);this.normalShader.enableAttribsArray(this.gl);for(var y=0,x=this.molecules.length;y<x;y++)this.molecules[y].render(this.gl,this.styles);this.normalShader.disableAttribsArray(this.gl);this.gl.flush()};b.renderSSAO=function(){this.ssaoShader.useShaderProgram(this.gl);this.ssaoShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);this.ssaoShader.setSampleKernel(this.gl,this.ssao.sampleKernel);this.ssaoShader.setKernelRadius(this.gl,
this.styles.ssao_kernel_radius);this.ssaoShader.setPower(this.gl,this.styles.ssao_power);this.ssaoShader.setGbufferTextureSize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.uniform1i(this.ssaoShader.positionSampleUniform,0);this.gl.uniform1i(this.ssaoShader.normalSampleUniform,1);this.gl.uniform1i(this.ssaoShader.noiseSampleUniform,2);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.bindTexture(this.gl.TEXTURE_2D,this.positionTexture.texture);this.gl.activeTexture(this.gl.TEXTURE1);
this.gl.bindTexture(this.gl.TEXTURE_2D,this.normalTexture.texture);this.gl.activeTexture(this.gl.TEXTURE2);this.gl.bindTexture(this.gl.TEXTURE_2D,this.ssao.noiseTexture);this.gl.activeTexture(this.gl.TEXTURE0);this.ssaoShader.enableAttribsArray(this.gl);this.gl.quadBuffer.bindBuffers(this.gl);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems);this.ssaoShader.disableAttribsArray(this.gl);this.gl.flush();this.ssaoFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,
this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT);this.ssaoBlurShader.useShaderProgram(this.gl);this.ssaoBlurShader.setGbufferTextureSize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.uniform1i(this.ssaoBlurShader.aoSampleUniform,0);this.gl.uniform1i(this.ssaoBlurShader.depthSampleUniform,1);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.bindTexture(this.gl.TEXTURE_2D,this.imageTexture.texture);this.gl.activeTexture(this.gl.TEXTURE1);this.gl.bindTexture(this.gl.TEXTURE_2D,
this.depthTexture.texture);this.gl.activeTexture(this.gl.TEXTURE0);this.ssaoBlurShader.enableAttribsArray(this.gl);this.gl.quadBuffer.bindBuffers(this.gl);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems);this.ssaoBlurShader.disableAttribsArray(this.gl);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.flush()};b.renderOutline=function(){this.outlineShader.useShaderProgram(this.gl);this.outlineShader.setGbufferTextureSize(this.gl,this.gl.drawingBufferWidth,
this.gl.drawingBufferHeight);this.outlineShader.setNormalThreshold(this.gl,this.styles.outline_normal_threshold);this.outlineShader.setDepthThreshold(this.gl,this.styles.outline_depth_threshold);this.outlineShader.setThickness(this.gl,this.styles.outline_thickness);this.gl.uniform1i(this.outlineShader.normalSampleUniform,0);this.gl.uniform1i(this.outlineShader.depthSampleUniform,1);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.bindTexture(this.gl.TEXTURE_2D,this.normalTexture.texture);this.gl.activeTexture(this.gl.TEXTURE1);
this.gl.bindTexture(this.gl.TEXTURE_2D,this.depthTexture.texture);this.gl.activeTexture(this.gl.TEXTURE0);this.outlineShader.enableAttribsArray(this.gl);this.gl.quadBuffer.bindBuffers(this.gl);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems);this.outlineShader.disableAttribsArray(this.gl);this.gl.flush()};b.deferredRender=function(){var y=this.gl.getParameter(this.gl.COLOR_CLEAR_VALUE);this.gl.clearColor(0,0,0,0);this.colorFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,
this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.renderColor();this.positionFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.renderPosition();this.normalFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.renderNormal();this.styles.ssao_3D&&k.SSAOShader?
(this.quadFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.renderSSAO()):(this.ssaoFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT));this.outlineFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.clearColor(1,1,1,1);this.gl.clear(this.gl.COLOR_BUFFER_BIT);this.styles.outline_3D&&this.renderOutline();
this.gl.clearColor(y[0],y[1],y[2],y[3]);this.quadFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT);this.lightingShader.useShaderProgram(this.gl);this.gl.uniform1i(this.lightingShader.positionSampleUniform,0);this.gl.uniform1i(this.lightingShader.colorSampleUniform,1);this.gl.uniform1i(this.lightingShader.ssaoSampleUniform,2);this.gl.uniform1i(this.lightingShader.outlineSampleUniform,3);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.bindTexture(this.gl.TEXTURE_2D,
this.positionTexture.texture);this.gl.activeTexture(this.gl.TEXTURE1);this.gl.bindTexture(this.gl.TEXTURE_2D,this.colorTexture.texture);this.gl.activeTexture(this.gl.TEXTURE2);this.gl.bindTexture(this.gl.TEXTURE_2D,this.ssaoTexture.texture);this.gl.activeTexture(this.gl.TEXTURE3);this.gl.bindTexture(this.gl.TEXTURE_2D,this.outlineTexture.texture);this.gl.activeTexture(this.gl.TEXTURE0);this.lightingShader.enableAttribsArray(this.gl);this.gl.quadBuffer.bindBuffers(this.gl);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,
0,this.gl.quadBuffer.vertexPositionBuffer.numItems);this.lightingShader.disableAttribsArray(this.gl);this.gl.flush();this.fxaaFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.bindTexture(this.gl.TEXTURE_2D,this.imageTexture.texture);this.fxaaShader.useShaderProgram(this.gl);this.fxaaShader.setBuffersize(this.gl,this.gl.drawingBufferWidth,
this.gl.drawingBufferHeight);this.fxaaShader.setAntialias(this.gl,this.styles.antialias_3D);this.fxaaShader.setEdgeThreshold(this.gl,this.styles.fxaa_edgeThreshold);this.fxaaShader.setEdgeThresholdMin(this.gl,this.styles.fxaa_edgeThresholdMin);this.fxaaShader.setSearchSteps(this.gl,this.styles.fxaa_searchSteps);this.fxaaShader.setSearchThreshold(this.gl,this.styles.fxaa_searchThreshold);this.fxaaShader.setSubpixCap(this.gl,this.styles.fxaa_subpixCap);this.fxaaShader.setSubpixTrim(this.gl,this.styles.fxaa_subpixTrim);
this.fxaaShader.enableAttribsArray(this.gl);this.gl.quadBuffer.bindBuffers(this.gl);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems);this.fxaaShader.disableAttribsArray(this.gl);this.gl.flush();this.finalFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.renderExtras();this.gl.clearColor(y[0],y[1],y[2],y[3]);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);
this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.bindTexture(this.gl.TEXTURE_2D,this.fxaaTexture.texture);this.quadShader.useShaderProgram(this.gl);this.quadShader.enableAttribsArray(this.gl);this.gl.quadBuffer.bindBuffers(this.gl);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems);this.quadShader.disableAttribsArray(this.gl);this.gl.flush()};b.forwardRender=function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);
this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.renderColor();this.renderExtras()};b.repaint=function(){this.gl&&(this.gl.lightViewMatrix=e.multiply(this.lighting.camera.viewMatrix,this.rotationMatrix,[]),this.gl.rotationMatrix=this.rotationMatrix,this.gl.modelViewMatrix=this.gl.lightViewMatrix,this.renderDepthMap(),this.gl.modelViewMatrix=e.multiply(this.camera.viewMatrix,this.rotationMatrix,[]),this.isSupportDeferred()&&
(this.styles.ssao_3D||this.styles.outline_3D)?this.deferredRender():this.forwardRender())};b.pick=function(y,x,A,H){if(this.gl){var a=this.height-x;1!==this.pixelRatio&&(y*=this.pixelRatio,a*=this.pixelRatio);e.multiply(this.camera.viewMatrix,this.rotationMatrix,this.gl.modelViewMatrix);this.gl.rotationMatrix=this.rotationMatrix;this.pickShader.useShaderProgram(this.gl);x=this.gl.getParameter(this.gl.COLOR_CLEAR_VALUE);this.gl.clearColor(1,1,1,0);this.pickerFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,
this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.pickShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);this.pickShader.enableAttribsArray(this.gl);for(var f=[],t=0,C=this.molecules.length;t<C;t++)this.molecules[t].renderPickFrame(this.gl,this.styles,f,A,H);this.pickShader.disableAttribsArray(this.gl);this.gl.flush();A=new Uint8Array(4);this.gl.readPixels(y-2,a+2,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,A);H=l;0<A[3]&&(H=f[A[2]|A[1]<<8|
A[0]<<16]);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);this.gl.clearColor(x[0],x[1],x[2],x[3]);return H}return l};b.center=function(){for(var y=new v.Atom,x=0,A=this.molecules.length;x<A;x++)y.add3D(this.molecules[x].getCenter3D());y.x/=this.molecules.length;y.y/=this.molecules.length;x=0;for(A=this.molecules.length;x<A;x++){for(var H=this.molecules[x],a=0,f=H.atoms.length;a<f;a++)H.atoms[a].sub3D(y);if(H.chains&&H.fromJSON)for(a=0,f=H.chains.length;a<f;a++)for(var t=H.chains[a],C=0,F=t.length;C<
F;C++){var I=t[C];I.cp1.sub3D(y);I.cp2.sub3D(y);I.cp3&&(I.cp3.sub3D(y),I.cp4.sub3D(y),I.cp5.sub3D(y))}}};b.isSupportDeferred=function(){return this.gl.textureFloatExt&&this.gl.depthTextureExt};b.create=function(y,x,A){r.create.call(this,y,x,A);try{var H=c.getElementById(this.id);this.gl=H.getContext("webgl");this.gl||(this.gl=H.getContext("experimental-webgl"))}catch(a){}this.gl?(1!==this.pixelRatio&&this.gl.canvas.width===this.width&&(this.gl.canvas.style.width=this.width+"px",this.gl.canvas.style.height=
this.height+"px",this.gl.canvas.width=this.width*this.pixelRatio,this.gl.canvas.height=this.height*this.pixelRatio),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.clearDepth(1),this.shadowTextureSize=1024,this.rotationMatrix=e.identity([]),this.camera=new k.Camera,this.label3D=new k.Label,this.lighting=new k.Light(this.styles.lightDiffuseColor_3D,this.styles.lightSpecularColor_3D,
this.styles.lightDirection_3D),this.fogging=new k.Fog(this.styles.fog_color_3D||this.styles.backgroundColor,this.styles.fog_start_3D,this.styles.fog_end_3D,this.styles.fog_density_3D),this.gl.depthTextureExt=this.gl.getExtension("WEBGL_depth_texture")||this.gl.getExtension("WEBKIT_WEBGL_depth_texture")||this.gl.getExtension("MOZ_WEBGL_depth_texture"),this.gl.textureFloatExt=this.gl.getExtension("OES_texture_float")||this.gl.getExtension("WEBKIT_OES_texture_float")||this.gl.getExtension("MOZ_OES_texture_float"),
this.ssao=new k.SSAO,this.pickerColorTexture=new k.Texture,this.pickerColorTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA,this.gl.RGBA),this.pickerDepthRenderbuffer=new k.Renderbuffer,this.pickerDepthRenderbuffer.init(this.gl,this.gl.DEPTH_COMPONENT16),this.pickerFramebuffer=new k.Framebuffer,this.pickerFramebuffer.init(this.gl),this.pickerFramebuffer.setColorTexture(this.gl,this.pickerColorTexture.texture),this.pickerFramebuffer.setDepthRenderbuffer(this.gl,this.pickerDepthRenderbuffer.renderbuffer),
this.lightDepthMapTexture=new k.Texture,this.lightDepthMapRenderbuffer=new k.Renderbuffer,this.lightDepthMapFramebuffer=new k.Framebuffer,this.lightDepthMapFramebuffer.init(this.gl),this.gl.depthTextureExt?(this.lightDepthMapTexture.init(this.gl,this.gl.UNSIGNED_SHORT,this.gl.DEPTH_COMPONENT),this.lightDepthMapRenderbuffer.init(this.gl,this.gl.RGBA4),this.lightDepthMapFramebuffer.setColorRenderbuffer(this.gl,this.lightDepthMapRenderbuffer.renderbuffer),this.lightDepthMapFramebuffer.setDepthTexture(this.gl,
this.lightDepthMapTexture.texture)):(this.lightDepthMapTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA,this.gl.RGBA),this.lightDepthMapRenderbuffer.init(this.gl,this.gl.DEPTH_COMPONENT16),this.lightDepthMapFramebuffer.setColorTexture(this.gl,this.lightDepthMapTexture.texture),this.lightDepthMapFramebuffer.setDepthRenderbuffer(this.gl,this.lightDepthMapRenderbuffer.renderbuffer)),this.isSupportDeferred()&&(this.depthTexture=new k.Texture,this.depthTexture.init(this.gl,this.gl.UNSIGNED_SHORT,
this.gl.DEPTH_COMPONENT),this.colorTexture=new k.Texture,this.colorTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA),this.positionTexture=new k.Texture,this.positionTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.normalTexture=new k.Texture,this.normalTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.ssaoTexture=new k.Texture,this.ssaoTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.outlineTexture=new k.Texture,this.outlineTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA),
this.fxaaTexture=new k.Texture,this.fxaaTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.imageTexture=new k.Texture,this.imageTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.colorFramebuffer=new k.Framebuffer,this.colorFramebuffer.init(this.gl),this.colorFramebuffer.setColorTexture(this.gl,this.colorTexture.texture),this.colorFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.normalFramebuffer=new k.Framebuffer,this.normalFramebuffer.init(this.gl),this.normalFramebuffer.setColorTexture(this.gl,
this.normalTexture.texture),this.normalFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.positionFramebuffer=new k.Framebuffer,this.positionFramebuffer.init(this.gl),this.positionFramebuffer.setColorTexture(this.gl,this.positionTexture.texture),this.positionFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.ssaoFramebuffer=new k.Framebuffer,this.ssaoFramebuffer.init(this.gl),this.ssaoFramebuffer.setColorTexture(this.gl,this.ssaoTexture.texture),this.outlineFramebuffer=
new k.Framebuffer,this.outlineFramebuffer.init(this.gl),this.outlineFramebuffer.setColorTexture(this.gl,this.outlineTexture.texture),this.fxaaFramebuffer=new k.Framebuffer,this.fxaaFramebuffer.init(this.gl),this.fxaaFramebuffer.setColorTexture(this.gl,this.fxaaTexture.texture),this.quadFramebuffer=new k.Framebuffer,this.quadFramebuffer.init(this.gl),this.quadFramebuffer.setColorTexture(this.gl,this.imageTexture.texture),this.finalFramebuffer=new k.Framebuffer,this.finalFramebuffer.init(this.gl),this.finalFramebuffer.setColorTexture(this.gl,
this.fxaaTexture.texture),this.finalFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.normalShader=new k.NormalShader,this.normalShader.init(this.gl),this.positionShader=new k.PositionShader,this.positionShader.init(this.gl),k.SSAOShader&&(this.ssaoShader=new k.SSAOShader,this.ssaoShader.init(this.gl),this.ssaoBlurShader=new k.SSAOBlurShader,this.ssaoBlurShader.init(this.gl)),this.outlineShader=new k.OutlineShader,this.outlineShader.init(this.gl),this.lightingShader=new k.LightingShader,
this.lightingShader.init(this.gl),this.fxaaShader=new k.FXAAShader,this.fxaaShader.init(this.gl),this.quadShader=new k.QuadShader,this.quadShader.init(this.gl)),this.labelShader=new k.LabelShader,this.labelShader.init(this.gl),this.pickShader=new k.PickShader,this.pickShader.init(this.gl),this.phongShader=new k.PhongShader,this.phongShader.init(this.gl),k.DepthShader&&(this.depthShader=new k.DepthShader,this.depthShader.init(this.gl)),this.textTextImage=new k.TextImage,this.textTextImage.init(this.gl),
this.gl.textImage=new k.TextImage,this.gl.textImage.init(this.gl),this.gl.textMesh=new k.TextMesh,this.gl.textMesh.init(this.gl),this.gl.material=new k.Material,this.setupScene()):this.displayMessage()};b.displayMessage=function(){var y=c.getElementById(this.id);y.getContext&&(y=y.getContext("2d"),this.styles.backgroundColor&&(y.fillStyle=this.styles.backgroundColor,y.fillRect(0,0,this.width,this.height)),this.emptyMessage&&(y.fillStyle="#737683",y.textAlign="center",y.textBaseline="middle",y.font=
"18px Helvetica, Verdana, Arial, Sans-serif",y.fillText(this.emptyMessage,this.width/2,this.height/2)))};b.renderText=function(y,x){var A={position:[],texCoord:[],translation:[]};this.textTextImage.pushVertexData(y,x,0,A);this.gl.textMesh.storeData(this.gl,A.position,A.texCoord,A.translation);this.textTextImage.useTexture(this.gl);this.gl.textMesh.render(this.gl)};b.setupScene=function(){if(this.gl){var y=m("#"+this.id),x=this.styles.backgroundColor?this.styles.backgroundColor:"transparent";y.css("background-color",
x);y="transparent"===x?[0,0,0,0]:w.getRGB(x,1);this.gl.clearColor(y[0],y[1],y[2],4==y.length?y[3]:1);this.styles.cullBackFace_3D?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE);this.gl.sphereBuffer=new k.Sphere(1,this.styles.atoms_resolution_3D,this.styles.atoms_resolution_3D);this.gl.starBuffer=new k.Star;this.gl.cylinderBuffer=new k.Cylinder(1,1,this.styles.bonds_resolution_3D);this.gl.cylinderClosedBuffer=new k.Cylinder(1,1,this.styles.bonds_resolution_3D,!0);this.gl.boxBuffer=
new k.Box(1,1,1);this.gl.pillBuffer=new k.Pill(this.styles.bonds_pillDiameter_3D/2,this.styles.bonds_pillHeight_3D,this.styles.bonds_pillLatitudeResolution_3D,this.styles.bonds_pillLongitudeResolution_3D);this.gl.lineBuffer=new k.Line;this.gl.lineArrowBuffer=new k.LineArrow;this.gl.arrowBuffer=new k.Arrow(.3,this.styles.compass_resolution_3D);this.gl.quadBuffer=new k.Quad;this.gl.textImage.updateFont(this.gl,this.styles.text_font_size,this.styles.text_font_families,this.styles.text_font_bold,this.styles.text_font_italic,
this.styles.text_font_stroke_3D);this.lighting.lightScene(this.styles.lightDiffuseColor_3D,this.styles.lightSpecularColor_3D,this.styles.lightDirection_3D);this.fogging.fogScene(this.styles.fog_color_3D||this.styles.backgroundColor,this.styles.fog_start_3D,this.styles.fog_end_3D,this.styles.fog_density_3D);this.compass=new k.Compass(this.gl,this.styles);this.lightDepthMapTexture.setParameter(this.gl,this.shadowTextureSize,this.shadowTextureSize);this.lightDepthMapRenderbuffer.setParameter(this.gl,
this.shadowTextureSize,this.shadowTextureSize);this.pickerColorTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.pickerDepthRenderbuffer.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.isSupportDeferred()&&(this.depthTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.colorTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.imageTexture.setParameter(this.gl,
this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.positionTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.normalTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.ssaoTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.outlineTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.fxaaTexture.setParameter(this.gl,this.gl.drawingBufferWidth,
this.gl.drawingBufferHeight),this.ssao.initSampleKernel(this.styles.ssao_kernel_samples),this.ssao.initNoiseTexture(this.gl));this.camera.updateProjectionMatrix(this.styles.projectionPerspective_3D);y=0;for(x=this.molecules.length;y<x;y++){var A=this.molecules[y];A.labelMesh instanceof k.TextMesh||(A.labelMesh=new k.TextMesh,A.labelMesh.init(this.gl));if(A.chains){A.ribbons=[];A.cartoons=[];A.tubes=[];A.pipePlanks=[];for(var H=0,a=A.chains.length;H<a;H++){for(var f=A.chains[H],t=0,C=f.length-1;t<
C;t++)f[t].Test=t;t=3<f.length&&q[f[3].name]&&"#BEA06E"===q[f[3].name].aminoColor;if(0<f.length&&!f[0].lineSegments){C=0;for(var F=f.length-1;C<F;C++)f[C].setup(f[C+1].cp1,t?1:this.styles.proteins_horizontalResolution);if(!t)for(C=1,F=f.length-1;C<F;C++)E.vec3AngleFrom(f[C-1].D,f[C].D)>d.PI/2&&(f[C].guidePointsSmall.reverse(),f[C].guidePointsLarge.reverse(),g.scale(f[C].D,-1));C=2;for(F=f.length-3;C<F;C++)f[C].computeLineSegments(f[C-2],f[C-1],f[C+1],!t,t?this.styles.nucleics_verticalResolution:this.styles.proteins_verticalResolution);
f.pop();f.pop();f.pop();f.shift();f.shift()}C=w.hsl2rgb(1===a?.5:H/a,1,.5);C="rgb("+C[0]+","+C[1]+","+C[2]+")";f.chainColor=C;t?(f=new k.Tube(f,this.styles.nucleics_tubeThickness,this.styles.nucleics_tubeResolution_3D),f.chainColor=C,A.tubes.push(f)):(t=new k.PipePlank(f,this.styles),A.pipePlanks.push(t),t=f.shift(),F={front:new k.Ribbon(f,this.styles.proteins_ribbonThickness,!1),back:new k.Ribbon(f,-this.styles.proteins_ribbonThickness,!1)},F.front.chainColor=C,F.back.chainColor=C,A.ribbons.push(F),
F={front:new k.Ribbon(f,this.styles.proteins_ribbonThickness,!0),back:new k.Ribbon(f,-this.styles.proteins_ribbonThickness,!0)},F.front.chainColor=C,F.back.chainColor=C,A.cartoons.push(F),f.unshift(t))}}}this.label3D.updateVerticesBuffer(this.gl,this.getMolecules(),this.styles);if(this instanceof n.MovieCanvas3D&&this.frames)for(y=0,x=this.frames.length;y<x;y++){A=this.frames[y];H=0;for(a=A.mols.length;H<a;H++)f=A.mols[H],f.labelMesh instanceof v.d3.TextMesh||(f.labelMesh=new v.d3.TextMesh,f.labelMesh.init(this.gl));
this.label3D.updateVerticesBuffer(this.gl,A.mols,this.styles)}}};b.updateScene=function(){this.camera.updateProjectionMatrix(this.styles.projectionPerspective_3D);this.lighting.lightScene(this.styles.lightDiffuseColor_3D,this.styles.lightSpecularColor_3D,this.styles.lightDirection_3D);this.fogging.fogScene(this.styles.fog_color_3D||this.styles.backgroundColor,this.styles.fog_start_3D,this.styles.fog_end_3D,this.styles.fog_density_3D);this.repaint()};b.mousedown=function(y){this.lastPoint=y.p};b.mouseup=
function(y){this.lastPoint=l};b.rightmousedown=function(y){this.lastPoint=y.p};b.drag=function(y){if(this.lastPoint){if(n.monitor.ALT){var x=new v.Point(y.p.x,y.p.y);x.sub(this.lastPoint);var A=d.tan(this.camera.fieldOfView/360*d.PI);A=this.height/2/this.camera.zoom/A;A=this.camera.focalLength()/A;e.translate(this.camera.viewMatrix,[x.x*A,-x.y*A,0])}else A=y.p.x-this.lastPoint.x,x=y.p.y-this.lastPoint.y,A=e.rotate(e.identity([]),A*d.PI/180,[0,1,0]),e.rotate(A,x*d.PI/180,[1,0,0]),this.rotationMatrix=
e.multiply(A,this.rotationMatrix);this.lastPoint=y.p;this.repaint()}};b.mousewheel=function(y,x){0<x?this.camera.zoomIn():this.camera.zoomOut();this.updateScene()};b.multitouchmove=function(y,x){if(2===x)if(this.lastPoint&&this.lastPoint.multi){x=new v.Point(y.p.x,y.p.y);x.sub(this.lastPoint);var A=d.tan(this.camera.fieldOfView/360*d.PI);A=this.height/2/this.camera.zoom/A;A=this.camera.focalLength()/A;e.translate(this.camera.viewMatrix,[x.x*A,-x.y*A,0]);this.lastPoint=y.p;this.repaint()}else this.lastPoint=
y.p,this.lastPoint.multi=!0};b.gesturechange=function(y){if(0!==y.originalEvent.scale-this.lastPinchScale){var x=30*-(y.originalEvent.scale/this.lastPinchScale-1);if(isNaN(x))return;0<x?this.camera.zoomOut():this.camera.zoomIn();this.updateScene();this.lastPinchScale=y.originalEvent.scale}this.repaint()};b.gestureend=function(y){this.lastPinchScale=1;this.lastGestureRotate=0}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.RESIDUE,Math,
document,ChemDoodle.lib.mat4,ChemDoodle.lib.mat3,ChemDoodle.lib.vec3,ChemDoodle.lib.jQuery,window);
(function(n,E,w,v,k){n.MolGrabberCanvas3D=function(q,d,c){q&&this.create(q,d,c);d=[];d.push('<br><input type="text" id="');d.push(q);d.push('_query" size="32" value="" />');d.push("<br><nobr>");d.push('<select id="');d.push(q);d.push('_select">');d.push('<option value="pubchem" selected>PubChem');d.push("</select>");d.push('<button type="button" id="');d.push(q);d.push('_submit">Show Molecule</button>');d.push("</nobr>");v.writeln(d.join(""));var e=this;w("#"+q+"_submit").click(function(){e.search()});
w("#"+q+"_query").keypress(function(b){13===b.which&&e.search()})};n=n.MolGrabberCanvas3D.prototype=new n._Canvas3D;n.setSearchTerm=function(q){w("#"+this.id+"_query").val(q);this.search()};n.search=function(){var q=this;E.getMoleculeFromDatabase(w("#"+this.id+"_query").val(),{database:w("#"+this.id+"_select").val(),dimension:3},function(d){q.loadMolecule(d)})}})(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery,document);
(function(n,E,w){n.MovieCanvas3D=function(v,k,q){v&&this.create(v,k,q);this.frames=[]};n.MovieCanvas3D.PLAY_ONCE=0;n.MovieCanvas3D.PLAY_LOOP=1;n.MovieCanvas3D.PLAY_SPRING=2;w=n.MovieCanvas3D.prototype=new n._Canvas3D;w.timeout=50;w.frameNumber=0;w.playMode=2;w.reverse=!1;w.startAnimation=n._AnimatorCanvas.prototype.startAnimation;w.stopAnimation=n._AnimatorCanvas.prototype.stopAnimation;w.isRunning=n._AnimatorCanvas.prototype.isRunning;w.dblclick=n.RotatorCanvas.prototype.dblclick;w.nextFrame=function(v){v=
this.frames[this.frameNumber];this.molecules=v.mols;this.shapes=v.shapes;2===this.playMode&&this.reverse?(this.frameNumber--,0>this.frameNumber&&(this.frameNumber=1,this.reverse=!1)):(this.frameNumber++,this.frameNumber>=this.frames.length&&(2===this.playMode?(this.frameNumber-=2,this.reverse=!0):(this.frameNumber=0,0===this.playMode&&this.stopAnimation())))};w.center=function(){for(var v=new E.Atom,k=this.frames[0],q=0,d=k.mols.length;q<d;q++)v.add3D(k.mols[q].getCenter3D());v.x/=k.mols.length;v.y/=
k.mols.length;k=new E.Atom;k.sub3D(v);v=0;for(q=this.frames.length;v<q;v++){d=this.frames[v];for(var c=0,e=d.mols.length;c<e;c++)for(var b=d.mols[c],g=0,m=b.atoms.length;g<m;g++)b.atoms[g].add3D(k)}};w.addFrame=function(v,k){this.frames.push({mols:v,shapes:k})}})(ChemDoodle,ChemDoodle.structures);
(function(n,E,w,v){var k=[],q=[1,0,0],d=[0,1,0],c=[0,0,1];n.RotatorCanvas3D=function(b,g,m){b&&this.create(b,g,m)};var e=n.RotatorCanvas3D.prototype=new n._Canvas3D;e.timeout=33;E=E.PI/15;e.xIncrement=E;e.yIncrement=E;e.zIncrement=E;e.startAnimation=n._AnimatorCanvas.prototype.startAnimation;e.stopAnimation=n._AnimatorCanvas.prototype.stopAnimation;e.isRunning=n._AnimatorCanvas.prototype.isRunning;e.dblclick=n.RotatorCanvas.prototype.dblclick;e.mousedown=v;e.rightmousedown=v;e.drag=v;e.mousewheel=
v;e.nextFrame=function(b){0===this.molecules.length&&0===this.shapes.length?this.stopAnimation():(w.identity(k),b/=1E3,w.rotate(k,this.xIncrement*b,q),w.rotate(k,this.yIncrement*b,d),w.rotate(k,this.zIncrement*b,c),w.multiply(this.rotationMatrix,k))}})(ChemDoodle,Math,ChemDoodle.lib.mat4);(function(n,E){n.TransformCanvas3D=function(w,v,k){w&&this.create(w,v,k)};n.TransformCanvas3D.prototype=new n._Canvas3D})(ChemDoodle);
(function(n,E){n.ViewerCanvas3D=function(w,v,k){w&&this.create(w,v,k)};n=n.ViewerCanvas3D.prototype=new n._Canvas3D;n.mousedown=E;n.rightmousedown=E;n.drag=E;n.mousewheel=E})(ChemDoodle);
(function(n,E,w,v,k){function q(d,c,e,b){this.element=d;this.x=c;this.y=e;this.dimension=b;this.allowMultipleSelections=!1}n.PeriodicTableCanvas=function(d,c){this.padding=5;d&&this.create(d,18*c+2*this.padding,10*c+2*this.padding);this.cellDimension=c?c:20;this.setupTable();this.repaint()};v=n.PeriodicTableCanvas.prototype=new n._Canvas;v.loadMolecule=k;v.getMolecule=k;v.getHoveredElement=function(){return this.hovered?this.hovered.element:k};v.innerRepaint=function(d){for(var c=0,e=this.cells.length;c<
e;c++)this.drawCell(d,this.styles,this.cells[c]);this.hovered&&this.drawCell(d,this.styles,this.hovered);this.selected&&this.drawCell(d,this.styles,this.selected)};v.setupTable=function(){this.cells=[];for(var d=this.padding,c=this.padding,e=0,b=0,g=n.SYMBOLS.length;b<g;b++){18===e&&(e=0,c+=this.cellDimension,d=this.padding);var m=n.ELEMENT[n.SYMBOLS[b]];if(2===m.atomicNumber)d+=16*this.cellDimension,e+=16;else if(5===m.atomicNumber||13===m.atomicNumber)d+=10*this.cellDimension,e+=10;(58>m.atomicNumber||
71<m.atomicNumber&&90>m.atomicNumber||103<m.atomicNumber)&&118>=m.atomicNumber&&(this.cells.push(new q(m,d,c,this.cellDimension)),d+=this.cellDimension,e++)}c+=2*this.cellDimension;d=3*this.cellDimension+this.padding;for(e=57;104>e;e++)if(b=n.ELEMENT[n.SYMBOLS[e]],90===b.atomicNumber&&(c+=this.cellDimension,d=3*this.cellDimension+this.padding),58<=b.atomicNumber&&71>=b.atomicNumber||90<=b.atomicNumber&&103>=b.atomicNumber)this.cells.push(new q(b,d,c,this.cellDimension)),d+=this.cellDimension};v.drawCell=
function(d,c,e){var b=d.createRadialGradient(e.x+e.dimension/3,e.y+e.dimension/3,1.5*e.dimension,e.x+e.dimension/3,e.y+e.dimension/3,e.dimension/10);b.addColorStop(0,"#000000");b.addColorStop(.7,e.element.jmolColor);b.addColorStop(1,"#FFFFFF");d.fillStyle=b;E.contextRoundRect(d,e.x,e.y,e.dimension,e.dimension,e.dimension/8);if(e===this.hovered||e===this.selected||e.selected)d.lineWidth=2,d.strokeStyle="#c10000",d.stroke(),d.fillStyle="white";d.fill();d.font=E.getFontString(c.text_font_size,c.text_font_families);
d.fillStyle=c.text_color;d.textAlign="center";d.textBaseline="middle";d.fillText(e.element.symbol,e.x+e.dimension/2,e.y+e.dimension/2)};v.click=function(d){this.hovered&&(this.allowMultipleSelections?this.hovered.selected=!this.hovered.selected:this.selected=this.hovered,this.repaint())};v.touchstart=function(d){this.mousemove(d)};v.mousemove=function(d){var c=d.p.x;d=d.p.y;this.hovered=k;for(var e=0,b=this.cells.length;e<b;e++){var g=this.cells[e];if(w.isBetween(c,g.x,g.x+g.dimension)&&w.isBetween(d,
g.y,g.y+g.dimension)){this.hovered=g;break}}this.repaint()};v.mouseout=function(d){this.hovered=k;this.repaint()}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,document);(function(n,E,w,v){n.png={};n.png.string=function(k){return E.getElementById(k.id).toDataURL("image/png")};n.png.open=function(k){w.open(this.string(k))}})(ChemDoodle.io,document,window);(function(n,E,w){n.file={};n.file.content=function(v,k){E.get(v,"",k)}})(ChemDoodle.io,ChemDoodle.lib.jQuery);
(function(n,E,w,v,k,q,d){E.SERVER_URL="https://ichemlabs.cloud.chemdoodle.com/icl_cdc_v090000/WebHQ";E.inRelay=!1;E.asynchronous=!0;E.INFO={userAgent:navigator.userAgent,platform:navigator.platform,v_cwc:n.getVersion(),v_jQuery:k.fn.jquery,v_jQuery_ui:"N/A"};var c=new w.JSONInterpreter,e=new v.Queue;E._contactServer=function(b,g,m,p,l){this.inRelay?e.enqueue({call:b,content:g,options:m,callback:p,errorback:l}):(E.inRelay=!0,k.ajax({dataType:"text",type:"POST",data:JSON.stringify({call:b,content:g,
options:m,info:E.INFO}),url:this.SERVER_URL,success:function(r){r=JSON.parse(r);r.message&&alert(r.message);E.inRelay=!1;p&&r.content&&!r.stop&&p(r.content);r.stop&&l&&l();e.isEmpty()||(r=e.dequeue(),E._contactServer(r.call,r.content,r.options,r.callback,r.errorback))},error:function(r,y,x){E.inRelay=!1;l&&l();e.isEmpty()||(r=e.dequeue(),E._contactServer(r.call,r.content,r.options,r.callback,r.errorback))},xhrFields:{withCredentials:!0},async:E.asynchronous}))};E.authenticate=function(b,g,m,p){this._contactServer("authenticate",
{credential:b},g,function(l){m(l)},p)};E.balanceReaction=function(b,g,m,p){var l={};"string"===typeof b||b instanceof String?l.equation=b:l.reaction=c.contentTo(b.molecules,b.shapes);this._contactServer("balanceReaction",l,g,function(r){m(r.result,r.message)},p)};E.calculate=function(b,g,m,p){this._contactServer("calculate",{mol:c.molTo(b)},g,function(l){m(l)},p)};E.createLewisDotStructure=function(b,g,m,p){this._contactServer("createLewisDot",{mol:c.molTo(b)},g,function(l){m(c.molFrom(l.mol))},p)};
E.generateImage=function(b,g,m,p){this._contactServer("generateImage",{mol:c.molTo(b)},g,function(l){m(l.link)},p)};E.generateIUPACName=function(b,g,m,p){this._contactServer("generateIUPACName",{mol:c.molTo(b)},g,function(l){m(l.iupac)},p)};E.getMoleculeFromContent=function(b,g,m,p){this._contactServer("getMoleculeFromContent",{content:b},g,function(l){for(var r=!1,y=0,x=l.mol.a.length;y<x;y++)if(0!==l.mol.a[y].z){r=!0;break}if(r)for(r=0,y=l.mol.a.length;r<y;r++)l.mol.a[r].x/=20,l.mol.a[r].y/=20,
l.mol.a[r].z/=20;m(c.molFrom(l.mol))},p)};E.getMoleculeFromDatabase=function(b,g,m,p){this._contactServer("getMoleculeFromDatabase",{query:b},g,function(l){if(3===g.dimension)for(var r=0,y=l.mol.a.length;r<y;r++)l.mol.a[r].x/=20,l.mol.a[r].y/=-20,l.mol.a[r].z/=20;m(c.molFrom(l.mol))},p)};E.getOptimizedPDBStructure=function(b,g,m,p){this._contactServer("getOptimizedPDBStructure",{id:b},g,function(l){var r=l.mol?c.molFrom(l.mol):new v.Molecule;r.chains=c.chainsFrom(l.ribbons);l=0;for(var y=r.chains.length;l<
y;l++)for(var x=r.chains[l],A=0,H=x.length-1;A<H;A++)x[A+1].arrow&&(x[A+1].arrow=!1,x[A].arrow=!0);r.fromJSON=!0;m(r)},p)};E.getZeoliteFromIZA=function(b,g,m,p){this._contactServer("getZeoliteFromIZA",{query:b},g,function(l){m(ChemDoodle.readCIF(l.cif,g.xSuper,g.ySuper,g.zSuper))},p)};E.isGraphIsomorphism=function(b,g,m,p,l){this._contactServer("isGraphIsomorphism",{arrow:c.molTo(b),target:c.molTo(g)},m,function(r){p(r.value)},l)};E.isSubgraphIsomorphism=function(b,g,m,p,l){this._contactServer("isSubgraphIsomorphism",
{arrow:c.molTo(b),target:c.molTo(g)},m,function(r){p(r.value)},l)};E.isSupergraphIsomorphism=function(b,g,m,p,l){this._contactServer("isSupergraphIsomorphism",{arrow:c.molTo(b),target:c.molTo(g)},m,function(r){p(r.value)},l)};E.getSimilarityMeasure=function(b,g,m,p,l){this._contactServer("getSimilarityMeasure",{first:c.molTo(b),second:c.molTo(g)},m,function(r){p(r.value)},l)};E.kekulize=function(b,g,m,p){this._contactServer("kekulize",{mol:c.molTo(b)},g,function(l){m(c.molFrom(l.mol))},p)};E.maximumCommonSubstructure=
function(b,g,m,p,l){this._contactServer("maximumCommonSubstructure",{m1:c.molTo(b),m2:c.molTo(g)},m,function(r){p(r.map)},l)};E.mechanismMatch=function(b,g,m,p,l){this._contactServer("matchMechanism",{arrow:b,targets:g},m,function(r){p(r)},l)};E.optimize=function(b,g,m,p){this._contactServer("optimize",{mol:c.molTo(b)},g,function(l){l=c.molFrom(l.mol);if(2===g.dimension){for(var r=0,y=l.atoms.length;r<y;r++)b.atoms[r].x=l.atoms[r].x,b.atoms[r].y=l.atoms[r].y;m()}else if(3===g.dimension){r=0;for(y=
l.atoms.length;r<y;r++)l.atoms[r].x/=20,l.atoms[r].y/=-20,l.atoms[r].z/=20;m(l)}},p)};E.readIUPACName=function(b,g,m,p){this._contactServer("readIUPACName",{iupac:b},g,function(l){m(c.molFrom(l.mol))},p)};E.readSMILES=function(b,g,m,p){this._contactServer("readSMILES",{smiles:b},g,function(l){m(c.molFrom(l.mol))},p)};E.resolveCIP=function(b,g,m,p){this._contactServer("resolveCIP",{mol:c.molTo(b)},g,function(l){m(l.atoms,l.bonds)},p)};E.saveFile=function(b,g,m,p){this._contactServer("saveFile",{mol:c.molTo(b)},
g,function(l){m(l.link)},p)};E.simulate13CNMR=function(b,g,m,p){g.nucleus="C";g.isotope=13;this._contactServer("simulateNMR",{mol:c.molTo(b)},g,function(l){m(n.readJCAMP(l.jcamp))},p)};E.simulate1HNMR=function(b,g,m,p){g.nucleus="H";g.isotope=1;this._contactServer("simulateNMR",{mol:c.molTo(b)},g,function(l){m(n.readJCAMP(l.jcamp))},p)};E.simulateMassParentPeak=function(b,g,m,p){this._contactServer("simulateMassParentPeak",{mol:c.molTo(b)},g,function(l){m(n.readJCAMP(l.jcamp))},p)};E.writeSMILES=
function(b,g,m,p){this._contactServer("writeSMILES",{mol:c.molTo(b)},g,function(l){m(l.smiles)},p)};E.version=function(b,g,m){this._contactServer("version",{},b,function(p){g(p.value)},m)};E.checkForUpdates=function(b){this._contactServer("checkForUpdates",{value:q.href},b,function(g){},function(){})}})(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery,location);
